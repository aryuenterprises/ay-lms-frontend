"use strict";(self.webpackChunkable_pro_material_react=self.webpackChunkable_pro_material_react||[]).push([[1918],{11918:function(e,t,n){n.r(t);var r=n(1413),o=n(61819),a=n(15861),s=n(29439),i=n(43513),l=n(20068),u=n(697),c=n(94294),d=n(48550),p=n(63466),m=n(13400),f=n(74982),x=n(65117),h=n(23786),g=(n(91587),n(69977),n(24034)),Z=n(72791),v=n(23197),w=n(89731),b=n(78045),_=n(58536),y=n(10163),S=n(97820),j=n(85680),C=n(34045),k=n(35125),P=n(23038),D=n(71652),I=n(41985),T=n(12649),z=n(57689),M=n(80184);t.default=function(){var e,t,n,N,L=(0,z.s0)(),O=JSON.parse(localStorage.getItem("auth")),E=(null===O||void 0===O||null===(e=O.user)||void 0===e?void 0:e.employee_id)||(null===O||void 0===O||null===(t=O.user)||void 0===t?void 0:t.user_id),H=null===O||void 0===O||null===(n=O.user)||void 0===n?void 0:n.student_id,F=null===O||void 0===O||null===(N=O.user)||void 0===N?void 0:N.company_id,A=null===O||void 0===O?void 0:O.loginType,$=(0,Z.useState)([]),B=(0,s.Z)($,2),W=B[0],R=B[1],V=(0,Z.useState)(""),q=(0,s.Z)(V,2),Y=q[0],J=q[1],U=(0,Z.useState)(""),G=(0,s.Z)(U,2),K=G[0],Q=G[1],X=(0,Z.useState)(null),ee=(0,s.Z)(X,2),te=ee[0],ne=ee[1],re=(0,Z.useState)(null),oe=(0,s.Z)(re,2),ae=oe[0],se=oe[1],ie=(0,Z.useState)(!0),le=(0,s.Z)(ie,2),ue=le[0],ce=le[1],de=(0,Z.useState)(null),pe=(0,s.Z)(de,2),me=pe[0],fe=pe[1],xe=(0,Z.useState)(!1),he=(0,s.Z)(xe,2),ge=he[0],Ze=he[1],ve=(0,Z.useState)([]),we=(0,s.Z)(ve,2),be=we[0],_e=we[1],ye=(0,Z.useState)([]),Se=(0,s.Z)(ye,2),je=Se[0],Ce=Se[1],ke=(0,Z.useState)(null),Pe=(0,s.Z)(ke,2),De=Pe[0],Ie=Pe[1],Te=(0,Z.useState)(null),ze=(0,s.Z)(Te,2),Me=ze[0],Ne=ze[1],Le=(0,Z.useState)(""),Oe=(0,s.Z)(Le,2),Ee=Oe[0],He=Oe[1],Fe=(0,Z.useState)(null),Ae=(0,s.Z)(Fe,2),$e=Ae[0],Be=Ae[1],We=Boolean($e),Re=(0,Z.useCallback)((0,a.Z)((0,o.Z)().mark((function e(){var t,n;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,ce(!0),"admin"!==A&&"super_admin"!==A){e.next=8;break}return e.next=5,w.Z.get("".concat(v.t6,"api/attendance"));case 5:t=e.sent,e.next=23;break;case 8:if("tutor"!==A){e.next=14;break}return e.next=11,w.Z.get("".concat(v.t6,"api/trainer_attendance/").concat(E,"/full_logs"));case 11:t=e.sent,e.next=23;break;case 14:if("student"!==A){e.next=20;break}return e.next=17,w.Z.get("".concat(v.t6,"api/attendance/").concat(H,"/full_logs"));case 17:t=e.sent,e.next=23;break;case 20:return e.next=22,w.Z.get("".concat(v.t6,"api/employer/").concat(F,"/attendance"));case 22:t=e.sent;case 23:n="admin"===A||"super_admin"===A?Array.isArray(t.data.logs)?t.data.logs:[]:"employer"===A?Array.isArray(t.data.attendance_logs)?t.data.attendance_logs:[]:Array.isArray(t.data.data)?t.data.data:[],_e(t.data.course),Ce(t.data.batch),R(n),e.next=34;break;case 29:e.prev=29,e.t0=e.catch(0),fe(e.t0.message),console.error("Error fetching data:",e.t0),R([]);case 34:return e.prev=34,ce(!1),e.finish(34);case 37:case"end":return e.stop()}}),e,null,[[0,29,34,37]])}))),[A,E,H,F]);(0,Z.useEffect)((function(){Re()}),[Re]);var Ve=(0,Z.useMemo)((function(){return W.filter((function(e){var t,n=e.scheduled_date;if(Y){var r=Y.toLowerCase();if(!Object.values(e).some((function(e){return"string"===typeof e?e.toLowerCase().includes(r):"number"===typeof e&&e.toString().includes(r)})))return!1}if(K&&(null===(t=e.name)||void 0===t||!t.toLowerCase().includes(K.toLowerCase())))return!1;if(De&&e.course_id!==De.course_id)return!1;if(Me&&e.batch_id!==Me.batch_id)return!1;if(Ee&&e.user_type!==Ee)return!1;if(n&&(te||ae)){var o=new Date(n);if(te){var a=new Date(te);if(a.setHours(0,0,0,0),o<a)return!1}if(ae){var s=new Date(ae);if(s.setHours(23,59,59,999),o>s)return!1}}return!0})).map((function(e,t){return(0,r.Z)((0,r.Z)({},e),{},{sno:t+1})}))}),[W,Y,K,De,Me,Ee,te,ae]),qe="tutor"===A?[{name:"S.No",selector:function(e){return e.sno||"-"},sortable:!0,width:"100px"},{name:"Date",selector:function(e){return e.date?(0,b.o)(e.date,{includeTime:!1}):"-"},sortable:!0,width:"150px"},{name:"Trainer Name",selector:function(e){return e.trainer_name||"-"},sortable:!0,width:"150px"},{name:"Batch",selector:function(e){return e.title||"-"},sortable:!0,width:"150px"},{name:"Course Name",selector:function(e){return e.course_name||"-"},sortable:!0,width:"200px"},{name:"Total Hours",selector:function(e){return e.working_hours?e.working_hours:"-"},sortable:!0,width:"150px"},{name:"Login Time",selector:function(e){return e.first_login_time||"-"},sortable:!0,width:"150px"},{name:"Logout Time",selector:function(e){return e.last_logout_time||"-"},sortable:!0,width:"150px"},{name:"Status",selector:function(e){return e.status||"-"},sortable:!0,width:"150px"}]:"student"===A?[{name:"S.No",selector:function(e){return e.sno||"-"},sortable:!0,width:"100px"},{name:"Date",selector:function(e){return e.date?(0,b.o)(e.date,{includeTime:!1}):"-"},sortable:!0},{name:"Student Name",selector:function(e){return e.student_name||"-"},sortable:!0,width:"150px"},{name:"Batch",selector:function(e){return e.title||"-"},sortable:!0,width:"200px"},{name:"Course Name",selector:function(e){return e.course_name||"-"},sortable:!0,width:"200px"},{name:"Login Time",selector:function(e){return(0,b.o)(e.login_time)||"-"},sortable:!0,width:"180px"},{name:"Logut Time",selector:function(e){return(0,b.o)(e.logout_time)||"-"},sortable:!0,width:"180px"},{name:"Status",selector:function(e){return e.status||"-"},sortable:!0,width:"150px"}]:"employer"===A?[{name:"S.No",selector:function(e){return e.sno||"-"},sortable:!0,width:"150px"},{name:"Name",selector:function(e){return(0,j.Z)(e.name)||"-"},sortable:!0},{name:"Batch",selector:function(e){return e.title||"-"},sortable:!0,width:"200px"},{name:"Course Name",selector:function(e){return e.course||"-"},sortable:!0},{name:"Date & Time",selector:function(e){return e.date_time?(0,b.o)(e.date_time):"-"},sortable:!0},{name:"Status",selector:function(e){return e.status||"-"},sortable:!0,width:"150px"}]:[{name:"S.No",selector:function(e){return e.sno||"-"},sortable:!0,width:"150px"},{name:"Name",selector:function(e){return(0,j.Z)(e.name)||"-"},sortable:!0,width:"150px"},{name:"User Type",selector:function(e){return(0,j.Z)(e.user_type)||"-"},sortable:!0},{name:"Batch",selector:function(e){return e.title||"-"},sortable:!0,width:"200px"},{name:"Course Name",selector:function(e){return e.course||"-"},sortable:!0,width:"200px"},{name:"Topic",cell:function(e){return(0,M.jsx)(l.Z,{title:e.topic||"-",arrow:!0,placement:"top",children:(0,M.jsx)("span",{style:{display:"inline-block",width:"100%",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:e.topic})})},sortable:!0},{name:"Sub Topics",cell:function(e){return(0,M.jsx)(l.Z,{title:e.sub_topic||"-",arrow:!0,placement:"top",children:(0,M.jsx)("span",{style:{display:"inline-block",width:"100%",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:e.sub_topic})})},sortable:!0},{name:"Date & Time",selector:function(e){return e.date_time?(0,b.o)(e.date_time):"-"},sortable:!0,width:"200px"},{name:"Total Hours",selector:function(e){return e.total_hours?e.total_hours:"-"},sortable:!0},{name:"Status",selector:function(e){return e.status||"-"},sortable:!0}];if(me)return(0,M.jsx)(g.Z,{sx:{borderRadius:2},children:(0,M.jsxs)(u.Z,{p:3,color:"error.main",children:["Error: ",me]})});var Ye=function(){Be(null)},Je=function(e){return e.map((function(e){var t={};return qe.forEach((function(n){var r=n.selector?n.selector(e):e[n.name.toLowerCase().replace(/ /g,"_")];t[n.name]=void 0!==r?r:""})),t}))};return(0,M.jsxs)(g.Z,{sx:{borderRadius:2},children:["tutor"===A||"student"===A?(0,M.jsx)(u.Z,{sx:{display:"flex",justifyContent:"flex-end",alignItems:"center",width:"100%"},children:(0,M.jsx)(c.Z,{variant:"contained",sx:{float:"right"},onClick:function(){L("/attendance-monthly-dedails")},children:"Monthely Dedails"})}):null,(0,M.jsxs)(u.Z,{sx:{display:"flex",flexDirection:{xs:"column",sm:"row"},justifyContent:"space-between",alignItems:{xs:"stretch",sm:"center"},p:{xs:2,sm:3},gap:3,flexWrap:"wrap"},children:[(0,M.jsxs)(u.Z,{sx:{display:"flex",flexDirection:{xs:"column",sm:"row"},alignItems:{xs:"stretch",sm:"center"},gap:2,flex:1,minWidth:{xs:"100%",sm:"auto"}},children:[(0,M.jsx)(d.Z,{placeholder:"Search any field...",variant:"outlined",size:"small",value:Y,onChange:function(e){return J(e.target.value)},sx:{width:{xs:"100%",sm:150},minWidth:{xs:"auto",sm:150}},InputProps:{startAdornment:(0,M.jsx)(p.Z,{position:"start",children:(0,M.jsx)(_.Z,{size:20})}),endAdornment:(0,M.jsx)(p.Z,{position:"end",children:Y&&(0,M.jsx)(m.Z,{onClick:function(){Y&&(Ze(!ge),J(""))},edge:"end",size:"small",children:(0,M.jsx)(y.Z,{size:20})})})}}),(0,M.jsx)(d.Z,{placeholder:" name search...",variant:"outlined",size:"small",value:K,onChange:function(e){return Q(e.target.value)},sx:{width:{xs:"100%",sm:150},minWidth:{xs:"auto",sm:150}},InputProps:{startAdornment:(0,M.jsx)(p.Z,{position:"start",children:(0,M.jsx)(_.Z,{size:20})}),endAdornment:(0,M.jsx)(p.Z,{position:"end",children:K&&(0,M.jsx)(m.Z,{onClick:function(){K&&Q("")},edge:"end",size:"small",children:(0,M.jsx)(y.Z,{size:20})})})}}),("admin"===A||"super_admin"===A)&&(0,M.jsx)(f.Z,{id:"userType",options:["trainer","student"],getOptionLabel:function(e){return e},value:Ee,onChange:function(e,t){He(t)},size:"small",sx:{width:{xs:"100%",sm:150},minWidth:{xs:"auto",sm:150}},renderInput:function(e){return(0,M.jsx)(d.Z,(0,r.Z)((0,r.Z)({},e),{},{placeholder:"Filter by user type...",InputProps:(0,r.Z)({},e.InputProps)}))}}),(0,M.jsxs)(u.Z,{sx:{display:"flex",flexDirection:{xs:"column",sm:"row"},alignItems:{xs:"stretch",sm:"center"},gap:2,flex:1},children:[(0,M.jsx)(f.Z,{id:"course_id",options:be||[],getOptionLabel:function(e){return e.course_name||""},value:De,onChange:function(e,t){Ie(t)},size:"small",sx:{width:{xs:"100%",sm:150},minWidth:{xs:"auto",sm:150}},renderInput:function(e){return(0,M.jsx)(d.Z,(0,r.Z)((0,r.Z)({},e),{},{placeholder:"Filter by course...",InputProps:(0,r.Z)({},e.InputProps)}))},filterOptions:function(){var e=arguments.length>1?arguments[1]:void 0;return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).filter((function(t){var n;return null===(n=t.course_name)||void 0===n?void 0:n.toLowerCase().includes(e.inputValue.toLowerCase())}))},isOptionEqualToValue:function(e,t){return e.course_id===t.course_id},renderOption:function(e,t){return(0,Z.createElement)("li",(0,r.Z)((0,r.Z)({},e),{},{key:t.course_id}),t.course_name)}}),(0,M.jsx)(f.Z,{id:"batch_id",options:je||[],getOptionLabel:function(e){return e.title||""},value:Me,onChange:function(e,t){Ne(t)},size:"small",sx:{width:{xs:"100%",sm:150},minWidth:{xs:"auto",sm:150}},renderInput:function(e){return(0,M.jsx)(d.Z,(0,r.Z)((0,r.Z)({},e),{},{placeholder:"Filter by batch...",InputProps:(0,r.Z)({},e.InputProps)}))},filterOptions:function(){var e=arguments.length>1?arguments[1]:void 0;return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).filter((function(t){var n;return null===(n=t.title)||void 0===n?void 0:n.toLowerCase().includes(e.inputValue.toLowerCase())}))},isOptionEqualToValue:function(e,t){return e.batch_id===t.batch_id},renderOption:function(e,t){return(0,Z.createElement)("li",(0,r.Z)((0,r.Z)({},e),{},{key:t.batch_id}),t.title)}}),(0,M.jsxs)(u.Z,{sx:{display:"flex",flexDirection:{xs:"column",sm:"row"},alignItems:{xs:"stretch",sm:"center"},gap:1,width:{xs:"100%",sm:"auto"}},children:[(0,M.jsx)(D._,{dateAdapter:T.H,children:(0,M.jsxs)(u.Z,{sx:{display:"flex",flexDirection:{xs:"column",sm:"row"},gap:1,width:"100%"},children:[(0,M.jsx)(I.M,{label:"From Date",value:te,onChange:function(e){return ne(e)},renderInput:function(e){return(0,M.jsx)(d.Z,(0,r.Z)((0,r.Z)({},e),{},{size:"small",sx:{width:{xs:"100%",sm:140},"& .MuiInputBase-root":{fontSize:"0.75rem",minHeight:40},"& input":{padding:"10px 14px",fontSize:"0.875rem"}}}))}}),(0,M.jsx)(I.M,{label:"To Date",value:ae,onChange:function(e){return se(e)},renderInput:function(e){return(0,M.jsx)(d.Z,(0,r.Z)((0,r.Z)({},e),{},{size:"small",sx:{width:{xs:"100%",sm:140},"& .MuiInputBase-root":{fontSize:"0.75rem",minHeight:40},"& input":{padding:"10px 14px",fontSize:"0.875rem"}}}))}})]})}),(te||ae)&&(0,M.jsx)(m.Z,{onClick:function(){ne(null),se(null)},size:"small",title:"Clear dates",sx:{alignSelf:{xs:"flex-start",sm:"center"},mt:{xs:1,sm:0}},children:(0,M.jsx)(y.Z,{size:20})})]})]})]}),(0,M.jsxs)(u.Z,{sx:{display:"flex",justifyContent:{xs:"flex-start",sm:"flex-end"},alignItems:"center",width:{xs:"100%",sm:"auto"}},children:[(0,M.jsx)(m.Z,{variant:"contained",color:"secondary",sx:{borderRadius:2,ml:{xs:0,sm:2}},onClick:function(e){Be(e.currentTarget)},"aria-controls":"download-menu","aria-haspopup":"true","aria-expanded":We?"true":void 0,children:(0,M.jsx)(S.Z,{})}),(0,M.jsxs)(x.Z,{id:"download-menu",anchorEl:$e,open:We,onClose:Ye,MenuListProps:{"aria-labelledby":"download-button"},children:[(0,M.jsx)(h.Z,{onClick:function(){!function(e){try{var t=e;if(!t||0===t.length)return void alert("No data to export");var n=Je(t),r=C.P6.json_to_sheet(n),o=qe.map((function(e){return e.name}));C.P6.sheet_add_aoa(r,[o],{origin:"A1"});var a=C.P6.book_new();C.P6.book_append_sheet(a,r,"AttendanceLogs"),C.NC(a,"attendance_logs_".concat((new Date).toISOString().slice(0,10),".xlsx"))}catch(me){console.error("Error exporting to Excel:",me),alert("Failed to export to Excel")}}(Ve),Ye()},children:"Export to Excel"}),(0,M.jsx)(h.Z,{onClick:function(){!function(e){try{var t=Je(e),n=qe.map((function(e){return e.name})),r=new k.kH;(0,P.ZP)(r,{head:[n],body:t.map((function(e){return n.map((function(t){return e[t]||""}))})),margin:{top:20},styles:{fontSize:8},headStyles:{fillColor:[41,128,185]}}),r.save("attendance_logs_".concat((new Date).toISOString().slice(0,10),".pdf"))}catch(me){console.error("Error exporting to PDF:",me),alert("Failed to export to PDF")}}(Ve),Ye()},children:"Export to PDF"})]})]})]}),(0,M.jsx)(i.ZP,{columns:qe,data:Ve,pagination:!0,paginationPerPage:10,paginationRowsPerPageOptions:[5,10,20,30],highlightOnHover:!0,responsive:!0,progressPending:ue,noDataComponent:"No attendance records found",onChangePage:function(e){return setCurrentPage(e)}})]})}},78045:function(e,t,n){n.d(t,{o:function(){return a}});var r=n(29439),o=n(23197),a=function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=n.includeTime,s=void 0===a||a,i=n.includeSeconds,l=void 0!==i&&i,u=n.timeOnly,c=void 0!==u&&u,d=n.useCurrentIfEmpty,p=void 0!==d&&d,m=n.fallback,f=void 0===m?"":m;if(e)if("string"===typeof e&&/^\d{1,2}:\d{2}(:\d{2})?$/.test(e)){var x=e.split(":").map(Number),h=(0,r.Z)(x,3),g=h[0],Z=h[1],v=h[2];(t=new Date).setHours(g,Z,v||0,0)}else t=e instanceof Date?e:new Date(e);else{if(!p)return f;t=new Date}if(isNaN(t.getTime()))return f;var w=function(e,t){var n=t.getHours(),r=n>=12,o={yyyy:t.getFullYear(),yy:String(t.getFullYear()).slice(-2),MM:String(t.getMonth()+1).padStart(2,"0"),M:t.getMonth()+1,dd:String(t.getDate()).padStart(2,"0"),d:t.getDate(),HH:String(n).padStart(2,"0"),H:n,hh:String(n%12||12).padStart(2,"0"),h:n%12||12,mm:String(t.getMinutes()).padStart(2,"0"),m:t.getMinutes(),ss:String(t.getSeconds()).padStart(2,"0"),s:t.getSeconds(),a:r?"PM":"AM"};return e.replace(/(yyyy|yy|MM|M|dd|d|HH|H|hh|h|mm|m|ss|s|a)/g,(function(e){return o[e]||e}))};if(c){var b=o.ZP.timeFormat;return l||(b=(b=(b=b.replace(/:ss?/g,"")).replace(/(^|\s)ss?(\s|$)/g,"$1$2")).replace(/::/g,":").replace(/(\s|^):|:(\s|$)/g,"$1$2")),w(b,t)}if(s){var _=w(o.ZP.dateFormat,t),y=o.ZP.timeFormat;l||(y=(y=y.replace(/[:\\/]?ss?/g,"")).replace(/::/g,":").replace(/:$/,""));var S=w(y,t);return"".concat(_," ").concat(S)}return w(o.ZP.dateFormat,t)}},69977:function(){}}]);
//# sourceMappingURL=1918.642d8a7b.chunk.js.map