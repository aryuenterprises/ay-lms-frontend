"use strict";(self.webpackChunkable_pro_material_react=self.webpackChunkable_pro_material_react||[]).push([[3793],{42664:function(e,t,n){n.d(t,{g:function(){return i}});var r=n(72791),i=function(){return{checkPermission:(0,r.useCallback)((function(e,t){try{var n,r=JSON.parse(localStorage.getItem("auth")||"[]"),i=null===r||void 0===r?void 0:r.loginType,a=(null===r||void 0===r||null===(n=r.user)||void 0===n?void 0:n.permissions)||[];return"super_admin"===i||"admin"===i&&a.some((function(n){return n.module_name===e&&n.allowed_actions.includes(t)}))}catch(o){return console.error("Error checking permission:",o),!1}}),[])}}},43793:function(e,t,n){n.r(t);var r=n(93433),i=n(61819),a=n(15861),o=n(29439),s=n(72791),c=n(43513),l=n(61889),u=n(48550),d=n(63466),v=n(13400),p=n(94294),m=n(697),h=n(20068),f=n(5574),x=n(65661),g=n(39157),Z=n(36314),j=n(17133),C=n(97123),b=n(58536),k=n(10163),E=n(60592),w=n(49769),y=n(62634),P=n(17139),S=n(36277),D=n(8007),B=n(2314),T=n(21830),M=n.n(T),N=n(41985),O=n(71652),_=n(12649),z=(n(91587),n(69977),n(24034)),A=n(42664),F=n(57689),L=n(89731),q=n(78045),H=n(80184);t.default=function(){var e=(0,F.s0)(),t=(0,A.g)().checkPermission,n=t("Events","view"),T=t("Events","create"),W=t("Events","update"),I=t("Events","delete"),K=(0,s.useState)(!1),$=(0,o.Z)(K,2),R=$[0],Y=$[1],V=(0,s.useState)(null),J=(0,o.Z)(V,2),U=J[0],G=J[1],Q=(0,s.useState)([]),X=(0,o.Z)(Q,2),ee=X[0],te=X[1],ne=(0,s.useState)(""),re=(0,o.Z)(ne,2),ie=re[0],ae=re[1],oe=(0,s.useState)(""),se=(0,o.Z)(oe,2),ce=se[0],le=se[1],ue=(0,s.useState)(!1),de=(0,o.Z)(ue,2),ve=de[0],pe=de[1],me=(0,s.useState)(!1),he=(0,o.Z)(me,2),fe=he[0],xe=he[1],ge=(0,s.useCallback)((0,a.Z)((0,i.Z)().mark((function e(){var t,n,r;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,xe(!0),e.next=4,L.Z.get("api/live-quiz/rooms/");case 4:n=e.sent,r=(null===n||void 0===n||null===(t=n.data)||void 0===t?void 0:t.data)||[],te(r),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),ae(e.t0.message);case 12:return e.prev=12,xe(!1),e.finish(12);case 15:case"end":return e.stop()}}),e,null,[[0,9,12,15]])}))),[]);(0,s.useEffect)((function(){ge()}),[ge]);var Ze=function(){G(null),Y(!0)},je=(0,s.useMemo)((function(){return ee&&Array.isArray(ee)?ce?null===ee||void 0===ee?void 0:ee.filter((function(e){return e.title.toLowerCase().includes(ce.toLowerCase())||e.description.toLowerCase().includes(ce.toLowerCase())})):ee||[]:[]}),[ee,ce]),Ce=(0,s.useMemo)((function(){return(0,H.jsxs)(l.ZP,{container:!0,justifyContent:"space-between",alignItems:"center",my:3,children:[(0,H.jsx)(l.ZP,{item:!0,xs:12,md:6,children:(0,H.jsx)(u.Z,{placeholder:"Search by event name or description...",variant:"outlined",size:"small",value:ce,onChange:function(e){return le(e.target.value)},InputProps:{startAdornment:(0,H.jsx)(d.Z,{position:"start",children:(0,H.jsx)(b.Z,{size:20})}),endAdornment:(0,H.jsx)(d.Z,{position:"end",children:ce&&(0,H.jsx)(v.Z,{onClick:function(){ce&&(pe(!ve),le(""))},edge:"end",size:"small",children:(0,H.jsx)(k.Z,{size:20})})})}})}),(0,H.jsx)(l.ZP,{item:!0,xs:12,md:6,textAlign:"right",children:T&&(0,H.jsx)(p.Z,{color:"success",variant:"contained",startIcon:(0,H.jsx)(E.Z,{}),onClick:Ze,children:"Add Event"})})]})}),[ce,ve,T]),be=function(){var e=(0,a.Z)((0,i.Z)().mark((function e(t){var n,r,a,o;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,M().fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!"});case 2:if(!e.sent.isConfirmed){e.next=14;break}return e.prev=4,e.next=7,L.Z.delete("api/live-quiz/rooms/".concat(t,"/"));case 7:!0===(n=e.sent).data.success?(M().fire({title:"Success!",text:"Event has been deleted.",icon:"success",confirmButtonText:"OK"}),ge()):M().fire({title:"Error!",text:(null===n||void 0===n||null===(r=n.data)||void 0===r?void 0:r.message)||"Error deleting event.",icon:"error",confirmButtonText:"OK"}),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(4),M().fire({title:"Error!",text:(null===(a=e.t0.response)||void 0===a||null===(o=a.data)||void 0===o?void 0:o.message)||"Failed to delete event.",icon:"error",confirmButtonText:"OK"});case 14:case"end":return e.stop()}}),e,null,[[4,11]])})));return function(t){return e.apply(this,arguments)}}(),ke=function(){Y(!1),we.resetForm()},Ee=(0,s.useCallback)((function(t){t&&e("/events/".concat(t.id),{state:{eventId:t.id,eventData:{eventId:t.id,eventName:t.title,eventDescription:t.description,eventDate:t.start_at,eventParticipantsCount:t.max_participants}}})}),[e]),we=(0,S.TA)({enableReinitialize:!0,initialValues:{eventName:(null===U||void 0===U?void 0:U.eventName)||"",eventDescription:(null===U||void 0===U?void 0:U.eventDescription)||"",eventDate:null!==U&&void 0!==U&&U.eventDate?new Date(U.eventDate):null,eventParticipantsCount:(null===U||void 0===U?void 0:U.eventParticipantsCount)||""},validationSchema:D.Ry().shape({eventName:D.Z_().required("Event name is required").matches(/^[A-Za-z0-9\s\-_,.!?;:'"()]+$/,"Event name can only contain letters, numbers, spaces and basic punctuation").trim(),eventDescription:D.Z_().required("Event description is required").trim(),eventDate:D.hT().required("Event date is required").min(new Date,"Event date must be in the future").nullable(),eventParticipantsCount:D.Rx().required("Participants count is required").min(1,"Must have at least 1 participant").integer("Must be a whole number")}),onSubmit:function(){var e=(0,a.Z)((0,i.Z)().mark((function e(t,n){var r,a,o,s,c,l,u,d,v,p,m;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.resetForm,a=n.setSubmitting,e.prev=1,o={title:t.eventName.trim(),description:t.eventDescription.trim(),start_at:t.eventDate,max_participants:parseInt(t.eventParticipantsCount)},s=U?"PATCH":"POST",c=U?"api/live-quiz/rooms/".concat(U.id,"/"):"api/live-quiz/rooms/",e.next=7,(0,L.Z)({method:s,url:c,data:o});case 7:l=e.sent,!0===(u=l.data).success?(M().fire({title:"Success!",text:U?"Event updated successfully!":"Event added successfully!",icon:"success",confirmButtonText:"OK"}),r(),ge(),ke()):(d=u.message,M().fire({title:"Error!",text:d,icon:"error",confirmButtonText:"OK"})),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(1),m=(null===(v=e.t0.response)||void 0===v||null===(p=v.data)||void 0===p?void 0:p.message)||e.t0.message,M().fire({title:"Error!",text:m,icon:"error",confirmButtonText:"OK"});case 16:return e.prev=16,a(!1),e.finish(16);case 19:case"end":return e.stop()}}),e,null,[[1,12,16,19]])})));return function(t,n){return e.apply(this,arguments)}}()}),ye=function(){var e=(0,a.Z)((0,i.Z)().mark((function e(t,n){var r,a,o,s,c,l,u;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r="start"===t,e.prev=1,e.next=4,M().fire({title:"Confirm",text:"Are you sure you want to ".concat(t," this event?"),icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, "+t+" it!",cancelButtonText:"Cancel"});case 4:if(e.sent.isConfirmed){e.next=7;break}return e.abrupt("return");case 7:return e.next=9,L.Z.patch("api/live-quiz/rooms/".concat(n.id,"/start_quiz/"),{started:r});case 9:if(a=e.sent,!0!==(o=a.data).success){e.next=17;break}return e.next=14,M().fire({title:"Success!",text:"Event ".concat(t,"ed successfully!"),icon:"success",confirmButtonText:"OK"});case 14:ge(),e.next=20;break;case 17:return s=o.message,e.next=20,M().fire({title:"Error!",text:s,icon:"error",confirmButtonText:"OK"});case 20:e.next=27;break;case 22:return e.prev=22,e.t0=e.catch(1),u=(null===(c=e.t0.response)||void 0===c||null===(l=c.data)||void 0===l?void 0:l.message)||e.t0.message,e.next=27,M().fire({title:"Error!",text:u,icon:"error",confirmButtonText:"OK"});case 27:case"end":return e.stop()}}),e,null,[[1,22]])})));return function(t,n){return e.apply(this,arguments)}}(),Pe=[{name:"S.No",selector:function(e,t){return t+1},sortable:!0,width:"80px"},{name:"Event Name",selector:function(e){return e.title},sortable:!0,wrap:!0},{name:"Event Date",selector:function(e){return e.start_at},sortable:!0,cell:function(e){return(0,q.o)(e.start_at,{includeTime:!1})}},{name:"Participants",selector:function(e){return e.max_participants},sortable:!0},{name:"Status",cell:function(e){return(0,H.jsx)(m.Z,{sx:{display:"flex",gap:1},children:e.started?(0,H.jsx)(m.Z,{children:(0,H.jsx)(p.Z,{variant:"contained",color:"success",size:"small",onClick:function(){return ye("stop",e)},children:"Event Started"})}):(0,H.jsx)(m.Z,{children:(0,H.jsx)(p.Z,{variant:"contained",color:"error",size:"small",onClick:function(){return ye("start",e)},children:"Event Not Started"})})})},sortable:!0}].concat((0,r.Z)(W||I||n?[{name:"Actions",cell:function(e){return(0,H.jsxs)(m.Z,{sx:{display:"flex",gap:1},children:[(0,H.jsx)(h.Z,{title:"View Details",children:(0,H.jsx)(v.Z,{onClick:function(t){t.stopPropagation(),Ee(e)},children:(0,H.jsx)(w.Z,{})})}),W&&(0,H.jsx)(h.Z,{title:"Edit",children:(0,H.jsx)(v.Z,{color:"info",variant:"contained",onClick:function(){return G({id:(t=e).id,eventName:t.title,eventDescription:t.description,eventDate:t.start_at,eventParticipantsCount:t.max_participants}),void Y(!0);var t},children:(0,H.jsx)(y.Z,{})})}),I&&(0,H.jsx)(h.Z,{title:"Delete",children:(0,H.jsx)(v.Z,{variant:"contained",color:"error",onClick:function(){return be(e.id)},children:(0,H.jsx)(P.Z,{})})})]})}}]:[]));return ie?(0,H.jsx)(z.Z,{sx:{borderRadius:2},children:(0,H.jsxs)(m.Z,{p:3,color:"error.main",children:["Error: ",ie]})}):(0,H.jsxs)(z.Z,{children:[Ce,(0,H.jsx)(c.ZP,{columns:Pe,data:je,pagination:!0,paginationPerPage:10,paginationRowsPerPageOptions:[5,10,20,30],highlightOnHover:!0,progressPending:fe,responsive:!0,fixedHeader:!0,persistTableHead:!0}),(0,H.jsxs)(f.Z,{maxWidth:"sm",TransitionComponent:B.S,keepMounted:!0,fullWidth:!0,open:R,onClose:function(e,t){"backdropClick"!==t&&ke()},BackdropProps:{onClick:function(e){return e.stopPropagation()}},sx:{"& .MuiDialog-paper":{p:0},transition:"transform 225ms"},"aria-describedby":"alert-dialog-slide-description",children:[(0,H.jsxs)(x.Z,{className:"dialogTitle",children:[U?U.viewOnly?"View Event":"Edit Event":"Add New Event",(0,H.jsx)(v.Z,{color:"dark",onClick:ke,edge:"end",size:"big","aria-label":"close",children:(0,H.jsx)(k.Z,{})})]}),(0,H.jsx)(g.Z,{children:(0,H.jsxs)("form",{onSubmit:we.handleSubmit,children:[(0,H.jsx)(O._,{dateAdapter:_.H,children:(0,H.jsxs)(l.ZP,{container:!0,spacing:2,sx:{mt:1},children:[(0,H.jsx)(l.ZP,{item:!0,xs:12,children:(0,H.jsxs)(Z.Z,{spacing:1,children:[(0,H.jsx)(j.Z,{children:"Event Name*"}),(0,H.jsx)(u.Z,{fullWidth:!0,id:"eventName",name:"eventName",placeholder:"e.g., Annual Conference, Webinar on AI",value:we.values.eventName,onChange:we.handleChange,onBlur:we.handleBlur,error:we.touched.eventName&&Boolean(we.errors.eventName),helperText:we.touched.eventName&&we.errors.eventName,disabled:null===U||void 0===U?void 0:U.viewOnly})]})}),(0,H.jsx)(l.ZP,{item:!0,xs:12,children:(0,H.jsxs)(Z.Z,{spacing:1,children:[(0,H.jsx)(j.Z,{children:"Event Description*"}),(0,H.jsx)(u.Z,{fullWidth:!0,id:"eventDescription",name:"eventDescription",placeholder:"Describe the event details, agenda, and objectives...",value:we.values.eventDescription,onChange:we.handleChange,onBlur:we.handleBlur,error:we.touched.eventDescription&&Boolean(we.errors.eventDescription),helperText:we.touched.eventDescription&&we.errors.eventDescription,multiline:!0,rows:4,disabled:null===U||void 0===U?void 0:U.viewOnly})]})}),(0,H.jsx)(l.ZP,{item:!0,xs:12,md:6,children:(0,H.jsxs)(Z.Z,{spacing:1,children:[(0,H.jsx)(j.Z,{children:"Event Date*"}),(0,H.jsx)(N.M,{value:we.values.eventDate,onChange:function(e){return we.setFieldValue("eventDate",e)},slotProps:{textField:{fullWidth:!0,error:we.touched.eventDate&&Boolean(we.errors.eventDate),helperText:we.touched.eventDate&&we.errors.eventDate,disabled:null===U||void 0===U?void 0:U.viewOnly}},disablePast:!0})]})}),(0,H.jsx)(l.ZP,{item:!0,xs:12,md:6,children:(0,H.jsxs)(Z.Z,{spacing:1,children:[(0,H.jsx)(j.Z,{children:"Participants Count*"}),(0,H.jsx)(u.Z,{fullWidth:!0,id:"eventParticipantsCount",name:"eventParticipantsCount",placeholder:"e.g., 100",type:"number",value:we.values.eventParticipantsCount,onChange:we.handleChange,onBlur:we.handleBlur,error:we.touched.eventParticipantsCount&&Boolean(we.errors.eventParticipantsCount),helperText:we.touched.eventParticipantsCount&&we.errors.eventParticipantsCount,inputProps:{min:1,max:1e3},disabled:null===U||void 0===U?void 0:U.viewOnly})]})})]})}),!(null!==U&&void 0!==U&&U.viewOnly)&&(0,H.jsxs)(C.Z,{sx:{mt:3},children:[(0,H.jsx)(p.Z,{onClick:ke,children:"Cancel"}),(0,H.jsx)(p.Z,{type:"submit",variant:"contained",disabled:we.isSubmitting,children:U?"Update":"Submit"})]}),(null===U||void 0===U?void 0:U.viewOnly)&&(0,H.jsx)(C.Z,{sx:{mt:3},children:(0,H.jsx)(p.Z,{onClick:ke,variant:"contained",children:"Close"})})]})})]})]})}},78045:function(e,t,n){n.d(t,{o:function(){return a}});var r=n(29439),i=n(23197),a=function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=n.includeTime,o=void 0===a||a,s=n.includeSeconds,c=void 0!==s&&s,l=n.timeOnly,u=void 0!==l&&l,d=n.useCurrentIfEmpty,v=void 0!==d&&d,p=n.fallback,m=void 0===p?"":p;if(e)if("string"===typeof e&&/^\d{1,2}:\d{2}(:\d{2})?$/.test(e)){var h=e.split(":").map(Number),f=(0,r.Z)(h,3),x=f[0],g=f[1],Z=f[2];(t=new Date).setHours(x,g,Z||0,0)}else t=e instanceof Date?e:new Date(e);else{if(!v)return m;t=new Date}if(isNaN(t.getTime()))return m;var j=function(e,t){var n=t.getHours(),r=n>=12,i={yyyy:t.getFullYear(),yy:String(t.getFullYear()).slice(-2),MM:String(t.getMonth()+1).padStart(2,"0"),M:t.getMonth()+1,dd:String(t.getDate()).padStart(2,"0"),d:t.getDate(),HH:String(n).padStart(2,"0"),H:n,hh:String(n%12||12).padStart(2,"0"),h:n%12||12,mm:String(t.getMinutes()).padStart(2,"0"),m:t.getMinutes(),ss:String(t.getSeconds()).padStart(2,"0"),s:t.getSeconds(),a:r?"PM":"AM"};return e.replace(/(yyyy|yy|MM|M|dd|d|HH|H|hh|h|mm|m|ss|s|a)/g,(function(e){return i[e]||e}))};if(u){var C=i.ZP.timeFormat;return c||(C=(C=(C=C.replace(/:ss?/g,"")).replace(/(^|\s)ss?(\s|$)/g,"$1$2")).replace(/::/g,":").replace(/(\s|^):|:(\s|$)/g,"$1$2")),j(C,t)}if(o){var b=j(i.ZP.dateFormat,t),k=i.ZP.timeFormat;c||(k=(k=k.replace(/[:\\/]?ss?/g,"")).replace(/::/g,":").replace(/:$/,""));var E=j(k,t);return"".concat(b," ").concat(E)}return j(i.ZP.dateFormat,t)}},58536:function(e,t,n){n.d(t,{Z:function(){return m}});var r=n(97573),i=n(72791),a=n(52007),o=n.n(a),s=["variant","color","size"],c=function(e){var t=e.color;return i.createElement(i.Fragment,null,i.createElement("path",{d:"M11.5 21a9.5 9.5 0 1 0 0-19 9.5 9.5 0 0 0 0 19ZM21.3 21.999c-.18 0-.36-.07-.49-.2l-1.86-1.86a.706.706 0 0 1 0-.99c.27-.27.71-.27.99 0l1.86 1.86c.27.27.27.71 0 .99-.14.13-.32.2-.5.2Z",fill:t}))},l=function(e){var t=e.color;return i.createElement(i.Fragment,null,i.createElement("path",{d:"M11.5 2c5.25 0 9.5 4.25 9.5 9.5S16.75 21 11.5 21 2 16.75 2 11.5c0-3.7 2.11-6.9 5.2-8.47M22 22l-2-2",stroke:t,strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}))},u=function(e){var t=e.color;return i.createElement(i.Fragment,null,i.createElement("path",{opacity:".4",d:"M11.5 21a9.5 9.5 0 1 0 0-19 9.5 9.5 0 0 0 0 19Z",fill:t}),i.createElement("path",{d:"M21.3 21.999c-.18 0-.36-.07-.49-.2l-1.86-1.86a.706.706 0 0 1 0-.99c.27-.27.71-.27.99 0l1.86 1.86c.27.27.27.71 0 .99-.14.13-.32.2-.5.2Z",fill:t}))},d=function(e){var t=e.color;return i.createElement(i.Fragment,null,i.createElement("path",{d:"M11.5 21a9.5 9.5 0 1 0 0-19 9.5 9.5 0 0 0 0 19ZM22 22l-2-2",stroke:t,strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}))},v=function(e){var t=e.color;return i.createElement(i.Fragment,null,i.createElement("path",{d:"M11.5 21.75c-5.65 0-10.25-4.6-10.25-10.25S5.85 1.25 11.5 1.25s10.25 4.6 10.25 10.25-4.6 10.25-10.25 10.25Zm0-19c-4.83 0-8.75 3.93-8.75 8.75s3.92 8.75 8.75 8.75 8.75-3.93 8.75-8.75-3.92-8.75-8.75-8.75ZM22 22.751c-.19 0-.38-.07-.53-.22l-2-2a.754.754 0 0 1 0-1.06c.29-.29.77-.29 1.06 0l2 2c.29.29.29.77 0 1.06-.15.15-.34.22-.53.22Z",fill:t}))},p=function(e){var t=e.color;return i.createElement(i.Fragment,null,i.createElement("path",{d:"M11.5 21a9.5 9.5 0 1 0 0-19 9.5 9.5 0 0 0 0 19Z",stroke:t,strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),i.createElement("path",{opacity:".4",d:"m22 22-2-2",stroke:t,strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}))},m=(0,i.forwardRef)((function(e,t){var n=e.variant,a=e.color,o=e.size,m=(0,r._)(e,s);return i.createElement("svg",(0,r.a)({},m,{xmlns:"http://www.w3.org/2000/svg",ref:t,width:o,height:o,viewBox:"0 0 24 24",fill:"none"}),function(e,t){switch(e){case"Bold":return i.createElement(c,{color:t});case"Broken":return i.createElement(l,{color:t});case"Bulk":return i.createElement(u,{color:t});case"Linear":default:return i.createElement(d,{color:t});case"Outline":return i.createElement(v,{color:t});case"TwoTone":return i.createElement(p,{color:t})}}(n,a))}));m.propTypes={variant:o().oneOf(["Linear","Bold","Broken","Bulk","Outline","TwoTone"]),color:o().string,size:o().oneOfType([o().string,o().number])},m.defaultProps={variant:"Linear",color:"currentColor",size:"24"},m.displayName="SearchNormal1"},69977:function(){}}]);
//# sourceMappingURL=3793.c478570d.chunk.js.map