"use strict";(self.webpackChunkable_pro_material_react=self.webpackChunkable_pro_material_react||[]).push([[3390],{13390:function(e,t,n){n.r(t),n.d(t,{default:function(){return ne}});var r=n(61819),s=n(15861),o=n(29439),i=n(13967),a=n(61889),c=n(20890),l=n(5574),d=n(65661),u=n(39157),x=n(97123),h=n(94294),p=n(36314),v=n(697),m=n(24034),g=n(56790),Z=n(80184),f=function(e){var t=e.title,n=e.count,r=e.color,s=e.iconPrimary,o=e.percentage,i=e.trend;return(0,Z.jsx)(m.Z,{contentSX:{p:2.5},sx:{cursor:"pointer",transition:"transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out","&:hover":{transform:"translateY(-4px)",boxShadow:function(e){return"0 6px 16px 0 ".concat(e.palette.grey[400])}}},children:(0,Z.jsxs)(a.ZP,{container:!0,spacing:2,children:[(0,Z.jsx)(a.ZP,{item:!0,xs:12,children:(0,Z.jsxs)(p.Z,{direction:"row",alignItems:"center",justifyContent:"space-between",children:[(0,Z.jsxs)(p.Z,{direction:"row",alignItems:"center",spacing:1.5,children:[(0,Z.jsx)(g.Z,{variant:"rounded",color:r,sx:{width:46,height:46,bgcolor:"".concat(r,".lighter"),color:"".concat(r,".dark"),borderRadius:2},children:s}),(0,Z.jsx)(c.Z,{variant:"subtitle1",color:"text.secondary",sx:{fontWeight:500},children:t})]}),o&&(0,Z.jsxs)(c.Z,{variant:"caption",sx:{color:"up"===i?"success.main":"error.main",display:"flex",alignItems:"center",fontWeight:500},children:["up"===i?"\u2191":"\u2193"," ",o,"%"]})]})}),(0,Z.jsx)(a.ZP,{item:!0,xs:12,children:(0,Z.jsx)(v.Z,{sx:{p:2,backgroundColor:"background.default",borderRadius:2,border:function(e){return"1px solid ".concat(e.palette.divider)}},children:(0,Z.jsx)(p.Z,{spacing:.5,children:(0,Z.jsx)(c.Z,{variant:"h4",sx:{fontWeight:700,color:"text.primary"},children:n})})})})]})})};f.defaultProps={trend:"up"};var j=f,b=n(1413),y=n(72791),k=n(95193),_=n(13496),w=n(23197),C=function(e){var t=e.attendance,n=(0,i.Z)(),r=(0,k.Z)(n.breakpoints.down("sm")),s=n.palette.mode,a=n.palette.text.primary,c=n.palette.divider,l=n.palette.background.paper,d=(null===t||void 0===t?void 0:t.present)||0,u=(null===t||void 0===t?void 0:t.absent)||0,x=null===t||void 0===t?void 0:t.total,h=[d,u],p=(0,y.useState)({chart:{type:"donut",height:320},labels:["Present","Absent"],legend:{show:!1},dataLabels:{enabled:!1},plotOptions:{pie:{donut:{labels:{show:!0,total:{show:!0,label:"Total Days",color:a,formatter:function(){return x}}}}}}}),v=(0,o.Z)(p,2),m=v[0],g=v[1];return(0,y.useEffect)((function(){var e=n.palette.success.dark,t=n.palette.error.dark;g((function(n){return(0,b.Z)((0,b.Z)({},n),{},{colors:[e,t],xaxis:{labels:{style:{colors:[a,a]}}},yaxis:{labels:{style:{colors:[a]}}},grid:{borderColor:c},stroke:{colors:[l]},theme:{mode:s===w.hY.DARK?"dark":"light"},plotOptions:{pie:{donut:{labels:{show:!0,total:{show:!0,label:"Total Days",color:a,formatter:function(){return x}}}}}}})}))}),[s,a,c,l,n,x]),(0,Z.jsx)("div",{id:"chart",children:(0,Z.jsx)(_.Z,{options:m,series:h,type:"donut",height:r?280:320})})},P=function(e){var t,n,r,s=e.attendance,o=JSON.parse(localStorage.getItem("auth"));return r="employer"===(null===o||void 0===o?void 0:o.loginType)?s.today:s,(0,Z.jsx)(m.Z,{children:(0,Z.jsxs)(a.ZP,{container:!0,spacing:3,children:[(0,Z.jsx)(a.ZP,{item:!0,xs:12,children:(0,Z.jsx)(p.Z,{direction:"row",alignItems:"center",justifyContent:"space-between",spacing:1,children:(0,Z.jsx)(c.Z,{variant:"h5",children:"Attendance"})})}),(0,Z.jsx)(a.ZP,{item:!0,xs:12,children:(0,Z.jsx)(C,{attendance:r})}),(0,Z.jsxs)(a.ZP,{item:!0,xs:12,display:"flex",justifyContent:"space-between",children:[(0,Z.jsxs)(p.Z,{direction:"row",alignItems:"center",justifyContent:"center",spacing:1,children:[(0,Z.jsx)(c.Z,{variant:"subtitle1",children:"Present Days : "}),(0,Z.jsx)(c.Z,{color:"success.dark",sx:{display:"flex",alignItems:"center",gap:.5,fontWeight:500},children:null===(t=r)||void 0===t?void 0:t.present})]}),(0,Z.jsxs)(p.Z,{direction:"row",alignItems:"center",justifyContent:"center",spacing:1,children:[(0,Z.jsx)(c.Z,{variant:"subtitle1",children:"Absent Days : "}),(0,Z.jsx)(c.Z,{color:"error.dark",sx:{display:"flex",alignItems:"center",gap:.5,fontWeight:500},children:null===(n=r)||void 0===n?void 0:n.absent})]})]})]})})},D=n(45987),S=n(81918),A=n(90493),E=n(31427),I=n(91388),T=n(54690),R=n(16386),M=n(89731),L=n(21830),N=n.n(L),O=["day","outsideCurrentMonth","selected","onDaySelect"];function W(e){var t,n,f,j,k=e.schedule,_=void 0===k?[]:k,C=e.fetchData,P=(0,i.Z)(),L=(0,y.useState)(!1),W=(0,o.Z)(L,2),F=W[0],B=W[1],q=(0,y.useState)(null),U=(0,o.Z)(q,2),Y=U[0],H=U[1],J=(0,y.useState)(null),K=(0,o.Z)(J,2),z=K[0],G=K[1],X=(0,y.useState)(null),Q=(0,o.Z)(X,2),V=Q[0],$=Q[1],ee=(0,y.useState)(!1),te=(0,o.Z)(ee,2),ne=te[0],re=te[1],se=new Date,oe=JSON.parse(localStorage.getItem("auth")),ie=(null===oe||void 0===oe||null===(t=oe.user)||void 0===t?void 0:t.employee_id)||(null===oe||void 0===oe||null===(n=oe.user)||void 0===n?void 0:n.user_id),ae=null===oe||void 0===oe||null===(f=oe.user)||void 0===f?void 0:f.student_id,ce=null===oe||void 0===oe?void 0:oe.loginType,le=null===oe||void 0===oe||null===(j=oe.user)||void 0===j?void 0:j.attendance_type,de=function(){return B(!1)},ue=function(e){return e?_.filter((function(t){try{var n=(0,I.Z)(t.scheduled_date);return(0,T.Z)(n,e)}catch(r){return console.error("Invalid date format:",t.scheduled_date),!1}})):[]},xe=(0,y.useCallback)((0,s.Z)((0,r.Z)().mark((function e(){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{le&&$(le)}catch(t){console.error("Error fetching settings:",t)}case 1:case"end":return e.stop()}}),e)}))),[]);(0,y.useEffect)((function(){xe()}),[xe]);var he=function(){var e=(0,s.Z)((0,r.Z)().mark((function e(t){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(z!==t.id){e.next=2;break}return e.abrupt("return");case 2:if(G(t.id),e.prev=3,null!==t.attendance_status&&!1!==t.attendance_status||"automatic_attendance"!==(null===V||void 0===V?void 0:V.attendance_options)||!1!==ne){e.next=8;break}if(!t.schedule_id){e.next=8;break}return e.next=8,pe(t);case 8:window.open("".concat(t.class_link),"_blank"),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(3),console.error("Failed to process class link:",e.t0);case 14:return e.prev=14,setTimeout((function(){return G(null)}),1e3),e.finish(14);case 17:case"end":return e.stop()}}),e,null,[[3,11,14,17]])})));return function(t){return e.apply(this,arguments)}}(),pe=function(){var e=(0,s.Z)((0,r.Z)().mark((function e(t){var n,s,o,i,a,c,l;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,"student"!==ce){e.next=10;break}if(s={date:se,student:ae,status:"Present",course:t.course_id,new_batch:t.batch_id,schedule_id:t.schedule_id},t.course_id&&t.batch_id){e.next=5;break}throw new Error("Course and Batch information is required");case 5:return e.next=7,M.Z.post("".concat(w.t6,"api/attendance/").concat(ae),s);case 7:n=e.sent,e.next=14;break;case 10:return o={date:se,trainer:ie,status:"Login",course:t.course_id,new_batch:t.batch_id,schedule_id:t.schedule_id},e.next=13,M.Z.post("".concat(w.t6,"api/trainer_attendance/").concat(ie),o);case 13:n=e.sent;case 14:if(!n.data.success){e.next=20;break}de(),C(),re(!0),e.next=21;break;case 20:throw new Error((null===(i=n)||void 0===i||null===(a=i.data)||void 0===a?void 0:a.message)||"Error submitting attendance data");case 21:e.next=28;break;case 23:throw e.prev=23,e.t0=e.catch(0),console.error("Attendance marking failed:",e.t0),N().fire({title:"Error!",text:(null===(c=e.t0.response)||void 0===c||null===(l=c.data)||void 0===l?void 0:l.message)||e.t0.message||"Error submitting attendance data. Please try again.",icon:"error",confirmButtonText:"OK"}),e.t0;case 28:case"end":return e.stop()}}),e,null,[[0,23]])})));return function(t){return e.apply(this,arguments)}}(),ve=function(){var e=(0,s.Z)((0,r.Z)().mark((function e(t){var n,s,o;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n={date:se,trainer:ie,status:"Logout",course:t.course_id,new_batch:t.batch_id,schedule_id:t.schedule_id},e.next=4,M.Z.post("".concat(w.t6,"api/trainer_attendance/").concat(ie),n);case 4:if(!(s=e.sent).data.success){e.next=10;break}de(),C(),e.next=11;break;case 10:throw new Error((null===s||void 0===s||null===(o=s.data)||void 0===o?void 0:o.message)||"Error submitting attendance data");case 11:e.next=17;break;case 13:throw e.prev=13,e.t0=e.catch(0),console.error("Attendance marking failed:",e.t0),e.t0;case 17:case"end":return e.stop()}}),e,null,[[0,13]])})));return function(t){return e.apply(this,arguments)}}();function me(e,t){var n=t.split(" "),r=(0,o.Z)(n,2),s=r[0],i=r[1],a=s.split(":").map(Number),c=(0,o.Z)(a,2),l=c[0],d=c[1],u=l;return"PM"===i&&12!==l?u=l+12:"AM"===i&&12===l&&(u=0),new Date(e.getFullYear(),e.getMonth(),e.getDate(),u,d)}return(0,Z.jsxs)(m.Z,{content:!1,sx:{height:"100%"},children:[(0,Z.jsx)(v.Z,{sx:{p:3,pb:2},children:(0,Z.jsx)(c.Z,{variant:"h5",children:"Class Schedule"})}),(0,Z.jsx)(v.Z,{children:(0,Z.jsx)(E.W,{onChange:function(e){H(e),ue(e).length>0&&B(!0)},slots:{day:function(e){var t,n=e.day,r=e.outsideCurrentMonth,s=e.selected,o=e.onDaySelect,i=(0,D.Z)(e,O),a=new Date,c=!!(t=n)&&_.some((function(e){try{var n=(0,I.Z)(e.scheduled_date);return(0,T.Z)(n,t)}catch(r){return console.error("Invalid date format:",e.scheduled_date),!1}})),l=n<a&&!(0,T.Z)(n,a),d=(0,T.Z)(n,a),u=n>a&&!(0,T.Z)(n,a);return(0,Z.jsx)(v.Z,(0,b.Z)((0,b.Z)({},i),{},{onClick:function(){o(n)},sx:(0,b.Z)((0,b.Z)((0,b.Z)((0,b.Z)((0,b.Z)({width:36,height:36,m:.5,display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"50%",cursor:"pointer"},l&&c&&{color:P.palette.text.disabled,backgroundColor:P.palette.secondary.lighter}),d&&{border:"2px solid ".concat(P.palette.primary.main),fontWeight:"bold"}),u&&c&&{backgroundColor:P.palette.success.light,"&:hover":{backgroundColor:P.palette.success.light}}),s&&{backgroundColor:"".concat(P.palette.primary.main," !important"),color:"".concat(P.palette.primary.contrastText," !important")}),r&&{color:P.palette.text.disabled}),children:n.getDate()}))}},sx:{"& .MuiPickersCalendarHeader-root":{marginBottom:1,paddingLeft:2},"& .MuiDayCalendar-weekContainer":{marginTop:1},"& .MuiDayCalendar-header":{"& > span":{margin:.5,paddingRight:2,width:36,textAlign:"center"}}}})}),(0,Z.jsxs)(l.Z,{open:F,onClose:de,maxWidth:"sm",fullWidth:!0,PaperProps:{sx:{borderRadius:2}},children:[(0,Z.jsxs)(d.Z,{sx:{bgcolor:"background.paper",borderBottom:1,borderColor:"divider"},children:["Classes on ",Y&&(0,R.Z)(Y,"EEEE, MMMM d, yyyy")]}),(0,Z.jsx)(u.Z,{dividers:!0,sx:{p:0},children:(0,Z.jsx)(A.Z,{disablePadding:!0,children:Y&&ue(Y).length>0?ue(Y).map((function(e,t,n){return function(e,t,n){var r,s={done:"success",upcoming:"warning",ongoing:"info",cancelled:"error",missed:"error",completed:"success"}[e.status]||"default",o=new Date,i=(0,I.Z)(e.scheduled_date),l=me(i,e.start_time),d=me(i,e.end_time),u=new Date(l.getTime()-12e5),x=d<o,h=o>=l&&o<=d,m=o>=u&&o<=d,f=z===e.id;return(0,Z.jsx)(v.Z,{sx:{p:1,borderBottom:t!==n.length-1?1:0,borderColor:"divider","&:hover":{backgroundColor:"action.hover"}},children:(0,Z.jsxs)(a.ZP,{container:!0,spacing:2,alignItems:"center",children:[(0,Z.jsx)(a.ZP,{item:!0,xs:1,children:(0,Z.jsx)(g.Z,{variant:"rounded",color:"secondary",sx:{color:"secondary.contrastText",bgcolor:"secondary.main",fontWeight:600,width:40,height:40},children:null===(r=e.course_name)||void 0===r?void 0:r.charAt(0).toUpperCase()})}),(0,Z.jsx)(a.ZP,{item:!0,xs:7,sm:8,children:(0,Z.jsxs)(p.Z,{spacing:.5,children:[(0,Z.jsxs)(v.Z,{sx:{display:"flex",alignItems:"center",flexWrap:"wrap"},children:[(0,Z.jsx)(c.Z,{variant:"subtitle1",component:"span",children:e.course_name}),(0,Z.jsx)(c.Z,{variant:"caption",color:"text.secondary",sx:{ml:1},children:e.title})]}),e.class_link&&("tutor"===ce&&"Login"!==e.attendance_status||"student"===ce&&"present"!==e.attendance_status)&&(0,Z.jsx)(c.Z,{variant:"caption",component:m?"a":"span",onClick:!m||f?void 0:function(){return he(e)},sx:{color:m?"primary.main":"text.disabled",textDecoration:"none","&:hover":{textDecoration:!m||f?"none":"underline"},display:"inline-block",cursor:!m||f?"default":"pointer",background:"none",border:"none",font:"inherit",outline:"inherit",opacity:f?.6:1},disabled:f,children:f?"Processing...":m?"Join Meeting":"Class Not Available"}),"Login"===e.attendance_status&&(0,Z.jsx)(c.Z,{variant:"caption",component:x||!h?"span":"a",onClick:x||!h||f?void 0:function(){return ve(e)},sx:{color:x?"text.disabled":h?"primary.main":"text.secondary",textDecoration:"none","&:hover":{textDecoration:x||!h||f?"none":"underline"},display:"inline-block",cursor:x||!h||f?"default":"pointer",background:"none",border:"none",font:"inherit",outline:"inherit",opacity:f?.6:1},disabled:f,children:f?"Processing...":"Logout"})]})}),(0,Z.jsx)(a.ZP,{item:!0,xs:4,sm:3,children:(0,Z.jsxs)(p.Z,{spacing:.5,alignItems:"flex-end",children:[(0,Z.jsx)(c.Z,{variant:"caption",color:"text.secondary",children:"".concat(e.start_time," - ").concat(e.end_time)}),(0,Z.jsx)(S.Z,{color:s,size:"small",label:e.status,sx:{textTransform:"capitalize"}})]})})]})},"".concat(e.course_name,"-").concat(t))}(e,t,n)})):(0,Z.jsx)(v.Z,{sx:{p:3,textAlign:"center"},children:(0,Z.jsx)(c.Z,{variant:"body1",color:"text.secondary",children:"No classes scheduled for this day"})})})}),(0,Z.jsx)(x.Z,{sx:{bgcolor:"background.paper",borderTop:1,borderColor:"divider"},children:(0,Z.jsx)(h.Z,{onClick:de,variant:"contained",color:"primary",children:"Close"})})]})]})}W.defaultProps={schedule:[]};var F=n(57621),B=n(42169),q=n(39504),U=function(e){var t=e.courses,n=e.onEnroll;return t&&0!==t.length?(0,Z.jsx)(a.ZP,{container:!0,spacing:3,children:t.map((function(e){return(0,Z.jsx)(a.ZP,{item:!0,xs:12,sm:6,md:4,children:(0,Z.jsxs)(F.Z,{sx:{height:"100%",display:"flex",flexDirection:"column"},children:[(0,Z.jsx)(B.Z,{component:"img",height:"160",image:e.course_pic_url,alt:e.course_name}),(0,Z.jsxs)(q.Z,{sx:{flexGrow:1},children:[(0,Z.jsx)(c.Z,{variant:"h6",gutterBottom:!0,children:e.course_name}),(0,Z.jsx)(c.Z,{variant:"body2",color:"text.secondary",children:e.course_category}),e.duration&&(0,Z.jsxs)(c.Z,{variant:"caption",display:"block",children:["Duration: ",e.duration]}),(0,Z.jsx)(h.Z,{variant:"contained",sx:{mt:2},onClick:function(){return n(e)},children:"Enroll Now"})]})]})},e.course_id)}))}):null},Y=function(e){var t=e.attendance,n=(0,i.Z)(),r=(0,k.Z)(n.breakpoints.down("sm")),s=n.palette.mode,a=n.palette.text.primary,c=n.palette.divider,l=n.palette.background.paper,d=(null===t||void 0===t?void 0:t.present)||0,u=(null===t||void 0===t?void 0:t.absent)||0,x=null===t||void 0===t?void 0:t.total,h=[d,u],p=(0,y.useState)({chart:{type:"donut",height:320},labels:["Present","Absent"],legend:{show:!1},dataLabels:{enabled:!1}}),v=(0,o.Z)(p,2),m=v[0],g=v[1];return(0,y.useEffect)((function(){var e=n.palette.success.dark,t=n.palette.error.dark;g((function(n){return(0,b.Z)((0,b.Z)({},n),{},{colors:[e,t],xaxis:{labels:{style:{colors:[a,a]}}},yaxis:{labels:{style:{colors:[a]}}},grid:{borderColor:c},stroke:{colors:[l]},theme:{mode:s===w.hY.DARK?"dark":"light"}})}))}),[s,a,c,l,n,x]),(0,Z.jsx)("div",{id:"chart",children:(0,Z.jsx)(_.Z,{options:m,series:h,type:"donut",height:r?280:320})})},H=function(e){var t=e.attendance;return(0,Z.jsx)(m.Z,{children:(0,Z.jsxs)(a.ZP,{container:!0,spacing:3,children:[(0,Z.jsx)(a.ZP,{item:!0,xs:12,children:(0,Z.jsx)(p.Z,{direction:"row",alignItems:"center",justifyContent:"space-between",spacing:1,children:(0,Z.jsx)(c.Z,{variant:"h5",children:"Today Attendance"})})}),(0,Z.jsx)(a.ZP,{item:!0,xs:12,display:"flex",justifyContent:"center",children:0===(null===t||void 0===t?void 0:t.present)&&0===(null===t||void 0===t?void 0:t.absent)?(0,Z.jsx)(c.Z,{variant:"subtitle1",children:"No Data Available"}):(0,Z.jsx)(Y,{attendance:t})}),(0,Z.jsxs)(a.ZP,{item:!0,xs:12,display:"flex",justifyContent:"space-between",children:[(0,Z.jsxs)(p.Z,{direction:"row",alignItems:"center",justifyContent:"center",spacing:1,children:[(0,Z.jsx)(c.Z,{variant:"subtitle1",children:"Present : "}),(0,Z.jsx)(c.Z,{color:"success.dark",sx:{display:"flex",alignItems:"center",gap:.5,fontWeight:500},children:null===t||void 0===t?void 0:t.present})]}),(0,Z.jsxs)(p.Z,{direction:"row",alignItems:"center",justifyContent:"center",spacing:1,children:[(0,Z.jsx)(c.Z,{variant:"subtitle1",children:"Absent : "}),(0,Z.jsx)(c.Z,{color:"error.dark",sx:{display:"flex",alignItems:"center",gap:.5,fontWeight:500},children:null===t||void 0===t?void 0:t.absent})]})]})]})})},J=n(63266),K=n(17875),z=n(56416),G=n(71652),X=n(12649),Q=n(74213),V=n(99145),$=function(e){var t=e.color,n=void 0===t?"primary":t,r=e.title,s=e.count,o=e.percentage,i=e.isLoss;return(0,Z.jsx)(m.Z,{contentSX:{p:2.25},children:(0,Z.jsxs)(p.Z,{spacing:.5,children:[(0,Z.jsxs)(c.Z,{variant:"h5",color:"inherit",children:["Course : ",r]}),(0,Z.jsxs)(a.ZP,{container:!0,alignItems:"center",justifyContent:"space-between",children:[(0,Z.jsx)(a.ZP,{item:!0,children:(0,Z.jsxs)(c.Z,{variant:"h6",color:"secondary",children:["Total Assignments : ",s]})}),o&&(0,Z.jsx)(a.ZP,{item:!0,children:(0,Z.jsx)(S.Z,{variant:"combined",color:n,icon:(0,Z.jsxs)(Z.Fragment,{children:[!i&&(0,Z.jsx)(Q.Z,{style:{transform:"rotate(45deg)"}}),i&&(0,Z.jsx)(V.Z,{style:{transform:"rotate(45deg)"}})]}),label:"".concat(o,"%"),sx:{ml:1.25,pl:1,borderRadius:1},size:"small"})})]})]})})},ee=n(57689),te=n(80310),ne=function(){var e,t,n=(0,i.Z)(),p=(0,ee.s0)(),v=JSON.parse(localStorage.getItem("auth")),m=null===v||void 0===v?void 0:v.loginType,g=(0,y.useState)(null),f=(0,o.Z)(g,2),b=f[0],k=f[1],_=(0,y.useState)([]),C=(0,o.Z)(_,2),D=C[0],S=C[1],A=(0,y.useState)({}),E=(0,o.Z)(A,2),I=E[0],T=E[1],R=(0,y.useState)([]),L=(0,o.Z)(R,2),N=L[0],O=L[1],F=(0,y.useState)([]),B=(0,o.Z)(F,2),q=B[0],Y=B[1],Q=(0,y.useState)(!1),V=(0,o.Z)(Q,2),ne=V[0],re=V[1],se=(0,y.useState)(null),oe=(0,o.Z)(se,2),ie=oe[0],ae=oe[1];console.log("scheduleData :",D);var ce=(0,y.useCallback)((0,s.Z)((0,r.Z)().mark((function e(){var t,n;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,M.Z.get("".concat(w.t6,"api/dashboard"));case 2:t=e.sent,n=t.data,k(null===n||void 0===n?void 0:n.data),S((null===n||void 0===n?void 0:n.schedule)||[]),T((null===n||void 0===n?void 0:n.attendance)||{}),console.log("Dashboard userType:",m),Y((null===n||void 0===n?void 0:n.featured_courses)||[]),"employer"===m&&(T(n.data.attendance),O(n.data.assignments.per_courses));case 10:case"end":return e.stop()}}),e)}))),[m]),le=function(){var e=(0,s.Z)((0,r.Z)().mark((function e(){var t,n,s;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={ticket_type:"course_enquiry",course_id:ie.id,subject:"Enrollment enquiry for ".concat(ie.course_name),message:"Student ".concat(v.user.name," requested enrollment")},console.log("API PAYLOAD:",t),e.prev=2,e.next=5,M.Z.post("".concat(w.t6,"api/tickets/"),t);case 5:n=e.sent,console.log("API RESPONSE:",n.data),re(!1),alert("Enrollment request sent successfully"),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(2),console.error("API ERROR:",(null===(s=e.t0.response)||void 0===s?void 0:s.data)||e.t0.message),alert("Failed to send enrollment request");case 15:case"end":return e.stop()}}),e,null,[[2,11]])})));return function(){return e.apply(this,arguments)}}();return(0,y.useEffect)((function(){var e;ce(),console.log("AUTH DATA FROM LOGIN:",v),console.log("STUDENT ID FROM AUTH:",null===v||void 0===v||null===(e=v.user)||void 0===e?void 0:e.student_id)}),[ce]),(0,Z.jsxs)(a.ZP,{container:!0,rowSpacing:4.5,columnSpacing:2.75,children:[("admin"===m||"super_admin"===m)&&(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)(a.ZP,{item:!0,xs:12,sm:6,lg:3,onClick:function(){return p("/batch")},children:(0,Z.jsx)(j,{title:"Active Batches",count:null===b||void 0===b?void 0:b.active_batches,color:"error",iconPrimary:(0,Z.jsx)(te.Z,{})})}),(0,Z.jsx)(a.ZP,{item:!0,xs:12,sm:6,lg:3,onClick:function(){return p("/course")},children:(0,Z.jsx)(j,{title:"Active Courses",count:null===b||void 0===b?void 0:b.active_courses,color:"warning",iconPrimary:(0,Z.jsx)(J.Z,{color:n.palette.warning.dark})})}),(0,Z.jsx)(a.ZP,{item:!0,xs:12,sm:6,lg:3,onClick:function(){return p("/students")},children:(0,Z.jsx)(j,{title:"Active Students",count:null===b||void 0===b?void 0:b.active_students,color:"success",iconPrimary:(0,Z.jsx)(K.Z,{color:n.palette.success.dark})})}),(0,Z.jsx)(a.ZP,{item:!0,xs:12,sm:6,lg:3,onClick:function(){return p("/tutors")},children:(0,Z.jsx)(j,{title:"Active Tutors",count:null===b||void 0===b?void 0:b.active_trainers,color:"error",iconPrimary:(0,Z.jsx)(z.Z,{color:n.palette.error.dark})})})]}),"employer"===m&&(0,Z.jsx)(a.ZP,{item:!0,xs:12,children:(0,Z.jsx)(a.ZP,{container:!0,spacing:3,children:null===N||void 0===N?void 0:N.map((function(e){return(0,Z.jsx)(a.ZP,{item:!0,xs:12,sm:6,md:4,sx:{cursor:"pointer"},onClick:function(){return p("/report",{state:{per_courses:N}})},children:(0,Z.jsx)($,{title:e.course_name,count:e.total_assignments})},e.course_id)}))})}),"student"===m&&(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)(a.ZP,{item:!0,xs:12,md:6,children:(0,Z.jsx)(G._,{dateAdapter:X.H,children:(0,Z.jsx)(W,{schedule:D,fetchData:ce})})}),(0,Z.jsx)(a.ZP,{item:!0,xs:12,md:6,children:(0,Z.jsx)(P,{attendance:I})})]}),"student"===m&&(null===q||void 0===q?void 0:q.length)>0&&(0,Z.jsxs)(a.ZP,{item:!0,xs:12,children:[(0,Z.jsx)(c.Z,{variant:"h5",sx:{mb:2},children:"Popular Courses"}),(0,Z.jsx)(U,{courses:q,onEnroll:function(e){console.log("ENROLL CLICKED"),console.log("COURSE:",e),console.log("STUDENT:",null===v||void 0===v?void 0:v.user),ae(e),re(!0)}})]}),"tutor"===m&&(0,Z.jsx)(Z.Fragment,{children:(0,Z.jsx)(a.ZP,{item:!0,xs:12,md:6,children:(0,Z.jsx)(G._,{dateAdapter:X.H,children:(0,Z.jsx)(W,{schedule:D,fetchData:ce})})})}),"employer"===m&&(0,Z.jsx)(Z.Fragment,{children:(0,Z.jsx)(a.ZP,{item:!0,xs:12,md:6,children:(0,Z.jsx)(H,{attendance:null===I||void 0===I?void 0:I.today})})}),(0,Z.jsxs)(l.Z,{open:ne,onClose:function(){return re(!1)},children:[(0,Z.jsx)(d.Z,{children:"Confirm Enrollment"}),(0,Z.jsxs)(u.Z,{children:[(0,Z.jsxs)(c.Z,{children:["Are you sure you want to enroll in",(0,Z.jsxs)("strong",{children:[" ",null===ie||void 0===ie?void 0:ie.title]}),"?"]}),(0,Z.jsxs)(c.Z,{sx:{mt:2},children:["Name: ",(0,Z.jsx)("strong",{children:null===v||void 0===v||null===(e=v.user)||void 0===e?void 0:e.name}),(0,Z.jsx)("br",{}),"Registration ID: ",(0,Z.jsx)("strong",{children:null===v||void 0===v||null===(t=v.user)||void 0===t?void 0:t.registration_id})]})]}),(0,Z.jsxs)(x.Z,{children:[(0,Z.jsx)(h.Z,{onClick:function(){return re(!1)},children:"Cancel"}),(0,Z.jsx)(h.Z,{variant:"contained",onClick:le,children:"Yes, Submit"})]})]})]})}}}]);
//# sourceMappingURL=3390.5eae18ab.chunk.js.map