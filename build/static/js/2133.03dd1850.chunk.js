"use strict";(self.webpackChunkable_pro_material_react=self.webpackChunkable_pro_material_react||[]).push([[2133],{42664:function(e,t,r){r.d(t,{g:function(){return s}});var n=r(72791),s=function(){return{checkPermission:(0,n.useCallback)((function(e,t){try{var r,n=JSON.parse(localStorage.getItem("auth")||"[]"),s=null===n||void 0===n?void 0:n.loginType,i=(null===n||void 0===n||null===(r=n.user)||void 0===r?void 0:r.permissions)||[];return"super_admin"===s||"admin"===s&&i.some((function(r){return r.module_name===e&&r.allowed_actions.includes(t)}))}catch(o){return console.error("Error checking permission:",o),!1}}),[])}}},72133:function(e,t,r){r.r(t),r.d(t,{default:function(){return lt}});var n=r(61819),s=r(15861),i=r(29439),o=r(1413),a=r(45987),l=r(72791),c=r(24034),d=r(697),u=r(61889),x=r(36314),p=r(13400),h=r(20890),m=r(62114),f=r(43896),b=(r(91587),r(57689)),g=r(79971),v=r(92329),Z=r(88433),j=r(71652),y=r(12649),k=r(16274),w=r(42161),C=r(93433),S=r(94294),_=r(57621),E=r(39504),B=r(72363),I=r(20068),T=r(13239),P=r(71444),A=r(61880),z=r(49769),W=r(97011),F=r(75374),q=r(48605),R=r(95305),D=r(91164),N=r(42664),H=r(80184),M=function(e){var t=e.data,r=e.onAddItem,a=e.onUpdateItem,c=(0,(0,N.g)().checkPermission)("Course","update"),x=(0,l.useState)(t||[]),m=(0,i.Z)(x,2),f=m[0],b=m[1],g=(0,l.useState)(!1),v=(0,i.Z)(g,2),k=v[0],w=v[1],M=(0,l.useState)(!1),O=(0,i.Z)(M,2),Y=O[0],L=O[1],V=(0,l.useState)(null),U=(0,i.Z)(V,2),Q=U[0],K=U[1],$=(0,l.useState)(!1),G=(0,i.Z)($,2),J=G[0],X=G[1],ee=(0,l.useState)(!1),te=(0,i.Z)(ee,2),re=te[0],ne=te[1],se=(0,l.useState)(null),ie=(0,i.Z)(se,2),oe=ie[0],ae=ie[1],le=(0,l.useState)({date:new Date,file:null}),ce=(0,i.Z)(le,2),de=ce[0],ue=ce[1],xe=JSON.parse(localStorage.getItem("auth")),pe=null===xe||void 0===xe?void 0:xe.loginType;(0,l.useEffect)((function(){oe&&(0,D.WI)((0,R.ss)({open:!0,message:oe,variant:"alert",alert:{color:"error"},close:!1}))}),[oe]),(0,l.useEffect)((function(){t?(b(t.filter((function(e){return void 0!==e}))),X(!1)):X(!0)}),[t]);var he=function(){var e=(0,s.Z)((0,n.Z)().mark((function e(){var t,s;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(ne(!0),ae(null),e.prev=2,!Y){e.next=10;break}return e.next=6,a(Q,de);case 6:t=e.sent,b(f.map((function(e){return e.id===Q?t:e}))),e.next=14;break;case 10:return e.next=12,r(de);case 12:s=e.sent,b([].concat((0,C.Z)(f.filter((function(e){return void 0!==e}))),[s]));case 14:fe(),e.next=21;break;case 17:e.prev=17,e.t0=e.catch(2),ae(e.t0.message||"An error occurred"),console.error("Error ".concat(Y?"updating":"adding"," syllabus item:"),e.t0);case 21:return e.prev=21,ne(!1),e.finish(21);case 24:case"end":return e.stop()}}),e,null,[[2,17,21,24]])})));return function(){return e.apply(this,arguments)}}(),me=function(){L(!1),K(null),ue({date:new Date,file:null}),w(!0)},fe=function(){w(!1),L(!1),K(null),ue({date:new Date,file:null})},be=function(e){if(e.target.files.length>0){var t=e.target.files[0];ue((function(e){return(0,o.Z)((0,o.Z)({},e),{},{file:t})}))}},ge=function(e){return e.includes("image")?(0,H.jsx)(P.Z,{size:"48",color:"#666"}):e.includes("pdf")?(0,H.jsx)(A.Z,{size:"48",color:"#ff5252"}):e.includes("word")||e.includes("document")?(0,H.jsx)(A.Z,{size:"48",color:"#2b579a"}):e.includes("excel")||e.includes("sheet")?(0,H.jsx)(A.Z,{size:"48",color:"#217346"}):e.includes("powerpoint")||e.includes("presentation")?(0,H.jsx)(A.Z,{size:"48",color:"#d24726"}):(0,H.jsx)(Z.Z,{size:"48",color:"#666"})},ve=(0,l.useState)(!1),Ze=(0,i.Z)(ve,2),je=Ze[0],ye=Ze[1],ke=(0,l.useState)(null),we=(0,i.Z)(ke,2),Ce=we[0],Se=we[1],_e=(0,l.useCallback)((function(e){Se(e),ye(!0)}),[]);return J?(0,H.jsx)(d.Z,{sx:{p:3,display:"flex",justifyContent:"center",alignItems:"center",minHeight:"300px"},children:(0,H.jsx)(T.Z,{})}):(0,H.jsx)(j._,{dateAdapter:y.H,children:(0,H.jsxs)(d.Z,{sx:{p:3},children:[f.length>0?(0,H.jsxs)(u.ZP,{container:!0,spacing:3,children:[(0,H.jsx)(u.ZP,{item:!0,container:!0,spacing:3,children:f.filter((function(e){return void 0!==e})).map((function(e){return(0,H.jsx)(u.ZP,{item:!0,xs:12,sm:6,md:4,children:(0,H.jsxs)(_.Z,{sx:{mb:2,cursor:"pointer",border:"1px solid",borderColor:"divider","&:hover":{backgroundColor:"#f5f5f5",transform:"translateY(-4px)",borderColor:"secondary.light"},borderRadius:2,transition:"all 0.2s ease",position:"relative",minHeight:120},children:[(0,H.jsxs)(E.Z,{sx:{flexGrow:1},children:[(0,H.jsx)(d.Z,{sx:{display:"flex",justifyContent:"center",my:2},children:ge(e.file.type)}),(0,H.jsx)(h.Z,{variant:"h4",fontWeight:600,gutterBottom:!0,sx:{textAlign:"center"},children:"Course Syllabus"}),(0,H.jsx)(h.Z,{variant:"body2",color:"text.secondary",fontWeight:600,sx:{textAlign:"center"},children:"View the complete syllabus for this course to see all learning objectives, topics covered, and assessment criteria."})]}),(0,H.jsx)(B.Z,{sx:{justifyContent:"space-between",p:2},children:(0,H.jsx)(d.Z,{children:(0,H.jsx)(I.Z,{title:"View",children:(0,H.jsx)(p.Z,{color:"secondary",sx:{mr:1},onClick:function(){return _e(e)},children:(0,H.jsx)(z.Z,{})})})})})]})},e.id)}))}),(0,H.jsx)(u.ZP,{item:!0,xs:12,container:!0,justifyContent:"center",children:c&&(0,H.jsx)(S.Z,{variant:"contained",onClick:me,startIcon:(0,H.jsx)(W.Z,{}),disabled:J,sx:{width:"auto"},children:"Update Syllabus"})})]}):(0,H.jsx)(d.Z,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:"300px",textAlign:"center",bgcolor:"background.paper",borderRadius:2,p:4},children:J?(0,H.jsx)(h.Z,{children:"Processing..."}):(0,H.jsxs)(H.Fragment,{children:[(0,H.jsx)(Z.Z,{size:"64",color:"#ddd"}),(0,H.jsx)(h.Z,{variant:"h6",color:"textSecondary",sx:{mt:2},children:"No Syllabus Uploaded Yet"}),"admin"===pe&&(0,H.jsxs)(H.Fragment,{children:[(0,H.jsx)(h.Z,{variant:"body2",color:"textSecondary",sx:{mt:1},children:"Click the Upload Syllabus button to add your first syllabus file"}),(0,H.jsx)(d.Z,{mt:2,children:(0,H.jsx)(S.Z,{variant:"contained",disabled:re,onClick:me,startIcon:(0,H.jsx)(W.Z,{}),children:"Upload Syllabus"})})]})]})}),(0,H.jsx)(q.Z,{open:k,onClose:fe,children:(0,H.jsxs)(d.Z,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:500,bgcolor:"background.paper",boxShadow:24,p:4,borderRadius:2},children:[(0,H.jsx)(h.Z,{variant:"h5",gutterBottom:!0,children:Y?"Edit Syllabus":"Upload Syllabus"}),(0,H.jsx)(d.Z,{sx:{border:"2px dashed #ddd",borderRadius:2,p:4,textAlign:"center",mb:2,bgcolor:de.file?"action.hover":"background.paper"},onDragOver:function(e){e.preventDefault(),e.stopPropagation()},onDrop:function(e){e.preventDefault(),e.stopPropagation(),e.dataTransfer.files&&e.dataTransfer.files.length>0&&be({target:{files:e.dataTransfer.files}})},children:de.file?(0,H.jsxs)(d.Z,{children:[(0,H.jsx)(d.Z,{sx:{display:"flex",justifyContent:"center",mb:1},children:ge(de.file.type)}),(0,H.jsx)(h.Z,{variant:"body1",children:de.file.name}),(0,H.jsx)(h.Z,{variant:"caption",color:"text.secondary",children:function(e){if(0===e)return"0 Bytes";var t=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,t)).toFixed(2))+" "+["Bytes","KB","MB","GB"][t]}(de.file.size)}),(0,H.jsx)(d.Z,{sx:{mt:2},children:(0,H.jsx)(S.Z,{variant:"outlined",color:"error",onClick:function(){ue((function(e){return(0,o.Z)((0,o.Z)({},e),{},{file:null})}))},startIcon:(0,H.jsx)(F.Z,{}),children:"Remove File"})})]}):(0,H.jsxs)(H.Fragment,{children:[(0,H.jsx)(W.Z,{size:"48",color:"#666"}),(0,H.jsx)(h.Z,{variant:"body1",sx:{mt:1},children:"Drag & drop syllabus file here or"}),(0,H.jsx)("input",{type:"file",id:"syllabus-upload",onChange:be,style:{display:"none"},accept:".pdf,.doc,.docx,.ppt,.pptx,.jpg,.png,.jpeg,.txt,.xls,.xlsx,.mp4,.mp3"}),(0,H.jsx)("label",{htmlFor:"syllabus-upload",children:(0,H.jsx)(S.Z,{variant:"contained",component:"span",sx:{mt:1},children:"Browse Files"})})]})}),oe&&(0,H.jsx)(h.Z,{color:"error",sx:{mb:2},children:oe}),(0,H.jsxs)(d.Z,{sx:{display:"flex",justifyContent:"flex-end",mt:2},children:[(0,H.jsx)(S.Z,{onClick:fe,sx:{mr:2},disabled:J,children:"Cancel"}),(0,H.jsx)(S.Z,{variant:"contained",onClick:he,disabled:!de.file||J,children:J?"Processing...":Y?"Update Syllabus":"Upload Syllabus"})]})]})}),(0,H.jsx)(q.Z,{open:je,onClose:function(){return ye(!1)},sx:{display:"flex",alignItems:"center",justifyContent:"center",backdropFilter:"blur(4px)"},children:(0,H.jsxs)(d.Z,{sx:{width:"90vw",height:"90vh",bgcolor:"background.paper",boxShadow:24,borderRadius:2,display:"flex",flexDirection:"column",overflow:"hidden"},children:[(0,H.jsxs)(d.Z,{sx:{p:2,borderBottom:1,borderColor:"divider",display:"flex",justifyContent:"space-between",alignItems:"center",bgcolor:"grey.50"},children:[(0,H.jsx)(h.Z,{variant:"h6",noWrap:!0,sx:{maxWidth:"70%"},children:null===Ce||void 0===Ce?void 0:Ce.file.name}),(0,H.jsx)(d.Z,{children:(0,H.jsx)(I.Z,{title:"Close",children:(0,H.jsx)(p.Z,{onClick:function(){return ye(!1)},children:(0,H.jsx)(F.Z,{})})})})]}),(0,H.jsx)(d.Z,{sx:{flexGrow:1,overflow:"hidden",position:"relative"},children:function(){if(!Ce)return null;var e=Ce.file.url,t=Ce.file.name,r=Ce.file.type,n=function(e,t){var r,n=(null===e||void 0===e||null===(r=e.split(".").pop())||void 0===r?void 0:r.toLowerCase())||"",s=(null===t||void 0===t?void 0:t.toLowerCase())||"";return["jpg","jpeg","png","gif","webp","svg","bmp","tiff"].includes(n)||s.includes("image")?"image":"pdf"===n||s.includes("pdf")?"pdf":["txt","csv","json","xml","md"].includes(n)||s.includes("text")?"text":["doc","docx"].includes(n)||s.includes("word")||s.includes("document")?"word":["xls","xlsx","csv"].includes(n)||s.includes("excel")||s.includes("sheet")?"excel":["ppt","pptx"].includes(n)||s.includes("powerpoint")||s.includes("presentation")?"powerpoint":["mp4","avi","mov","wmv","flv","webm"].includes(n)||s.includes("video")?"video":["mp3","wav","ogg","aac"].includes(n)||s.includes("audio")?"audio":"unknown"}(t,r);switch(n){case"image":case"text":case"pdf":case"word":case"excel":case"powerpoint":var s="https://docs.google.com/gview?url=".concat(encodeURIComponent(e),"&embedded=true");return(0,H.jsx)("iframe",{src:s,width:"100%",height:"100%",title:t,style:{border:"none"},onError:function(e){console.error("Google Docs Viewer failed:",e),e.target.style.display="none";var t=document.getElementById("fallback-preview");t&&(t.style.display="flex")}});default:return(0,H.jsxs)(d.Z,{id:"fallback-preview",sx:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"100%",p:3},children:[(0,H.jsx)(A.Z,{size:"64",color:"#666"}),(0,H.jsx)(h.Z,{variant:"h6",sx:{mt:2,mb:1},children:"Preview Not Available"}),(0,H.jsx)(h.Z,{variant:"body2",color:"text.secondary",sx:{mb:3,textAlign:"center"},children:"This file type cannot be previewed in the browser. Please download the file to view it."}),(0,H.jsx)(S.Z,{variant:"contained",onClick:function(){return window.open(e,"_blank")},startIcon:(0,H.jsx)(z.Z,{}),sx:{mb:1},children:"Open in New Tab"}),(0,H.jsx)(S.Z,{variant:"outlined",onClick:function(){var r=document.createElement("a");r.href=e,r.download=t,r.click()},startIcon:(0,H.jsx)(W.Z,{}),children:"Download File"})]})}}()}),(0,H.jsxs)(d.Z,{sx:{p:2,borderTop:1,borderColor:"divider",display:"flex",justifyContent:"space-between",alignItems:"center",bgcolor:"grey.50"},children:[(0,H.jsxs)(h.Z,{variant:"body2",color:"text.secondary",children:["File type: ",(null===Ce||void 0===Ce?void 0:Ce.file.type)||"Unknown"]}),("admin"===pe||"super_admin"===pe)&&(0,H.jsx)(S.Z,{variant:"contained",onClick:function(){var e=document.createElement("a");e.href=null===Ce||void 0===Ce?void 0:Ce.file.url,e.download=null===Ce||void 0===Ce?void 0:Ce.file.name,e.click()},startIcon:(0,H.jsx)(W.Z,{}),children:"Download"})]})]})})]})})},O=r(9585),Y=r(94454),L=r(4729),V=r(56125),U=r(17133),Q=r(62634),K=r(17139),$=r(64370),G=r(72010),J=r(66490),X=r(1701),ee=r.n(X),te=(r(3321),r(25646),r(48550)),re=r(51802),ne=function(e){var t=e.editorState,r=e.onEditorStateChange;return(0,H.jsx)(re.Editor,{editorState:t,toolbarClassName:"toolbarClassName",wrapperClassName:"wrapperClassName",editorClassName:"editorClassName",onEditorStateChange:r,toolbar:{options:["inline","blockType","fontSize","fontFamily","list","textAlign","colorPicker","link","embedded","emoji","image","remove","history"],colorPicker:{colors:["rgb(97,189,109)","rgb(26,188,156)","rgb(84,172,210)","rgb(44,130,201)","rgb(147,101,184)","rgb(71,85,119)","rgb(204,204,204)","rgb(0,0,0)","rgb(255,255,255)","rgb(244,67,54)","rgb(233,30,99)","rgb(156,39,176)","rgb(103,58,183)","rgb(63,81,181)","rgb(33,150,243)","rgb(0,188,212)","rgb(0,150,136)","rgb(76,175,80)","rgb(139,195,74)","rgb(205,220,57)","rgb(255,235,59)","rgb(255,193,7)","rgb(255,152,0)","rgb(255,87,34)","rgb(121,85,72)"]},inline:{options:["bold","italic","underline","strikethrough","monospace"],className:void 0,component:void 0,dropdownClassName:void 0}}})},se=r(89731),ie=r(23197),oe=r(21830),ae=r.n(oe),le=r(36277),ce=r(8007),de=ce.Ry({title:ce.Z_().required("Title is required").max(100,"Title must not exceed 100 characters").test("no-spaces-only","Title cannot be only spaces",(function(e){return e&&e.trim().length>0})),description:ce.Z_().required("Content is required").test("valid-content","Please add meaningful content",(function(e){return!!e&&e.replace(/<[^>]*>/g,"").replace(/&nbsp;/g," ").replace(/&\w+;/g," ").trim().length>0}))}),ue=function(e){var t,r=e.courseId,o=(0,N.g)().checkPermission,a=o("Course","create"),c=o("Course","update"),m=o("Course","delete"),f=(0,l.useState)(G.EditorState.createEmpty()),b=(0,i.Z)(f,2),g=b[0],v=b[1],Z=(0,l.useState)(!1),j=(0,i.Z)(Z,2),y=j[0],k=j[1],w=(0,l.useState)(!1),C=(0,i.Z)(w,2),B=C[0],T=C[1],P=(0,l.useState)([]),A=(0,i.Z)(P,2),z=A[0],F=A[1],R=(0,l.useState)(!0),D=(0,i.Z)(R,2),M=D[0],X=D[1],re=(0,l.useState)(null),oe=(0,i.Z)(re,2),ce=oe[0],ue=oe[1],xe=(0,l.useState)(null),pe=(0,i.Z)(xe,2),he=pe[0],me=pe[1],fe=(0,l.useState)(null),be=(0,i.Z)(fe,2),ge=be[0],ve=be[1],Ze=JSON.parse(localStorage.getItem("auth")),je=null===Ze||void 0===Ze?void 0:Ze.loginType,ye=null===Ze||void 0===Ze?void 0:Ze.id,ke=null===Ze||void 0===Ze||null===(t=Ze.user)||void 0===t?void 0:t.student_id,we=(0,le.TA)({initialValues:{id:null,title:"",description:""},validationSchema:de,onSubmit:function(){var e=(0,s.Z)((0,n.Z)().mark((function e(t,s){var i,o,a;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=s.setSubmitting,o=s.resetForm,e.prev=1,a={title:t.title,description:t.description,created_by:ye,status:!1},!B||!t.id){e.next=8;break}return e.next=6,se.Z.put("".concat(ie.t6,"/api/courses/").concat(r,"/topic/").concat(t.id),a);case 6:e.next=10;break;case 8:return e.next=10,se.Z.post("".concat(ie.t6,"/api/courses/").concat(r,"/topic"),a);case 10:return e.next=12,Ce();case 12:k(!1),T(!1),o(),v(G.EditorState.createEmpty()),e.next=23;break;case 18:e.prev=18,e.t0=e.catch(1),console.error("Error saving topic:",e.t0),ue(e.t0.message),ae().fire({title:"Error!",text:e.t0.message||"Error saving topic",icon:"error",confirmButtonText:"OK"});case 23:return e.prev=23,i(!1),e.finish(23);case 26:case"end":return e.stop()}}),e,null,[[1,18,23,26]])})));return function(t,r){return e.apply(this,arguments)}}()}),Ce=(0,l.useCallback)((0,s.Z)((0,n.Z)().mark((function e(){var t,s;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,X(!0),"student"!==je){e.next=15;break}return e.next=5,se.Z.get("".concat(ie.t6,"/api/courses/").concat(r,"/topic/").concat(ke,"/status"));case 5:if(!(t=e.sent).data.success){e.next=13;break}if(!Array.isArray(t.data.all_topics)){e.next=12;break}F(t.data.all_topics),ve(t.data.completed_topics),e.next=13;break;case 12:throw new Error("Invalid response format - expected array of topics");case 13:e.next=24;break;case 15:return e.next=17,se.Z.get("".concat(ie.t6,"/api/courses/").concat(r,"/topic"));case 17:if(!(s=e.sent).data.success){e.next=24;break}if(!Array.isArray(s.data.data)){e.next=23;break}F(s.data.data),e.next=24;break;case 23:throw new Error("Invalid response format - expected array of topics");case 24:e.next=30;break;case 26:e.prev=26,e.t0=e.catch(0),console.error("Error fetching topics:",e.t0),ue(e.t0.message);case 30:return e.prev=30,X(!1),e.finish(30);case 33:case"end":return e.stop()}}),e,null,[[0,26,30,33]])}))),[r,ke,je]);(0,l.useEffect)((function(){r&&Ce()}),[r,Ce]);var Se=function(){var e=(0,s.Z)((0,n.Z)().mark((function e(t){var s,i,o;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ae().fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!"});case 2:if(!e.sent.isConfirmed){e.next=22;break}return e.prev=4,s={is_archived:!0},e.next=8,se.Z.patch("".concat(ie.t6,"/api/courses/").concat(r,"/topic/").concat(t),s);case 8:if(!0!==(i=e.sent).data.success){e.next=15;break}return ae().fire({title:"Success!",text:"Topic deleted successfully!",icon:"success",confirmButtonText:"OK"}),e.next=13,Ce();case 13:e.next=16;break;case 15:ae().fire({title:"Error!",text:(null===i||void 0===i||null===(o=i.data)||void 0===o?void 0:o.message)||"Error deleting Topic.",icon:"error",confirmButtonText:"OK"});case 16:e.next=22;break;case 18:e.prev=18,e.t0=e.catch(4),ue(e.t0.message),ae().fire({title:"Error!",text:e.t0.message||"Error Topic.",icon:"error",confirmButtonText:"OK"});case 22:case"end":return e.stop()}}),e,null,[[4,18]])})));return function(t){return e.apply(this,arguments)}}(),_e=function(){var e=(0,s.Z)((0,n.Z)().mark((function e(t){var s,i,o,a,l,c,d;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ae().fire({title:"Have you completed this topic?",text:"Please confirm by checking this box only if you've fully understood and completed all the material.",icon:"question",showCancelButton:!0,confirmButtonColor:"#28a745",cancelButtonColor:"#6c757d",confirmButtonText:"Yes, I have completed it!",cancelButtonText:"No, not yet",focusConfirm:!0});case 2:if(!e.sent.isConfirmed){e.next=34;break}return e.next=6,ae().fire({title:"Rate this topic",input:"select",inputOptions:{1:"\u2b50",2:"\u2b50\u2b50",3:"\u2b50\u2b50\u2b50",4:"\u2b50\u2b50\u2b50\u2b50",5:"\u2b50\u2b50\u2b50\u2b50\u2b50"},inputLabel:"How would you rate this topic? (1-5 stars)",inputPlaceholder:"Select a rating",showCancelButton:!0,confirmButtonText:"Next",cancelButtonText:"Cancel",inputValidator:function(e){return e?null:"You need to select a rating!"}});case 6:if(s=e.sent,void 0!==(i=s.value)){e.next=10;break}return e.abrupt("return");case 10:return e.next=12,ae().fire({title:"Please provide your feedback",input:"textarea",inputLabel:"Notes/Feedback (required)",inputPlaceholder:"Enter your notes or feedback about this topic...",inputAttributes:{"aria-label":"Type your notes here"},showCancelButton:!0,confirmButtonText:"Submit",cancelButtonText:"Cancel",inputValidator:function(e){return e&&""!==e.trim()?null:"You must enter feedback to submit!"}});case 12:if(o=e.sent,void 0===(a=o.value)){e.next=34;break}return e.prev=15,l={status:!0,student:ke,notes:a||"",topic:t,ratings:parseInt(i)},e.next=19,se.Z.post("".concat(ie.t6,"/api/courses/").concat(r,"/topic/").concat(ke,"/status"),l);case 19:if(!0!==(c=e.sent).data.success){e.next=27;break}return e.next=23,ae().fire({title:"Success!",text:"Thank you for your feedback!",icon:"success",confirmButtonText:"OK"});case 23:return e.next=25,Ce();case 25:e.next=28;break;case 27:ae().fire({title:"Error!",text:(null===c||void 0===c||null===(d=c.data)||void 0===d?void 0:d.message)||"Error checking Topic.",icon:"error",confirmButtonText:"OK"});case 28:e.next=34;break;case 30:e.prev=30,e.t0=e.catch(15),ue(e.t0.message),ae().fire({title:"Error!",text:e.t0.message||"Error updating Topic.",icon:"error",confirmButtonText:"OK"});case 34:case"end":return e.stop()}}),e,null,[[15,30]])})));return function(t){return e.apply(this,arguments)}}(),Ee=function(){v(G.EditorState.createEmpty()),we.resetForm(),T(!1),k(!0)},Be=function(e,t){var r=e.topic_id||e.course;if(!r)return null;var n=he===e.topic_id,s=null===ge||void 0===ge?void 0:ge.find((function(e){return e.topic===r})),i=s?s.ratings:null;return(0,H.jsxs)(_.Z,{sx:{cursor:"pointer",display:"flex",flexDirection:"column",transition:"all 0.3s ease",border:"1px solid",borderColor:"divider",borderRadius:2,"&:hover":{transform:"translateY(-4px)",boxShadow:"0 12px 24px rgba(0,0,0,0.15)",borderColor:"secondary.light"},ml:2},children:[(0,H.jsx)(O.Z,{title:(0,H.jsxs)(d.Z,{sx:{display:"flex",alignItems:"center",gap:1},children:[(0,H.jsx)(h.Z,{variant:"h5",fontSize:14,children:"Title ".concat(t+1,": ").concat(e.title)}),"student"===je&&(0,H.jsx)(Y.Z,{size:"small",checked:!0===e.is_completed,onChange:function(t){t.stopPropagation(),!0!==e.is_completed&&_e(e.topic_id)},onClick:function(e){return e.stopPropagation()}})]}),onClick:function(){return function(e){me(he===e?null:e)}(e.topic_id)},sx:{cursor:"pointer"},action:"admin"===je||"super_admin"===je?(0,H.jsxs)(H.Fragment,{children:[c&&(0,H.jsx)(I.Z,{title:"Edit",children:(0,H.jsx)(p.Z,{"aria-label":"edit",onClick:function(t){t.stopPropagation(),function(e){try{var t,r;if(e.description){var n=e.description.replace(/<figure[^>]*>/g,"<div>").replace(/<\/figure>/g,"</div>").replace(/<img[^>]*>/g,""),s=ee()(n);s?(r=G.ContentState.createFromBlockArray(s.contentBlocks),t=G.EditorState.createWithContent(r)):t=G.EditorState.createEmpty()}else t=G.EditorState.createEmpty();v(t),we.setValues({id:e.topic_id,title:e.title||"",description:e.description||""}),T(!0),k(!0)}catch(ce){console.error("Error setting editor content:",ce),v(G.EditorState.createEmpty()),we.setValues({id:e.topic_id,title:e.title||"",description:""}),T(!0),k(!0)}}(e)},children:(0,H.jsx)(Q.Z,{size:20})})}),m&&(0,H.jsx)(I.Z,{title:"Delete",children:(0,H.jsx)(p.Z,{color:"error","aria-label":"delete",onClick:function(t){t.stopPropagation(),Se(e.topic_id)},children:(0,H.jsx)(K.Z,{size:20})})})]}):"student"===je&&(0,H.jsx)(H.Fragment,{children:(0,H.jsx)(d.Z,{sx:{mt:1.5},children:(0,H.jsx)(L.Z,{name:"read-only",value:i||0,readOnly:!0})})})}),(0,H.jsx)(V.Z,{in:n,timeout:"auto",unmountOnExit:!0,children:(0,H.jsx)(E.Z,{children:(0,H.jsx)(d.Z,{sx:{"& h1, & h2, & h3":{margin:"1em 0"},"& p":{margin:"0 0 1em 0"},"& ul, & ol":{margin:"0 0 1em 1em",paddingLeft:"2em"}},dangerouslySetInnerHTML:{__html:e.description}})})})]},e.topic_id)};return M?(0,H.jsx)(u.ZP,{container:!0,justifyContent:"center",alignItems:"center",sx:{minHeight:"50vh"},children:(0,H.jsx)(u.ZP,{item:!0,children:(0,H.jsx)(h.Z,{children:"Loading topics..."})})}):ce?(0,H.jsx)(u.ZP,{container:!0,justifyContent:"center",alignItems:"center",children:(0,H.jsx)(u.ZP,{item:!0,children:(0,H.jsxs)(h.Z,{color:"error",children:["Error: ",ce]})})}):(0,H.jsxs)(u.ZP,{container:!0,sx:{minHeight:"50vh"},children:[(0,H.jsx)(u.ZP,{item:!0,xs:12,padding:3,children:z.length>0?(0,H.jsxs)(u.ZP,{container:!0,spacing:3,children:[("admin"===je||"super_admin"===je)&&a&&(0,H.jsx)(u.ZP,{item:!0,xs:12,sx:{display:"flex",justifyContent:"flex-end"},children:(0,H.jsx)(S.Z,{variant:"contained",onClick:Ee,startIcon:(0,H.jsx)($.Z,{size:20}),sx:{mt:2},children:"Add New Topic"})}),z.map((function(e,t){return(0,H.jsx)(u.ZP,{item:!0,xs:6,children:Be(e,t)},e.topic_id)}))]}):(0,H.jsxs)(d.Z,{sx:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",minHeight:"300px",border:"1px dashed #ddd",borderRadius:2,p:4,textAlign:"center"},children:[(0,H.jsx)(h.Z,{variant:"body1",color:"textSecondary",sx:{mb:2},children:"No topics available"}),"admin"===je&&(0,H.jsx)(S.Z,{variant:"contained",onClick:Ee,startIcon:(0,H.jsx)(W.Z,{size:20}),children:"Add First Topic"})]})}),(0,H.jsx)(q.Z,{open:y,onClose:function(){return k(!1)},children:(0,H.jsxs)(d.Z,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"80%",maxWidth:"800px",bgcolor:"background.paper",boxShadow:24,p:4,borderRadius:2,maxHeight:"90vh",display:"flex",flexDirection:"column"},component:"form",onSubmit:we.handleSubmit,children:[(0,H.jsx)(h.Z,{variant:"h5",gutterBottom:!0,children:B?"Edit Topic":"Add New Topic"}),(0,H.jsx)(U.Z,{children:"Title"}),(0,H.jsx)(te.Z,{name:"title",value:we.values.title,onChange:we.handleChange,onBlur:we.handleBlur,error:we.touched.title&&Boolean(we.errors.title),helperText:we.touched.title&&we.errors.title,fullWidth:!0,sx:{mb:3,mt:1},placeholder:"Enter topic title"}),(0,H.jsxs)(d.Z,{sx:{flexGrow:1,mb:3,minHeight:"300px",overflow:"auto"},children:[(0,H.jsx)(ne,{editorState:g,onEditorStateChange:function(e){v(e);var t=e.getCurrentContent(),r=(0,J.E)(t);we.setFieldValue("description",r),we.setFieldTouched("description",!0)},toolbar:{options:["inline","blockType","list","textAlign","link","emoji","image","history"],inline:{options:["bold","italic","underline","strikethrough"]},blockType:{options:["Normal","H1","H2","H3","Blockquote"]}},editorStyle:{padding:"10px",border:"1px solid #eee",borderRadius:"4px",borderColor:we.touched.description&&we.errors.description?"error.main":"#eee"}}),we.touched.description&&we.errors.description&&(0,H.jsx)(h.Z,{variant:"caption",color:"error",sx:{mt:1,display:"block"},children:we.errors.description})]}),(0,H.jsxs)(x.Z,{direction:"row",spacing:2,justifyContent:"flex-end",children:[(0,H.jsx)(S.Z,{onClick:function(){k(!1),we.resetForm()},sx:{minWidth:"100px"},children:"Cancel"}),(0,H.jsx)(S.Z,{type:"submit",variant:"contained",disabled:we.isSubmitting||!we.isValid,sx:{minWidth:"100px"},children:we.isSubmitting?"Saving...":B?"Update":"Save"})]})]})})]})},xe=r(4942),pe=r(35527),he=r(90493),me=r(15021),fe=r(49900),be=r(81918),ge=r(94721),ve=r(20653),Ze=r(93044),je=r(5574),ye=r(65661),ke=r(39157),we=r(97123),Ce=r(23311),Se=r(99261),_e=r(10163),Ee=r(85680),Be=r(66770),Ie=r.n(Be),Te=(r(86009),r(78045)),Pe=function(e){var t,r,a,c,x,m=e.courseId,f=(0,N.g)().checkPermission,b=f("Exercise","create"),g=f("Exercise","update"),v=f("Exercise","delete"),Z=(0,l.useState)([]),k=(0,i.Z)(Z,2),w=k[0],C=k[1],_=(0,l.useState)(!1),E=(0,i.Z)(_,2),B=E[0],I=E[1],P=(0,l.useState)(!1),A=(0,i.Z)(P,2),z=A[0],W=A[1],q=(0,l.useState)(""),R=(0,i.Z)(q,2),D=R[0],M=R[1],O=(0,l.useState)(null),Y=(0,i.Z)(O,2),L=Y[0],V=Y[1],G=(0,l.useState)(null),J=(0,i.Z)(G,2),X=J[0],ee=J[1],re=(0,l.useState)(!0),ne=(0,i.Z)(re,2),oe=ne[0],de=ne[1],ue=(0,l.useState)(!1),Be=(0,i.Z)(ue,2),Pe=Be[0],Ae=Be[1],ze=(0,l.useState)({}),We=(0,i.Z)(ze,2),Fe=We[0],qe=We[1],Re=(0,l.useState)({comment:"",general:""}),De=(0,i.Z)(Re,2),Ne=De[0],He=De[1],Me=(0,l.useRef)(null),Oe=JSON.parse(localStorage.getItem("auth")),Ye=null===Oe||void 0===Oe?void 0:Oe.loginType,Le=(null===Oe||void 0===Oe||null===(t=Oe.user)||void 0===t?void 0:t.employee_id)||(null===Oe||void 0===Oe||null===(r=Oe.user)||void 0===r?void 0:r.user_id),Ve=null===Oe||void 0===Oe||null===(a=Oe.user)||void 0===a?void 0:a.registration_id,Ue=ce.Ry({title:ce.Z_().required("Title is required").test("is-not-empty","Title is required",(function(e){return e&&e.replace(/<(.|\n)*?>/g,"").trim().length>0})),description:ce.Z_().required("Description is required").test("is-not-empty","Description is required",(function(e){return e&&e.replace(/<(.|\n)*?>/g,"").trim().length>0}))}),Qe=(0,le.TA)({initialValues:{title:"",description:"",status:"pending",duedate:null,priority:"medium"},validationSchema:Ue,onSubmit:function(){var e=(0,s.Z)((0,n.Z)().mark((function e(t,r){var s,i,o,a,l,c;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=r.setSubmitting,i=r.resetForm,e.prev=1,a=(null===(o=Me.current)||void 0===o?void 0:o.getEditor().root.innerHTML)||"",t.title&&a){e.next=6;break}return ae().fire("Error","Title and description are required","error"),e.abrupt("return");case 6:if(l={title:t.title,description:a,course:m,assigned_by:Le},!z){e.next=13;break}return e.next=10,se.Z.patch("".concat(ie.t6,"api/assignments/").concat(t.id),l);case 10:c=e.sent,e.next=16;break;case 13:return e.next=15,se.Z.post("".concat(ie.t6,"api/assignments"),l);case 15:c=e.sent;case 16:if(!1!==c.data.success){e.next=20;break}return e.next=19,ae().fire("Error",c.data.message,"error");case 19:return e.abrupt("return");case 20:return e.next=22,Ke();case 22:I(!1),i(),ae().fire("Success","Exercise ".concat(z?"updated":"created"," successfully!"),"success"),e.next=31;break;case 27:e.prev=27,e.t0=e.catch(1),console.error("Error saving exercise:",e.t0),ae().fire("Error","Failed to save exercise","error");case 31:return e.prev=31,s(!1),e.finish(31);case 34:case"end":return e.stop()}}),e,null,[[1,27,31,34]])})));return function(t,r){return e.apply(this,arguments)}}()}),Ke=(0,l.useCallback)((0,s.Z)((0,n.Z)().mark((function e(){var t,r;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,de(!0),e.next=4,se.Z.get("".concat(ie.t6,"api/courses/").concat(m,"/assignments"));case 4:t=e.sent,r=Array.isArray(t.data.data)?t.data.data:[],C(r),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.error("Error fetching exercises:",e.t0);case 12:return e.prev=12,de(!1),e.finish(12);case 15:case"end":return e.stop()}}),e,null,[[0,9,12,15]])}))),[m]);(0,l.useEffect)((function(){Ke()}),[Ke]);var $e=Array.isArray(w)?w.find((function(e){return e.id===X})):null,Ge=(0,l.useCallback)(function(){var e=(0,s.Z)((0,n.Z)().mark((function e(t){var r;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,ae().fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!"});case 3:if(!e.sent.isConfirmed){e.next=16;break}return e.next=7,se.Z.patch("".concat(ie.t6,"api/assignments/").concat(t,"/archive"));case 7:if(!0!==(r=e.sent).data.success){e.next=14;break}return e.next=11,Ke();case 11:ae().fire("Success!","Exercise deleted successfully!","success"),e.next=15;break;case 14:ae().fire("Error!",r.data.message,"error");case 15:X===t&&ee(w.length>1?w[0].id:null);case 16:e.next=22;break;case 18:e.prev=18,e.t0=e.catch(0),console.error("Error deleting exercise:",e.t0),ae().fire("Error!","Failed to delete exercise","error");case 22:case"end":return e.stop()}}),e,null,[[0,18]])})));return function(t){return e.apply(this,arguments)}}(),[w,X,Ke]),Je=(0,l.useCallback)((0,s.Z)((0,n.Z)().mark((function e(){var t;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(He({comment:"",general:""}),!Pe&&X&&null!==D&&void 0!==D&&D.trim()){e.next=9;break}if(X){e.next=5;break}return He({general:"Please select an exercise first"}),e.abrupt("return");case 5:if(null!==D&&void 0!==D&&D.trim()){e.next=8;break}return He({comment:"Comment is required"}),e.abrupt("return");case 8:return e.abrupt("return");case 9:return Ae(!0),e.prev=10,(t=new FormData).append("assignment",X),t.append("registration_id",Ve),t.append("text",D.trim()),L&&t.append("file",L),e.next=18,se.Z.post("".concat(ie.t6,"api/submissions"),t,{headers:{"Content-Type":"multipart/form-data",Authorization:"Bearer ".concat(localStorage.getItem("serviceToken"))}});case 18:return e.next=20,Ke();case 20:M(""),V(null),e.next=27;break;case 24:e.prev=24,e.t0=e.catch(10),console.error("Error adding submission:",e.t0);case 27:return e.prev=27,Ae(!1),e.finish(27);case 30:case"end":return e.stop()}}),e,null,[[10,24,27,30]])}))),[X,Ve,D,L,Pe,Ke]),Xe=(0,l.useCallback)(function(){var e=(0,s.Z)((0,n.Z)().mark((function e(t,r){var s;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(X&&r){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,s={text:r,employee_id:Le},e.next=6,se.Z.post("".concat(ie.t6,"api/replies/").concat(t),s);case 6:return e.next=8,Ke();case 8:qe((function(e){return(0,o.Z)((0,o.Z)({},e),{},(0,xe.Z)({},t,""))})),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(2),console.error("Error adding reply:",e.t0);case 14:case"end":return e.stop()}}),e,null,[[2,11]])})));return function(t,r){return e.apply(this,arguments)}}(),[X,Le,Ke]);if(oe)return(0,H.jsxs)(d.Z,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh",flexDirection:"column",zIndex:1,gap:2},children:[(0,H.jsx)(T.Z,{size:60,thickness:4}),(0,H.jsx)(h.Z,{variant:"h6",children:"Loading exercises..."})]});var et=(null===$e||void 0===$e||null===(c=$e.submissions)||void 0===c?void 0:c.sort((function(e,t){var r=new Date(e.date);return new Date(t.date)-r})))||[];return(0,H.jsx)(j._,{dateAdapter:y.H,children:(0,H.jsxs)(u.ZP,{container:!0,spacing:3,sx:{p:3},children:[(0,H.jsx)(u.ZP,{item:!0,xs:12,md:4,children:(0,H.jsxs)(pe.Z,{elevation:2,sx:{p:2,height:"100%"},children:[(0,H.jsxs)(d.Z,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[(0,H.jsx)(h.Z,{variant:"h6",children:"Exercises"}),("admin"===Ye||"super_admin"===Ye)&&b&&(0,H.jsx)(S.Z,{variant:"contained",onClick:function(){I(!0),W(!1),Qe.resetForm(),Qe.setValues({title:"",description:"",status:"pending",duedate:null,priority:"medium"})},startIcon:(0,H.jsx)($.Z,{}),size:"small",children:"New"})]}),(0,H.jsx)(he.Z,{dense:!0,sx:{maxHeight:"500px",overflowY:"hidden","&:hover":{overflowY:"auto"},"&::-webkit-scrollbar":{width:"5px"},"&::-webkit-scrollbar-track":{background:"transparent"},"&:hover::-webkit-scrollbar-track":{background:"#f1f1f1"},"&::-webkit-scrollbar-thumb":{background:"transparent",borderRadius:"4px"},"&:hover::-webkit-scrollbar-thumb":{background:"#888"},"&::-webkit-scrollbar-thumb:hover":{background:"#555"},pr:1,transition:"overflow 0.2s ease"},children:w.map((function(e){var t;return(0,H.jsxs)(pe.Z,{elevation:e.id===X?3:1,sx:{mb:2,cursor:"pointer",backgroundColor:e.id===X?"#e3f2fd":"inherit","&:hover":{backgroundColor:"#f5f5f5"},borderRadius:2,transition:"all 0.2s ease",position:"relative",minHeight:120},onClick:function(){return ee(e.id)},children:[("admin"===Ye||"super_admin"===Ye)&&g&&(0,H.jsx)(p.Z,{onClick:function(t){t.stopPropagation(),function(e){I(!0),W(!0),Qe.setValues({id:e.id,title:e.title,description:e.description,status:e.status,duedate:e.duedate?new Date(e.duedate):null,priority:e.priority})}(e)},size:"small",sx:{position:"absolute",top:8,right:8,"&:hover":{color:"primary.main"},zIndex:1},children:(0,H.jsx)(Q.Z,{fontSize:"small"})}),("admin"===Ye||"super_admin"===Ye)&&v&&(0,H.jsx)(p.Z,{onClick:function(t){t.stopPropagation(),Ge(e.id)},size:"small",sx:{position:"absolute",bottom:8,right:8,"&:hover":{color:"error.main"},zIndex:1},children:(0,H.jsx)(K.Z,{fontSize:"small",color:"red"})}),(0,H.jsx)(me.ZP,{sx:{py:1.5,pr:6},children:(0,H.jsx)(fe.Z,{primary:(0,H.jsx)(d.Z,{sx:{display:"flex",alignItems:"center",mb:.5},children:(0,H.jsx)(h.Z,{variant:"subtitle1",fontWeight:"medium",children:e.title})}),secondary:(0,H.jsxs)(H.Fragment,{children:[e.description&&(0,H.jsx)(h.Z,{variant:"body2",color:"text.secondary",sx:{mb:1.5,display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden"},children:(0,H.jsx)("div",{dangerouslySetInnerHTML:{__html:e.description}})}),(0,H.jsx)(d.Z,{sx:{display:"flex",alignItems:"center",mt:1.5},children:(0,H.jsxs)(h.Z,{variant:"caption",color:"text.secondary",sx:{mr:1.5},children:[(0,H.jsx)(d.Z,{component:"span",sx:{fontWeight:500},children:(0,H.jsx)(be.Z,{label:"".concat(null===(t=e.submissions)||void 0===t?void 0:t.length," submission"),size:"small",color:"success",variant:"contained",sx:{height:20,fontSize:"0.7rem"}})})," "]})})]})})})]},e.id)}))})]})}),(0,H.jsx)(u.ZP,{item:!0,xs:12,md:8,children:$e?(0,H.jsxs)(pe.Z,{elevation:2,sx:{p:3,height:"100%"},children:[(0,H.jsx)(d.Z,{sx:{display:"flex",gap:3,maxWidth:"1200px",margin:"0 auto",alignItems:"flex-start"},children:(0,H.jsxs)(d.Z,{sx:{flex:1,minWidth:0,maxWidth:"100%"},children:[(0,H.jsx)(h.Z,{variant:"h5",gutterBottom:!0,children:$e.title}),(0,H.jsx)(d.Z,{dangerouslySetInnerHTML:{__html:$e.description},sx:{"& p":{marginBottom:"1em"},"& h1, & h2, & h3":{marginTop:"1em",marginBottom:"0.5em"},maxHeight:"400px",overflowY:"auto",pr:2}})]})}),(0,H.jsx)(ge.Z,{sx:{my:3}}),(0,H.jsx)(h.Z,{variant:"h6",gutterBottom:!0,children:"Submissions"}),(null===(x=$e.submissions)||void 0===x?void 0:x.length)>0?(0,H.jsx)(he.Z,{dense:!0,sx:{maxHeight:"400px",overflowY:"hidden","&:hover":{overflowY:"auto"},"&::-webkit-scrollbar":{width:"5px"},"&::-webkit-scrollbar-track":{background:"transparent"},"&:hover::-webkit-scrollbar-track":{background:"#f1f1f1"},"&::-webkit-scrollbar-thumb":{background:"transparent",borderRadius:"4px"},"&:hover::-webkit-scrollbar-thumb":{background:"#888"},"&::-webkit-scrollbar-thumb:hover":{background:"#555"},pr:1,transition:"overflow 0.2s ease"},children:et.map((function(e){var t,r,n;return(0,H.jsxs)(d.Z,{sx:{mb:3},children:[(0,H.jsxs)(me.ZP,{alignItems:"flex-start",children:[(0,H.jsx)(ve.Z,{children:(0,H.jsx)(Ze.Z,{children:e.student?e.student.profile_pic?(0,H.jsx)("img",{src:"".concat(e.student.profile_pic),alt:"Profile",className:"profile-pic"}):(0,H.jsx)("span",{style:{fontSize:"1rem"},children:(null===(t=e.student.first_name)||void 0===t?void 0:t.charAt(0))||"?"}):(0,H.jsx)("span",{children:"?"})})}),(0,H.jsx)(fe.Z,{primary:(0,Ee.Z)((null===(r=e.student)||void 0===r?void 0:r.first_name)||"Unknown"),secondary:(0,H.jsxs)(H.Fragment,{children:[(0,H.jsx)(h.Z,{variant:"body2",color:"text.primary",children:e.text}),e.file_url&&(0,H.jsx)(d.Z,{sx:{mt:1},children:(0,H.jsx)(be.Z,{icon:(0,H.jsx)(Ce.Z,{fontSize:"small"}),label:e.file_url.split("/").pop(),variant:"outlined",sx:{mr:1,cursor:"pointer"},onClick:function(){window.open(e.file_url,"_blank");var t=e.file_url.split("/").pop(),r=document.createElement("a");r.href=e.file_url,r.download=t,document.body.appendChild(r),r.click(),document.body.removeChild(r)}})}),(0,H.jsx)(h.Z,{variant:"caption",display:"block",sx:{mt:1},children:(0,Te.o)(e.date)})]})})]}),(null===(n=e.replies)||void 0===n?void 0:n.length)>0&&(0,H.jsx)(he.Z,{sx:{pl:6},children:e.replies.map((function(e){var t,r;return(0,H.jsxs)(me.ZP,{alignItems:"flex-start",children:[(0,H.jsx)(ve.Z,{children:(0,H.jsx)(Ze.Z,{children:e.trainer?e.trainer.profile_pic?(0,H.jsx)("img",{src:"".concat(e.trainer.profile_pic),alt:"Profile",className:"profile-pic"}):(0,H.jsx)("span",{style:{fontSize:"1rem"},children:(null===(t=e.trainer.full_name)||void 0===t?void 0:t.charAt(0))||"?"}):(0,H.jsx)("span",{children:"?"})})}),(0,H.jsx)(fe.Z,{primary:(null===(r=e.trainer)||void 0===r?void 0:r.full_name)||"Unknown",secondary:(0,H.jsxs)(H.Fragment,{children:[(0,H.jsx)(h.Z,{variant:"body2",color:"text.primary",children:e.text}),(0,H.jsx)(h.Z,{variant:"caption",display:"block",sx:{mt:1},children:(0,Te.o)(e.date)})]})})]},e.id)}))}),"tutor"===Ye&&(0,H.jsxs)(d.Z,{sx:{pl:6,mt:2},children:[(0,H.jsx)(te.Z,{fullWidth:!0,multiline:!0,rows:2,variant:"outlined",placeholder:"Write your feedback...",value:Fe[e.id]||"",onChange:function(t){return r=e.id,n=t.target.value,void qe((function(e){return(0,o.Z)((0,o.Z)({},e),{},(0,xe.Z)({},r,n))}));var r,n},sx:{mb:1}}),(0,H.jsx)(S.Z,{variant:"contained",size:"small",startIcon:(0,H.jsx)(Se.Z,{}),onClick:function(){return Xe(e.id,Fe[e.id]||"")},disabled:!Fe[e.id],children:"Send Feedback"})]})]},e.id)}))}):(0,H.jsx)(h.Z,{variant:"body2",color:"text.secondary",children:"No submissions yet."}),"student"===Ye&&(0,H.jsxs)(d.Z,{sx:{mt:4},children:[(0,H.jsx)(te.Z,{fullWidth:!0,multiline:!0,rows:3,variant:"outlined",placeholder:"Write your submission comments...",value:D,error:Boolean(Ne.comment),helperText:Ne.comment,onChange:function(e){return t=e,He({comment:"",general:""}),void M(t.target.value);var t},sx:{mb:2}}),(0,H.jsxs)(d.Z,{sx:{display:"flex",alignItems:"center",mb:2},children:[(0,H.jsx)("input",{id:"file-upload",type:"file",onChange:function(e){V(e.target.files[0])},style:{display:"none"}}),(0,H.jsx)("label",{htmlFor:"file-upload",children:(0,H.jsx)(S.Z,{variant:"outlined",component:"span",startIcon:(0,H.jsx)(Ce.Z,{}),size:"small",children:"Attach File"})}),L&&(0,H.jsxs)(h.Z,{variant:"body2",sx:{ml:2},children:[L.name,(0,H.jsx)(p.Z,{onClick:function(){return V(null)},size:"small",sx:{ml:1},children:(0,H.jsx)(F.Z,{fontSize:"small"})})]})]}),(0,H.jsx)(S.Z,{variant:"contained",startIcon:(0,H.jsx)(Se.Z,{}),onClick:Je,disabled:Pe||!(null!==D&&void 0!==D&&D.trim())&&!L,children:"Submit"})]})]}):(0,H.jsx)(pe.Z,{elevation:2,sx:{p:3,height:"100%",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,H.jsx)(h.Z,{variant:"body1",color:"text.secondary",children:0===w.length?"No exercises available":"Select an exercise to view details"})})}),(0,H.jsx)(je.Z,{open:B,onClose:function(){return I(!1)},maxWidth:"md",fullWidth:!0,children:(0,H.jsxs)("form",{onSubmit:Qe.handleSubmit,children:[(0,H.jsxs)(ye.Z,{children:[z?"Edit Exercise":"Create New Exercise",(0,H.jsx)(p.Z,{onClick:function(){return I(!1)},sx:{position:"absolute",right:8,top:8},children:(0,H.jsx)(_e.Z,{})})]}),(0,H.jsxs)(ke.Z,{dividers:!0,children:[(0,H.jsx)(U.Z,{children:"Title *"}),(0,H.jsx)(te.Z,{fullWidth:!0,placeholder:"Title",name:"title",value:Qe.values.title,onChange:Qe.handleChange,onBlur:Qe.handleBlur,error:Qe.touched.title&&Boolean(Qe.errors.title),helperText:Qe.touched.title&&Qe.errors.title,sx:{mb:3}}),(0,H.jsx)(U.Z,{children:"Description *"}),(0,H.jsxs)(d.Z,{sx:{height:300,mb:2},children:[(0,H.jsx)(Ie(),{ref:Me,theme:"snow",value:Qe.values.description,onChange:function(e){Qe.setFieldValue("description",e)},modules:{toolbar:[[{header:[1,2,3,4,5,6,!1]}],[{font:[]}],[{size:["small",!1,"large","huge"]}],["bold","italic","underline","strike","blockquote"],[{color:[]},{background:[]}],[{script:"sub"},{script:"super"}],[{align:[]}],[{list:"ordered"},{list:"bullet"},{indent:"-1"},{indent:"+1"}],["link","image","video"],["code-block"],["clean"]],clipboard:{matchVisual:!1}},formats:["header","font","size","bold","italic","underline","strike","blockquote","color","background","script","align","list","bullet","indent","link","image","video","code-block"],style:{height:"250px"}}),Qe.touched.description&&Qe.errors.description&&(0,H.jsx)(h.Z,{variant:"caption",color:"error",sx:{mt:1,display:"block"},children:Qe.errors.description})]})]}),(0,H.jsxs)(we.Z,{children:[(0,H.jsx)(S.Z,{onClick:function(){return I(!1)},children:"Cancel"}),(0,H.jsx)(S.Z,{type:"submit",variant:"contained",disabled:Qe.isSubmitting||!Qe.isValid,children:Qe.isSubmitting?(0,H.jsx)(T.Z,{size:24}):z?"Update":"Create"})]})]})})]})})},Ae=r(57482),ze=r(89673),We=r(55818),Fe=r(3721),qe=r(57064),Re=r(94070),De=r(70242),Ne=r(74512),He=r(55261),Me=r(88970),Oe=r(85523),Ye=r(61419),Le=r(62075),Ve=r(54371),Ue=r(85667),Qe=r(3265),Ke=r(37355),$e=r(40318),Ge=r(96739),Je=r(8160),Xe=r(46935),et=r(41946),tt=r(53928),rt=r(98820),nt=r(87067),st=r(16908),it=function(e){var t,r=e.courseId,a=(0,l.useState)([]),c=(0,i.Z)(a,2),x=c[0],p=c[1],b=(0,l.useState)([]),g=(0,i.Z)(b,2),v=g[0],Z=g[1],j=(0,l.useState)(null),y=(0,i.Z)(j,2),k=y[0],C=y[1],I=(0,l.useState)(null),P=(0,i.Z)(I,2),A=P[0],z=P[1],W=(0,l.useState)(0),F=(0,i.Z)(W,2),q=F[0],R=F[1],D=(0,l.useState)({}),N=(0,i.Z)(D,2),M=N[0],O=N[1],Y=(0,l.useState)(!1),L=(0,i.Z)(Y,2),V=L[0],U=L[1],Q=(0,l.useState)(null),K=(0,i.Z)(Q,2),$=K[0],G=K[1],J=(0,l.useState)(!1),X=(0,i.Z)(J,2),ee=X[0],re=X[1],ne=(0,l.useState)(null),oe=(0,i.Z)(ne,2),le=oe[0],ce=oe[1],de=(0,l.useState)("testList"),ue=(0,i.Z)(de,2),ve=ue[0],Ze=ue[1],je=(0,l.useState)(0),ye=(0,i.Z)(je,2),ke=ye[0],we=ye[1];console.log("resultData is",v);var Ce=JSON.parse(localStorage.getItem("auth")),_e=null===Ce||void 0===Ce||null===(t=Ce.user)||void 0===t?void 0:t.student_id,Ee=(0,l.useCallback)((0,s.Z)((0,n.Z)().mark((function e(){var t;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,re(!0),e.next=4,se.Z.get("".concat(ie.t6,"api/test/course/").concat(r));case 4:t=e.sent,p(t.data.tests||[]),G(null),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(0),console.error("Error fetching assessment data:",e.t0),G("Failed to load tests. Please try again later.");case 13:return e.prev=13,re(!1),e.finish(13);case 16:case"end":return e.stop()}}),e,null,[[0,9,13,16]])}))),[r]),Be=(0,l.useCallback)(function(){var e=(0,s.Z)((0,n.Z)().mark((function e(t){var r;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,re(!0),e.next=4,se.Z.get("".concat(ie.t6,"api/test/").concat(t,"/student/").concat(_e,"/result"));case 4:r=e.sent,Z(r.data.questions||[]),G(null),Ze("results"),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(0),console.error("Error fetching results:",e.t0),G("Failed to load results. Please try again later.");case 14:return e.prev=14,re(!1),e.finish(14);case 17:case"end":return e.stop()}}),e,null,[[0,10,14,17]])})));return function(t){return e.apply(this,arguments)}}(),[_e]),Ie=(0,l.useCallback)(function(){var e=(0,s.Z)((0,n.Z)().mark((function e(t){var r,s;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,re(!0),(r=t).questions&&0!==r.questions.length){e.next=7;break}return G("This test has no questions available."),z(null),e.abrupt("return");case 7:s={id:r.test_id,title:r.test_name,instructions:r.description,questions:r.questions.map((function(e){return{id:e.question_id,text:e.question,type:e.type,options:e.options||[],marks:e.marks}}))},z(s),ce(new Date),G(null),Ze("testTaking"),e.next=18;break;case 14:e.prev=14,e.t0=e.catch(0),console.error("Error fetching test details:",e.t0),G("Failed to load test details. Please try again.");case 18:return e.prev=18,re(!1),e.finish(18);case 21:case"end":return e.stop()}}),e,null,[[0,14,18,21]])})));return function(t){return e.apply(this,arguments)}}(),[]);(0,l.useEffect)((function(){Ee()}),[Ee]);var Te=function(e,t){O((function(r){return(0,o.Z)((0,o.Z)({},r),{},(0,xe.Z)({},e,t))}))},Pe=function(e){var t=M[e];return void 0!==t&&null!==t&&""!==t&&(("string"!==typeof t||0!==t.trim().length)&&(!Array.isArray(t)||0!==t.length))},it=(0,l.useCallback)((0,s.Z)((0,n.Z)().mark((function e(){var t,r;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,ae().fire({title:"Are you sure?",text:"You are about to submit the assessment.",icon:"warning",showCancelButton:!0,confirmButtonText:"Yes, submit",cancelButtonText:"Cancel"});case 3:if(e.sent.isConfirmed){e.next=6;break}return e.abrupt("return");case 6:return t=Math.floor((new Date-le)/1e3),r=A.questions.map((function(e){var r=M[e.id],n={student_id:_e,question_id:e.id,test_id:A.id,marks:e.marks,time_taken:t};return"written"===e.type&&null!==r&&(n.written_answer=r),"mcq"===e.type&&null!==r&&(n.selected_option=r),n})),e.next=10,se.Z.post("".concat(ie.t6,"api/answers"),r);case 10:e.sent.data.success?(U(!0),Ze("testList")):G("Failed to submit answers. Please try again."),e.next=18;break;case 14:e.prev=14,e.t0=e.catch(0),console.error("Error submitting assessment:",e.t0),G("An error occurred while submitting your answers. Please try again.");case 18:case"end":return e.stop()}}),e,null,[[0,14]])}))),[M,A,_e,le]),ot=function(){C(null),z(null),U(!1),R(0),O({}),G(null),Ze("testList"),Ee()},at=function(){if(!v||0===v.length)return null;var e=v.length,t=v.filter((function(e){return e.is_correct})).length,r=v.reduce((function(e,t){return e+(t.marks||0)}),0),n=v.reduce((function(e,t){return e+(t.is_correct&&t.marks||0)}),0);return{totalQuestions:e,correctAnswers:t,totalMarks:r,earnedMarks:n,percentage:(n/r*100).toFixed(1)}}();if("results"===ve&&v.length>0)return(0,H.jsxs)(d.Z,{sx:{p:3},children:[(0,H.jsx)(S.Z,{startIcon:(0,H.jsx)(w.Z,{}),onClick:function(){return Ze("testList")},sx:{mb:3},children:"Back to Tests"}),(0,H.jsxs)(d.Z,{sx:{textAlign:"center",mb:4},children:[(0,H.jsxs)(h.Z,{variant:"h3",gutterBottom:!0,children:[k.test_name," - Results"]}),(0,H.jsx)(h.Z,{variant:"subtitle1",color:"text.secondary",children:"Your performance summary"})]}),(0,H.jsxs)(u.ZP,{container:!0,spacing:3,sx:{mb:4},children:[(0,H.jsx)(u.ZP,{item:!0,xs:12,sm:6,md:3,children:(0,H.jsxs)(pe.Z,{sx:{p:3,textAlign:"center"},children:[(0,H.jsx)(Le.Z,{color:"primary",sx:{fontSize:40,mb:1}}),(0,H.jsxs)(h.Z,{variant:"h4",gutterBottom:!0,children:[at.earnedMarks,"/",at.totalMarks]}),(0,H.jsx)(h.Z,{variant:"body2",color:"text.secondary",children:"Total Score"})]})}),(0,H.jsx)(u.ZP,{item:!0,xs:12,sm:6,md:3,children:(0,H.jsxs)(pe.Z,{sx:{p:3,textAlign:"center"},children:[(0,H.jsx)(Ve.Z,{color:"primary",sx:{fontSize:40,mb:1}}),(0,H.jsxs)(h.Z,{variant:"h4",gutterBottom:!0,children:[at.percentage,"%"]}),(0,H.jsx)(h.Z,{variant:"body2",color:"text.secondary",children:"Percentage"})]})}),(0,H.jsx)(u.ZP,{item:!0,xs:12,sm:6,md:3,children:(0,H.jsxs)(pe.Z,{sx:{p:3,textAlign:"center"},children:[(0,H.jsx)(Ue.Z,{color:"primary",sx:{fontSize:40,mb:1}}),(0,H.jsxs)(h.Z,{variant:"h4",gutterBottom:!0,children:[at.correctAnswers,"/",at.totalQuestions]}),(0,H.jsx)(h.Z,{variant:"body2",color:"text.secondary",children:"Correct Answers"})]})}),(0,H.jsx)(u.ZP,{item:!0,xs:12,sm:6,md:3,children:(0,H.jsxs)(pe.Z,{sx:{p:3,textAlign:"center"},children:[(0,H.jsx)(Qe.Z,{color:"primary",sx:{fontSize:40,mb:1}}),(0,H.jsx)(h.Z,{variant:"h4",gutterBottom:!0,children:at.totalQuestions}),(0,H.jsx)(h.Z,{variant:"body2",color:"text.secondary",children:"Total Questions"})]})})]}),(0,H.jsxs)(pe.Z,{sx:{p:3,mb:4},children:[(0,H.jsx)(h.Z,{variant:"h6",gutterBottom:!0,children:"Performance Breakdown"}),(0,H.jsxs)(d.Z,{sx:{mb:2},children:[(0,H.jsxs)(d.Z,{sx:{display:"flex",justifyContent:"space-between",mb:1},children:[(0,H.jsx)(h.Z,{variant:"body2",children:"Overall Score"}),(0,H.jsxs)(h.Z,{variant:"body2",children:[at.percentage,"%"]})]}),(0,H.jsx)(Ae.Z,{variant:"determinate",value:Number(at.percentage),sx:{height:10,borderRadius:5},color:at.percentage>=80?"success":at.percentage>=60?"primary":"error"})]})]}),(0,H.jsx)(pe.Z,{sx:{width:"100%",mb:2},children:(0,H.jsx)(m.Z,{value:ke,onChange:function(e,t){we(t)},centered:!0,children:(0,H.jsx)(f.Z,{label:"Question Review"})})}),0===ke&&(0,H.jsxs)(d.Z,{children:[(0,H.jsx)(h.Z,{variant:"h5",gutterBottom:!0,sx:{mb:3},children:"Question-by-Question Review"}),(0,H.jsx)(u.ZP,{container:!0,spacing:2,children:v.map((function(e,t){return(0,H.jsx)(u.ZP,{item:!0,xs:12,sm:6,md:4,children:(0,H.jsxs)(ze.Z,{sx:{mb:2},children:[(0,H.jsx)(We.Z,{expandIcon:(0,H.jsx)(Ke.Z,{}),children:(0,H.jsxs)(d.Z,{sx:{display:"flex",alignItems:"center",width:"100%"},children:[(0,H.jsxs)(h.Z,{sx:{width:"33%",flexShrink:0},children:["Question ",t+1]}),(0,H.jsx)(be.Z,{icon:e.is_correct?(0,H.jsx)($e.Z,{}):(0,H.jsx)(Ge.Z,{}),label:e.is_correct?"Correct":"Incorrect",color:e.is_correct?"success":"error",size:"small",sx:{mr:2}}),(0,H.jsxs)(h.Z,{sx:{color:"text.secondary"},children:[e.marks," mark",e.marks>1?"s":""]})]})}),(0,H.jsxs)(Fe.Z,{children:[(0,H.jsx)(h.Z,{variant:"h6",gutterBottom:!0,children:e.question}),"mcq"===e.type?(0,H.jsxs)(d.Z,{children:[(0,H.jsx)(h.Z,{variant:"body2",gutterBottom:!0,sx:{mt:2,fontWeight:"bold"},children:"Options:"}),(0,H.jsx)(he.Z,{children:e.options.map((function(t,r){return(0,H.jsxs)(me.ZP,{children:[(0,H.jsx)(qe.Z,{children:t===e.student_answer?e.is_correct?(0,H.jsx)($e.Z,{color:"success"}):(0,H.jsx)(Ge.Z,{color:"error"}):t===e.correct_answer?(0,H.jsx)($e.Z,{color:"success"}):null}),(0,H.jsx)(fe.Z,{primary:t,sx:{backgroundColor:t===e.correct_answer?"success.light":t!==e.student_answer||e.is_correct?"transparent":"error.light",p:1,borderRadius:1}})]},r)}))}),!1===e.is_correct&&e.correct_answer&&(0,H.jsxs)(H.Fragment,{children:[(0,H.jsx)(h.Z,{variant:"body2",gutterBottom:!0,sx:{mt:2,fontWeight:"bold"},children:"Correct answer:"}),(0,H.jsx)(pe.Z,{variant:"outlined",sx:{p:2,backgroundColor:"success.light"},children:(0,H.jsx)(h.Z,{children:e.correct_answer})})]})]}):(0,H.jsxs)(d.Z,{children:[(0,H.jsx)(h.Z,{variant:"body2",gutterBottom:!0,sx:{mt:2,fontWeight:"bold"},children:"Your answer:"}),(0,H.jsx)(pe.Z,{variant:"outlined",sx:{p:2,backgroundColor:"grey.50"},children:(0,H.jsx)(h.Z,{children:e.student_answer||"No answer provided"})}),!1===e.is_correct&&e.correct_answer&&(0,H.jsxs)(H.Fragment,{children:[(0,H.jsx)(h.Z,{variant:"body2",gutterBottom:!0,sx:{mt:2,fontWeight:"bold"},children:"Correct answer:"}),(0,H.jsx)(pe.Z,{variant:"outlined",sx:{p:2,backgroundColor:"success.light"},children:(0,H.jsx)(h.Z,{children:e.correct_answer})})]})]}),(0,H.jsx)(d.Z,{sx:{mt:2,display:"flex",justifyContent:"flex-end"},children:(0,H.jsx)(be.Z,{label:"Score: ".concat(e.is_correct?e.marks:0,"/").concat(e.marks),color:e.is_correct?"success":"error",variant:"outlined"})})]})]},e.question_id)},e.question_id)}))})]})]});if(V)return(0,H.jsxs)(d.Z,{sx:{p:4,maxWidth:900,margin:"0 auto",textAlign:"center",minHeight:"60vh",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"},children:[(0,H.jsx)(d.Z,{sx:{position:"relative",mb:3,animation:"pulse 1.5s ease-in-out infinite","@keyframes pulse":{"0%":{transform:"scale(1)"},"50%":{transform:"scale(1.05)"},"100%":{transform:"scale(1)"}}},children:(0,H.jsx)(Je.Z,{sx:{fontSize:100,color:"success.main",filter:"drop-shadow(0px 4px 8px rgba(0,0,0,0.1))"}})}),(0,H.jsx)(h.Z,{variant:"h3",gutterBottom:!0,sx:{fontWeight:700,mb:2,background:"linear-gradient(45deg, #2e7d32 30%, #66bb6a 90%)",backgroundClip:"text",WebkitBackgroundClip:"text",color:"transparent"},children:"Assessment Submitted Successfully!"}),(0,H.jsx)(h.Z,{variant:"h6",sx:{mb:4,color:"text.secondary",maxWidth:"80%",mx:"auto",lineHeight:1.6},children:"Thank you for completing the assessment. Your answers have been recorded and will be reviewed shortly."}),(0,H.jsxs)(pe.Z,{elevation:2,sx:{p:3,mb:4,borderRadius:2,backgroundColor:"grey.50",width:"100%",maxWidth:500},children:[(0,H.jsxs)(d.Z,{sx:{display:"flex",justifyContent:"center",mb:2},children:[(0,H.jsx)(Xe.Z,{sx:{mr:1,color:"primary.main"}}),(0,H.jsx)(h.Z,{variant:"body2",sx:{fontWeight:500},children:"Results will be available within 24-48 hours"})]}),(0,H.jsx)(h.Z,{variant:"body2",sx:{color:"text.secondary"},children:"You will receive a notification when your results are ready for review."})]}),(0,H.jsx)(d.Z,{sx:{display:"flex",gap:2,flexWrap:"wrap",justifyContent:"center"},children:(0,H.jsx)(S.Z,{variant:"contained",onClick:ot,size:"large",sx:{px:4,py:1,borderRadius:2,fontWeight:600,background:"linear-gradient(45deg, #1976d2 30%, #42a5f5 90%)"},children:"Return to Tests"})})]});if(!k||"testList"===ve)return(0,H.jsxs)(d.Z,{sx:{p:3},children:[$&&(0,H.jsx)(Re.Z,{severity:"error",sx:{mb:2},children:$}),ee?(0,H.jsxs)(d.Z,{sx:{textAlign:"center",my:8},children:[(0,H.jsx)(T.Z,{size:60,thickness:4,sx:{mb:2}}),(0,H.jsx)(h.Z,{variant:"h5",color:"primary",gutterBottom:!0,children:"Loading Assessments"}),(0,H.jsx)(h.Z,{variant:"body2",color:"text.secondary",children:"Preparing your tests..."})]}):0===x.length?(0,H.jsxs)(d.Z,{sx:{textAlign:"center",my:8,p:4,backgroundColor:"grey.50",borderRadius:2},children:[(0,H.jsx)(et.Z,{sx:{fontSize:80,color:"text.secondary",mb:2,opacity:.7}}),(0,H.jsx)(h.Z,{variant:"h5",gutterBottom:!0,color:"text.secondary",children:"No Assessments Available"}),(0,H.jsx)(h.Z,{variant:"body1",color:"text.secondary",sx:{maxWidth:500,mx:"auto",mb:2},children:"There are currently no tests available for this course. Please check back later or contact your instructor."})]}):(0,H.jsxs)(d.Z,{children:[(0,H.jsx)(h.Z,{variant:"h4",gutterBottom:!0,sx:{fontWeight:600,mb:2,textAlign:"center"},children:"Course Assessments"}),(0,H.jsx)(h.Z,{variant:"subtitle1",sx:{textAlign:"center",mb:5,color:"text.secondary",maxWidth:600,mx:"auto"},children:"Select an assessment below to begin testing your knowledge."}),(0,H.jsx)(u.ZP,{container:!0,spacing:4,children:x.map((function(e){return(0,H.jsx)(u.ZP,{item:!0,xs:12,md:6,lg:4,children:(0,H.jsxs)(_.Z,{sx:{cursor:"pointer",height:"100%",display:"flex",flexDirection:"column",transition:"all 0.3s ease",border:"1px solid",borderColor:"divider",borderRadius:3,"&:hover":{transform:"translateY(-4px)",boxShadow:"0 12px 24px rgba(0,0,0,0.15)",borderColor:"secondary.light"}},children:[(0,H.jsxs)(E.Z,{sx:{p:3,flexGrow:1},children:[(0,H.jsxs)(d.Z,{sx:{display:"flex",alignItems:"flex-start",justifyContent:"space-between",flexWrap:"wrap",mb:1},children:[(0,H.jsx)(h.Z,{variant:"h6",sx:{flex:1,fontWeight:600,lineHeight:1.3,wordBreak:"break-word",whiteSpace:"pre-line"},children:e.test_name}),(0,H.jsx)(be.Z,{label:e.course_name,color:"secondary",size:"small",sx:{ml:2,backgroundColor:"secondary.light",color:"secondary.dark",fontWeight:600,alignSelf:"flex-end",flexShrink:0,whiteSpace:"nowrap"}})]}),(0,H.jsx)(h.Z,{variant:"body2",color:"text.secondary",sx:{mb:3,lineHeight:1.6,display:"-webkit-box",WebkitLineClamp:3,WebkitBoxOrient:"vertical",overflow:"hidden"},children:e.description||"Attend all the questions."}),(0,H.jsxs)(d.Z,{sx:{backgroundColor:"grey.50",p:2,borderRadius:2,border:"1px solid",borderColor:"divider"},children:[(0,H.jsxs)(d.Z,{sx:{display:"flex",justifyContent:"space-between",mb:1},children:[(0,H.jsx)(h.Z,{variant:"body2",sx:{fontWeight:500},children:"Questions:"}),(0,H.jsx)(h.Z,{variant:"body2",sx:{fontWeight:600},children:e.question_count})]}),(0,H.jsxs)(d.Z,{sx:{display:"flex",justifyContent:"space-between"},children:[(0,H.jsx)(h.Z,{variant:"body2",sx:{fontWeight:500},children:"Total Marks:"}),(0,H.jsx)(h.Z,{variant:"body2",sx:{fontWeight:600},children:e.total_marks})]})]})]}),(0,H.jsx)(B.Z,{sx:{p:3,pt:0},children:e.correction_done?(0,H.jsx)(H.Fragment,{children:(0,H.jsxs)(d.Z,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",width:"100%"},children:[(0,H.jsx)(be.Z,{variant:"outlined",label:"Submitted",color:"success",size:"small",sx:{fontWeight:600}}),(0,H.jsx)(S.Z,{size:"small",color:"primary",endIcon:(0,H.jsx)(st.Z,{}),onClick:function(){return function(e){C(e),Be(e.test_id)}(e)},sx:{fontWeight:600},children:"View Results"})]})}):e.test_completion?(0,H.jsx)(be.Z,{variant:"outlined",label:"Submitted",color:"success",size:"small",sx:{fontWeight:600}}):(0,H.jsx)(S.Z,{size:"small",color:"primary",endIcon:(0,H.jsx)(st.Z,{}),onClick:function(){return function(e){C(e),G(null),Ie(e)}(e)},sx:{fontWeight:600},children:"Start Assessment"})})]})},e.test_id)}))})]})]});if($&&!A)return(0,H.jsxs)(d.Z,{sx:{p:3,maxWidth:800,margin:"0 auto",textAlign:"center"},children:[(0,H.jsx)(et.Z,{sx:{fontSize:60,color:"error.main",mb:2}}),(0,H.jsx)(h.Z,{variant:"h5",gutterBottom:!0,children:$}),(0,H.jsx)(S.Z,{variant:"contained",onClick:ot,sx:{mt:2},children:"Return to Tests"})]});if(ee||!A)return(0,H.jsx)(d.Z,{sx:{p:3,textAlign:"center"},children:(0,H.jsx)(h.Z,{variant:"h6",children:"Loading assessment..."})});var lt=A.questions[q],ct=!!A&&A.questions.every((function(e){return Pe(e.id)}));return(0,H.jsxs)(d.Z,{sx:{p:{xs:2,md:3},maxWidth:900,margin:"0 auto"},children:[$&&(0,H.jsx)(Re.Z,{severity:"error",sx:{mb:2,borderRadius:2},children:$}),(0,H.jsx)(S.Z,{startIcon:(0,H.jsx)(w.Z,{}),onClick:ot,sx:{mb:3,color:"text.secondary","&:hover":{backgroundColor:"action.hover"}},children:"Return to Test List"}),(0,H.jsxs)(d.Z,{sx:{mb:4,textAlign:"center"},children:[(0,H.jsx)(h.Z,{variant:"h3",gutterBottom:!0,sx:{fontWeight:600},children:A.title}),(0,H.jsx)(h.Z,{variant:"h6",color:"text.secondary",sx:{fontSize:"1rem"},children:A.instructions})]}),(0,H.jsx)(Re.Z,{severity:"info",sx:{mb:3,borderRadius:2},children:"mcq"===lt.type?"Choose the single correct option from the choices below.":"Provide your written response in the text area below."}),(0,H.jsx)(pe.Z,{variant:"outlined",sx:{p:2,mb:2,borderRadius:3},children:(0,H.jsx)(De.Z,{activeStep:q,alternativeLabel:!0,children:A.questions.map((function(e,t){var r=Pe(e.id);return(0,H.jsx)(Ne.Z,{completed:r,children:(0,H.jsx)(He.Z,{StepIconProps:{sx:{"&.Mui-completed":{color:r?"success.main":"grey.400"},"&.Mui-active":{color:"primary.main"}}},children:"Q".concat(t+1)})},e.id)}))})}),(0,H.jsxs)(pe.Z,{elevation:2,sx:{p:3,mb:4,borderRadius:3,border:"1px solid",borderColor:"divider"},children:[(0,H.jsxs)(d.Z,{sx:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",mb:2},children:[(0,H.jsxs)(h.Z,{variant:"h5",sx:{color:"primary.main",fontWeight:500},children:["Question ",q+1," of ",A.questions.length]}),lt.marks&&(0,H.jsx)(be.Z,{label:"".concat(lt.marks," mark").concat(lt.marks>1?"s":""),color:"success",variant:"outlined"})]}),(0,H.jsx)(h.Z,{variant:"body1",sx:{mb:2,fontSize:"1.2rem",lineHeight:1.6},children:lt.text}),"mcq"===lt.type?(0,H.jsx)(Me.Z,{value:M[lt.id]||"",onChange:function(e){return Te(lt.id,e.target.value)},children:lt.options.map((function(e,t){return(0,H.jsx)(pe.Z,{elevation:0,sx:{mb:1.5,p:1.5,borderRadius:2,border:"1px solid",borderColor:M[lt.id]===e?"success.main":"divider",backgroundColor:M[lt.id]===e?"success.lighter":"background.paper",transition:"all 0.2s ease","&:hover":{borderColor:"primary.light",backgroundColor:"action.hover"}},children:(0,H.jsx)(Oe.Z,{value:e,control:(0,H.jsx)(Ye.Z,{}),label:(0,H.jsx)(h.Z,{variant:"body1",children:e}),sx:{width:"100%",m:0}})},t)}))}):(0,H.jsx)(te.Z,{fullWidth:!0,multiline:!0,rows:8,placeholder:"Compose your answer here...",value:M[lt.id]||"",onChange:function(e){return Te(lt.id,e.target.value)},variant:"outlined",sx:{"& .MuiOutlinedInput-root":{borderRadius:2,fontSize:"1rem"}}})]}),(0,H.jsxs)(d.Z,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:4},children:[(0,H.jsx)(S.Z,{variant:"outlined",onClick:function(){q>0&&R(q-1)},disabled:0===q,startIcon:(0,H.jsx)(tt.Z,{}),color:"secondary",sx:{borderRadius:2,px:3},children:"Previous"}),(0,H.jsx)(d.Z,{children:q<A.questions.length-1?(0,H.jsx)(S.Z,{variant:"contained",onClick:function(){q<A.questions.length-1&&R(q+1)},endIcon:(0,H.jsx)(rt.Z,{}),sx:{borderRadius:2,px:4,py:1},children:"Next Question"}):(0,H.jsx)(S.Z,{variant:"contained",color:"success",onClick:it,disabled:!ct,endIcon:(0,H.jsx)(Se.Z,{}),sx:{borderRadius:2,px:4,py:1},children:"Submit Assessment"})})]}),(0,H.jsx)(ge.Z,{sx:{my:3}}),(0,H.jsx)(Re.Z,{severity:ct?"success":"warning",sx:{mb:3,borderRadius:2},icon:ct?(0,H.jsx)(Ue.Z,{}):(0,H.jsx)(nt.Z,{}),children:ct?"All questions have been completed! You may now submit your assessment.":"Complete all questions before submitting. Currently answered: ".concat(Object.keys(M).length,"/").concat(A.questions.length)}),(0,H.jsx)(h.Z,{variant:"body2",color:"text.secondary",sx:{fontStyle:"italic",textAlign:"center"},children:"Note: All responses will be submitted together when you click Submit Assessment. You can review and modify answers anytime before final submission."})]})},ot=["children","value","index"];function at(e){var t=e.children,r=e.value,n=e.index,s=(0,a.Z)(e,ot);return(0,H.jsx)("div",(0,o.Z)((0,o.Z)({role:"tabpanel",hidden:r!==n,id:"simple-tabpanel-".concat(n),"aria-labelledby":"simple-tab-".concat(n)},s),{},{children:r===n&&(0,H.jsx)(d.Z,{sx:{pt:2},children:t})}))}var lt=function(){var e=(0,(0,N.g)().checkPermission)("Exercise","read"),t=(0,b.s0)(),r=(0,b.TH)().state||{},a=r.title,C=r.courseData,S=r.notification,_=JSON.parse(localStorage.getItem("auth")||"{}"),E=(null===_||void 0===_?void 0:_.loginType)||"student",B=(0,l.useMemo)((function(){return[{id:"syllabus",label:"Syllabus",icon:(0,H.jsx)(g.Z,{})},{id:"topics",label:"Topics",icon:(0,H.jsx)(v.Z,{})},{id:"exercise",label:"Exercise",icon:(0,H.jsx)(Z.Z,{})},{id:"assessments",label:"Assessments",icon:(0,H.jsx)(k.Z,{})}]}),[]),I=(0,l.useMemo)((function(){return B.filter((function(t){return"student"===E?["syllabus","topics","exercise","assessments"].includes(t.id):"exercise"===t.id?"admin"!==E||e:["syllabus","topics","classSchedule"].includes(t.id)}))}),[B,E,e]),T=(0,l.useMemo)((function(){var e={};return I.forEach((function(t,r){e[t.id]=r})),e}),[I]),P=(0,l.useCallback)((function(e){if(!e)return 0;var t=e.toLowerCase();return T[{syllabus:"syllabus",topic:"topics",topics:"topics",exercise:"exercise",assessment:"assessments",assessments:"assessments",schedule:"classSchedule",classSchedule:"classSchedule"}[t]]||0}),[T]),A=(0,l.useState)(0),z=(0,i.Z)(A,2),W=z[0],F=z[1],q=(0,l.useState)([]),R=(0,i.Z)(q,2),D=R[0],O=R[1],Y=(0,l.useState)(!1),L=(0,i.Z)(Y,2),V=L[0],U=L[1],Q=(0,l.useState)(null),K=(0,i.Z)(Q,2),$=K[0],G=K[1];(0,l.useEffect)((function(){var e=P(S);F(e)}),[S,P]);var J=function(e){return e&&e.syllabus_info?e.syllabus_info.map((function(e){var t,r,n,s;return(0,o.Z)((0,o.Z)({},e),{},{file:{name:(null===(t=e.file)||void 0===t?void 0:t.name)||"Untitled",type:(null===(r=e.file)||void 0===r?void 0:r.type)||"",size:(null===(n=e.file)||void 0===n?void 0:n.size)||0,url:(null===(s=e.file)||void 0===s?void 0:s.url)||""}})})):[]},X=(0,l.useCallback)((0,s.Z)((0,n.Z)().mark((function e(){var t,r;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==C&&void 0!==C&&C.course_id){e.next=2;break}return e.abrupt("return");case 2:return U(!0),G(null),e.prev=4,e.next=7,se.Z.get("".concat(ie.t6,"api/courses/").concat(C.course_id));case 7:if(t=e.sent,!(r=t.data)){e.next=13;break}O(J(r)),e.next=14;break;case 13:throw new Error(r.message||"Failed to fetch course details");case 14:e.next=20;break;case 16:e.prev=16,e.t0=e.catch(4),console.error("Error fetching course details:",e.t0),G(e.t0.message||"An error occurred while fetching course details");case 20:return e.prev=20,U(!1),e.finish(20);case 23:case"end":return e.stop()}}),e,null,[[4,16,20,23]])}))),[null===C||void 0===C?void 0:C.course_id]);(0,l.useEffect)((function(){X()}),[X]);var ee=function(){var e=(0,s.Z)((0,n.Z)().mark((function e(t){var r,s;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r=new FormData,Object.keys(t).forEach((function(e){"file"===e&&t[e]?r.append("syllabus",t.file):t[e]&&r.append(e,t[e])})),e.next=5,se.Z.patch("".concat(ie.t6,"api/courses/").concat(C.course_id),r,{headers:{"Content-Type":"multipart/form-data"}});case 5:if(!(s=e.sent).data.success){e.next=12;break}return e.next=9,X();case 9:return e.abrupt("return",s.data.data);case 12:throw new Error(s.data.message||"Failed to add syllabus item");case 13:e.next=19;break;case 15:throw e.prev=15,e.t0=e.catch(0),console.error("Error adding syllabus item:",e.t0),e.t0;case 19:case"end":return e.stop()}}),e,null,[[0,15]])})));return function(t){return e.apply(this,arguments)}}(),te=function(){var e=(0,s.Z)((0,n.Z)().mark((function e(t,r){var s,i;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,s=new FormData,Object.keys(r).forEach((function(e){"file"===e&&r[e]?s.append("syllabus",r.file):r[e]&&s.append(e,r[e])})),e.next=5,se.Z.patch("".concat(ie.t6,"api/courses/").concat(C.course_id,"/syllabus/").concat(t),s,{headers:{"Content-Type":"multipart/form-data"}});case 5:if(!(i=e.sent).data.success){e.next=12;break}return e.next=9,X();case 9:return e.abrupt("return",i.data.data);case 12:throw new Error(i.data.message||"Failed to update syllabus item");case 13:e.next=19;break;case 15:throw e.prev=15,e.t0=e.catch(0),console.error("Error updating syllabus item:",e.t0),e.t0;case 19:case"end":return e.stop()}}),e,null,[[0,15]])})));return function(t,r){return e.apply(this,arguments)}}(),re=function(){var e=(0,s.Z)((0,n.Z)().mark((function e(t){var r;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,se.Z.delete("".concat(ie.t6,"api/courses/").concat(C.course_id,"/syllabus/").concat(t));case 3:if(!(r=e.sent).data.success){e.next=9;break}return e.next=7,X();case 7:e.next=10;break;case 9:throw new Error(r.data.message||"Failed to delete syllabus item");case 10:e.next=16;break;case 12:throw e.prev=12,e.t0=e.catch(0),console.error("Error deleting syllabus item:",e.t0),e.t0;case 16:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(t){return e.apply(this,arguments)}}();return(0,H.jsxs)(j._,{dateAdapter:y.H,children:[(0,H.jsx)(u.ZP,{container:!0,spacing:3,sx:{position:"absolute",top:18,left:"50%",zIndex:1,width:"50%"},children:(0,H.jsx)(u.ZP,{item:!0,xs:12,sx:{justifyItems:"flex-end"},children:(0,H.jsx)(x.Z,{sx:{mb:{xs:-.5,sm:.5}},spacing:1,children:(0,H.jsxs)(p.Z,{variant:"contained",color:"secondary",size:"medium",onClick:function(){return t(-1)},sx:{width:100,gap:1},children:[(0,H.jsx)(w.Z,{}),"Back"]})})})}),(0,H.jsx)(c.Z,{children:(0,H.jsxs)(u.ZP,{container:!0,spacing:4,children:[(0,H.jsx)(u.ZP,{item:!0,xs:12,children:(0,H.jsxs)(x.Z,{spacing:1,children:[(0,H.jsxs)(h.Z,{variant:"h4",children:["Course Name : ",(0,Ee.Z)(a)]}),$&&(0,H.jsx)(h.Z,{color:"error",variant:"body2",children:$})]})}),(0,H.jsx)(u.ZP,{item:!0,xs:12,children:(0,H.jsxs)(d.Z,{sx:{width:"100%"},children:[(0,H.jsx)(d.Z,{sx:{borderBottom:1,borderColor:"divider",py:2,px:4,bgcolor:"background.paper"},children:(0,H.jsx)(m.Z,{value:W,onChange:function(e,t){F(t)},variant:"scrollable",scrollButtons:"auto","aria-label":"course detail tabs",children:I.map((function(e,t){return(0,H.jsx)(f.Z,(0,o.Z)({className:"tabs",label:e.label,icon:e.icon,iconPosition:"start"},function(e){return{id:"simple-tab-".concat(e),"aria-controls":"simple-tabpanel-".concat(e)}}(t)),e.id)}))})}),(0,H.jsx)(at,{value:W,index:T.syllabus,children:V?(0,H.jsx)(h.Z,{children:"Loading syllabus..."}):(0,H.jsx)(M,{data:D,onAddItem:ee,onUpdateItem:te,onDeleteItem:re})}),(0,H.jsx)(at,{value:W,index:T.topics,children:(0,H.jsx)(ue,{courseId:null===C||void 0===C?void 0:C.course_id})}),(0,H.jsx)(at,{value:W,index:T.exercise,children:(0,H.jsx)(Pe,{courseId:null===C||void 0===C?void 0:C.course_id})}),void 0!==T.assessments&&(0,H.jsx)(at,{value:W,index:T.assessments,children:(0,H.jsx)(it,{courseId:null===C||void 0===C?void 0:C.course_id})})]})})]})})]})}},78045:function(e,t,r){r.d(t,{o:function(){return i}});var n=r(29439),s=r(23197),i=function(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=r.includeTime,o=void 0===i||i,a=r.includeSeconds,l=void 0!==a&&a,c=r.timeOnly,d=void 0!==c&&c,u=r.useCurrentIfEmpty,x=void 0!==u&&u,p=r.fallback,h=void 0===p?"":p;if(e)if("string"===typeof e&&/^\d{1,2}:\d{2}(:\d{2})?$/.test(e)){var m=e.split(":").map(Number),f=(0,n.Z)(m,3),b=f[0],g=f[1],v=f[2];(t=new Date).setHours(b,g,v||0,0)}else t=e instanceof Date?e:new Date(e);else{if(!x)return h;t=new Date}if(isNaN(t.getTime()))return h;var Z=function(e,t){var r=t.getHours(),n=r>=12,s={yyyy:t.getFullYear(),yy:String(t.getFullYear()).slice(-2),MM:String(t.getMonth()+1).padStart(2,"0"),M:t.getMonth()+1,dd:String(t.getDate()).padStart(2,"0"),d:t.getDate(),HH:String(r).padStart(2,"0"),H:r,hh:String(r%12||12).padStart(2,"0"),h:r%12||12,mm:String(t.getMinutes()).padStart(2,"0"),m:t.getMinutes(),ss:String(t.getSeconds()).padStart(2,"0"),s:t.getSeconds(),a:n?"PM":"AM"};return e.replace(/(yyyy|yy|MM|M|dd|d|HH|H|hh|h|mm|m|ss|s|a)/g,(function(e){return s[e]||e}))};if(d){var j=s.ZP.timeFormat;return l||(j=(j=(j=j.replace(/:ss?/g,"")).replace(/(^|\s)ss?(\s|$)/g,"$1$2")).replace(/::/g,":").replace(/(\s|^):|:(\s|$)/g,"$1$2")),Z(j,t)}if(o){var y=Z(s.ZP.dateFormat,t),k=s.ZP.timeFormat;l||(k=(k=k.replace(/[:\\/]?ss?/g,"")).replace(/::/g,":").replace(/:$/,""));var w=Z(k,t);return"".concat(y," ").concat(w)}return Z(s.ZP.dateFormat,t)}}}]);
//# sourceMappingURL=2133.03dd1850.chunk.js.map