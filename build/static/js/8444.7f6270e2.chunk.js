"use strict";(self.webpackChunkable_pro_material_react=self.webpackChunkable_pro_material_react||[]).push([[8444],{42664:function(e,t,r){r.d(t,{g:function(){return s}});var n=r(72791),s=function(){return{checkPermission:(0,n.useCallback)((function(e,t){try{var r,n=JSON.parse(localStorage.getItem("auth")||"[]"),s=null===n||void 0===n?void 0:n.loginType,o=(null===n||void 0===n||null===(r=n.user)||void 0===r?void 0:r.permissions)||[];return"super_admin"===s||"admin"===s&&o.some((function(r){return r.module_name===e&&r.allowed_actions.includes(t)}))}catch(i){return console.error("Error checking permission:",i),!1}}),[])}}},68444:function(e,t,r){r.r(t);var n=r(1413),s=r(61819),o=r(15861),i=r(29439),a=r(72791),l=r(697),c=r(61889),u=r(36314),d=r(48550),x=r(63466),m=r(13400),h=r(74982),p=r(94294),f=r(57621),Z=r(39504),g=r(20890),v=r(81918),j=r(72363),_=r(35527),b=r(5574),C=r(65661),k=r(39157),y=r(17133),w=r(97123),B=r(68087),S=r(32923),W=r(24034),T=r(57689),I=r(23197),P=r(89731),z=r(36277),E=r(8007),A=r(21830),L=r.n(A),O=r(58536),q=r(10163),M=r(62634),R=r(17139),F=r(42664),V=r(80184),D=E.Ry({test_name:E.Z_().required("Module title is required").trim().matches(/^.*\S.*$/,"Module title cannot be blank or only spaces"),course_id:E.Z_().required("Course selection is required").trim().matches(/^.*\S.*$/,"Course selection cannot be only spaces"),description:E.Z_().optional(),total_marks:E.Rx().required("Total marks is required").positive("Total marks must be positive")});t.default=function(){var e=(0,T.s0)(),t=(0,F.g)().checkPermission,r=t("Assessment","create"),E=t("Assessment","update"),A=t("Assessment","delete"),N=(0,a.useState)([]),Y=(0,i.Z)(N,2),G=Y[0],K=Y[1],Q=(0,a.useState)([]),$=(0,i.Z)(Q,2),H=$[0],J=$[1],U=(0,a.useState)(null),X=(0,i.Z)(U,2),ee=X[0],te=X[1],re=(0,a.useState)(!1),ne=(0,i.Z)(re,2),se=ne[0],oe=ne[1],ie=(0,a.useState)(null),ae=(0,i.Z)(ie,2),le=ae[0],ce=ae[1],ue=(0,a.useState)(null),de=(0,i.Z)(ue,2),xe=de[0],me=de[1],he=(0,a.useState)(""),pe=(0,i.Z)(he,2),fe=pe[0],Ze=pe[1],ge=(0,z.TA)({initialValues:{test_name:"",course_id:"",description:"",total_marks:""},validationSchema:D,onSubmit:function(){var e=(0,o.Z)((0,s.Z)().mark((function e(t,r){var n,o,i,a,l,c;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=r.resetForm,o=r.setSubmitting,e.prev=1,i={test_name:t.test_name,course_id:t.course_id,description:t.description,total_marks:parseInt(t.total_marks)},!le){e.next=9;break}return e.next=6,P.Z.patch("".concat(I.t6,"api/test/").concat(le.test_id),i);case 6:a=e.sent,e.next=12;break;case 9:return e.next=11,P.Z.post("".concat(I.t6,"api/test"),i);case 11:a=e.sent;case 12:!0===a.data.success?(L().fire({title:"Success!",text:a.data.message,icon:"success",showConfirmButton:!0,confirmButtonText:"OK"}),ve()):L().fire({title:"Error!",text:a.data.message,icon:"error",showConfirmButton:!0,confirmButtonText:"OK"}),oe(!1),ce(null),n(),e.next=22;break;case 18:e.prev=18,e.t0=e.catch(1),console.error("API Error:",e.t0),L().fire({title:"Error!",text:(null===(l=e.t0.response)||void 0===l||null===(c=l.data)||void 0===c?void 0:c.message)||"An error occurred",icon:"error",showConfirmButton:!0,confirmButtonText:"OK"});case 22:return e.prev=22,o(!1),e.finish(22);case 25:case"end":return e.stop()}}),e,null,[[1,18,22,25]])})));return function(t,r){return e.apply(this,arguments)}}()}),ve=(0,a.useCallback)((0,o.Z)((0,s.Z)().mark((function e(){var t,r,o,i;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,P.Z.get("".concat(I.t6,"api/test"));case 3:r=e.sent,o=r.data,i=null===(t=o.data)||void 0===t?void 0:t.map((function(e,t){return(0,n.Z)({sno:t+1},e)})),J(o.courses),K(i||[]),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(0),te(e.t0.message),console.error("Error fetching student data:",e.t0);case 14:case"end":return e.stop()}}),e,null,[[0,10]])}))),[]),je=(0,a.useMemo)((function(){return G.filter((function(e){var t,r,n;if(!e)return!1;var s=!fe||(null===(t=e.course.course_name)||void 0===t?void 0:t.toLowerCase().includes(fe.toLowerCase()))||(null===(r=e.description)||void 0===r?void 0:r.toLowerCase().includes(fe.toLowerCase()))||(null===(n=e.test_name)||void 0===n?void 0:n.toLowerCase().includes(fe.toLowerCase())),o=!xe||e.course.course_id===xe.course_id;return s&&o}))}),[G,xe,fe]);(0,a.useEffect)((function(){ve()}),[ve]);var _e=function(){var e=(0,o.Z)((0,s.Z)().mark((function e(t){var r;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,L().fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!"});case 3:if(!e.sent.isConfirmed){e.next=9;break}return e.next=7,P.Z.patch("".concat(I.t6,"api/test/").concat(t,"/archive"));case 7:(r=e.sent).data.success?(L().fire("Deleted!",r.data.message,"success"),ve()):L().fire("Error!",r.data.message,"error");case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),L().fire("Error!","Failed to delete module","error");case 14:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(t){return e.apply(this,arguments)}}(),be=function(){oe(!1),ce(null),ge.resetForm()};return ee?(0,V.jsx)(W.Z,{sx:{borderRadius:2},children:(0,V.jsxs)(l.Z,{p:3,color:"error.main",children:["Error: ",ee]})}):(0,V.jsxs)(V.Fragment,{children:[(0,V.jsxs)(W.Z,{children:[(0,V.jsxs)(c.ZP,{container:!0,justifyContent:"space-between",alignItems:"center",my:3,spacing:2,children:[(0,V.jsx)(c.ZP,{item:!0,xs:12,children:(0,V.jsx)(u.Z,{direction:{xs:"column",sm:"row"},alignItems:{xs:"stretch",sm:"center"},spacing:2,width:"100%",children:(0,V.jsxs)(l.Z,{sx:{display:"flex",flexDirection:"row",flexWrap:"wrap",gap:2,width:{xs:"100%",sm:"auto"},"& > *":{minWidth:{xs:"calc(50% - 8px)",sm:200},flexGrow:1}},children:[(0,V.jsx)(d.Z,{placeholder:"Search by name, ID, email, or phone...",variant:"outlined",size:"small",sx:{minWidth:{xs:"100%",sm:250},flexGrow:1},autoComplete:"nope",value:fe,onChange:function(e){return Ze(e.target.value)},InputProps:{startAdornment:(0,V.jsx)(x.Z,{position:"start",children:(0,V.jsx)(O.Z,{size:20})}),endAdornment:(0,V.jsx)(x.Z,{position:"end",children:fe&&(0,V.jsx)(m.Z,{onClick:function(){Ze("")},edge:"end",size:"small",children:(0,V.jsx)(q.Z,{size:20})})})}}),(0,V.jsx)(h.Z,{id:"course_id",options:H||[],getOptionLabel:function(e){return e.course_name||""},value:xe,onChange:function(e,t){me(t)},size:"small",sx:{minWidth:{xs:"100%",sm:180,md:200},flex:"1 1 auto"},renderInput:function(e){return(0,V.jsx)(d.Z,(0,n.Z)((0,n.Z)({},e),{},{placeholder:"Filter by course...",InputProps:(0,n.Z)({},e.InputProps)}))},filterOptions:function(){var e=arguments.length>1?arguments[1]:void 0;return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).filter((function(t){var r;return null===(r=t.course_name)||void 0===r?void 0:r.toLowerCase().includes(e.inputValue.toLowerCase())}))},isOptionEqualToValue:function(e,t){return e.course_id===t.course_id},renderOption:function(e,t){return(0,a.createElement)("li",(0,n.Z)((0,n.Z)({},e),{},{key:t.course_id}),t.course_name)}})]})})}),(0,V.jsx)(c.ZP,{item:!0,xs:12,children:(0,V.jsx)(u.Z,{spacing:2,direction:"row",justifyContent:"flex-end",children:r&&(0,V.jsx)(p.Z,{variant:"contained",startIcon:(0,V.jsx)(B.Z,{}),onClick:function(){ge.resetForm(),oe(!0)},sx:{fontWeight:600,textTransform:"none",fontSize:"1rem"},color:"success",children:"Create New Module"})})})]}),(0,V.jsx)(c.ZP,{container:!0,spacing:3,children:je.map((function(t){return(0,V.jsx)(c.ZP,{item:!0,xs:12,md:6,lg:4,children:(0,V.jsxs)(f.Z,{elevation:2,sx:{height:"100%",display:"flex",flexDirection:"column",borderRadius:3,border:"1px solid",borderColor:"divider",transition:"all 0.3s ease","&:hover":{transform:"translateY(-4px)",boxShadow:"0 8px 24px rgba(0,0,0,0.12)",borderColor:"secondary.light"}},children:[(0,V.jsxs)(Z.Z,{sx:{flexGrow:1,p:3},children:[(0,V.jsxs)(l.Z,{sx:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",width:"100%"},children:[(0,V.jsx)(g.Z,{variant:"h5",component:"h2",gutterBottom:!0,sx:{fontWeight:600,flex:1,wordBreak:"break-word"},children:t.test_name}),(0,V.jsx)(v.Z,{label:t.course.course_name,color:"secondary",size:"small",sx:{mb:1,fontWeight:500,backgroundColor:"secondary.light",color:"secondary.dark",alignSelf:"flex-start",ml:2,whiteSpace:"nowrap"}})]}),(0,V.jsx)(g.Z,{variant:"body2",color:"text.secondary",sx:{minHeight:40,display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden"},children:t.description||"Attend all the questions."}),(0,V.jsxs)(l.Z,{sx:{backgroundColor:"grey.50",p:2,borderRadius:2,border:"1px solid",borderColor:"divider"},children:[(0,V.jsxs)(l.Z,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:1.5},children:[(0,V.jsx)(l.Z,{sx:{display:"flex",alignItems:"center"},children:(0,V.jsx)(g.Z,{variant:"body2",sx:{ml:1,fontWeight:500},children:"Questions:"})}),(0,V.jsx)(g.Z,{variant:"body2",sx:{fontWeight:600},children:t.question_count})]}),(0,V.jsxs)(l.Z,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,V.jsx)(l.Z,{sx:{display:"flex",alignItems:"center"},children:(0,V.jsx)(g.Z,{variant:"body2",sx:{ml:1,fontWeight:500},children:"Total Marks:"})}),(0,V.jsx)(g.Z,{variant:"body2",sx:{fontWeight:600},children:t.total_marks})]})]})]}),(0,V.jsxs)(j.Z,{sx:{p:2,pt:0,justifyContent:"space-between"},children:[(0,V.jsx)(p.Z,{size:"small",onClick:function(){return function(t){e("/assessment/questions/".concat(t.test_id),{state:{module:t}})}(t)},sx:{fontWeight:500,borderRadius:1,px:2},children:"Manage Questions"}),(0,V.jsxs)(l.Z,{children:[E&&(0,V.jsx)(m.Z,{size:"small",onClick:function(){return function(e){ce(e),ge.setValues({test_name:e.test_name||"",course_id:e.course_id||"",description:e.description||"",total_marks:e.total_marks||""}),oe(!0)}(t)},"aria-label":"edit",sx:{color:"secondary.main","&:hover":{backgroundColor:"secondary.light"}},children:(0,V.jsx)(M.Z,{})}),A&&(0,V.jsx)(m.Z,{size:"small",onClick:function(){return _e(t.test_id)},"aria-label":"delete",sx:{color:"error.main","&:hover":{backgroundColor:"error.lighter"}},children:(0,V.jsx)(R.Z,{})})]})]})]})},t.test_id)}))}),0===je.length&&(0,V.jsxs)(_.Z,{sx:{p:6,textAlign:"center",mt:4,borderRadius:3,backgroundColor:"grey.50"},children:[(0,V.jsx)(S.Z,{sx:{fontSize:60,color:"text.secondary",mb:2,opacity:.7}}),(0,V.jsx)(g.Z,{variant:"h5",gutterBottom:!0,color:"text.secondary",children:"No Assessment Modules Yet"}),(0,V.jsx)(g.Z,{variant:"body1",color:"text.secondary",sx:{mb:3,maxWidth:400,mx:"auto"},children:"Create your first assessment module to organize questions and tests for your courses."})]})]}),(0,V.jsx)(b.Z,{open:se,onClose:be,maxWidth:"sm",fullWidth:!0,children:(0,V.jsxs)("form",{onSubmit:ge.handleSubmit,children:[(0,V.jsx)(C.Z,{sx:{fontWeight:600,py:2,mb:2},children:le?"Edit Assessment Module":"Create New Assessment Module"}),(0,V.jsx)(k.Z,{sx:{p:3},children:(0,V.jsxs)(c.ZP,{container:!0,spacing:2,children:[(0,V.jsx)(c.ZP,{item:!0,xs:12,md:6,children:(0,V.jsxs)(u.Z,{spacing:1,children:[(0,V.jsx)(y.Z,{sx:{fontWeight:600},children:"Module Title *"}),(0,V.jsx)(d.Z,{autoFocus:!0,name:"test_name",fullWidth:!0,variant:"outlined",size:"small",value:ge.values.test_name,onChange:ge.handleChange,onBlur:ge.handleBlur,error:ge.touched.test_name&&Boolean(ge.errors.test_name),helperText:ge.touched.test_name&&ge.errors.test_name,placeholder:"Enter module title"})]})}),(0,V.jsx)(c.ZP,{item:!0,xs:12,md:6,children:(0,V.jsxs)(u.Z,{spacing:1,children:[(0,V.jsx)(y.Z,{sx:{fontWeight:600},children:"Course *"}),(0,V.jsx)(h.Z,{id:"course_id",options:H||[],getOptionLabel:function(e){return e.course_name},value:(null===H||void 0===H?void 0:H.find((function(e){return e.course_id===ge.values.course_id})))||null,onChange:function(e,t){ge.setFieldValue("course_id",t?t.course_id:"")},onBlur:ge.handleBlur,renderInput:function(e){return(0,V.jsx)(d.Z,(0,n.Z)((0,n.Z)({},e),{},{name:"course_id",placeholder:"Select a course...",size:"small",error:ge.touched.course_id&&Boolean(ge.errors.course_id),helperText:ge.touched.course_id&&ge.errors.course_id}))},filterOptions:function(){var e=arguments.length>1?arguments[1]:void 0;return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).filter((function(t){return t.course_name.toLowerCase().includes(e.inputValue.toLowerCase())}))},isOptionEqualToValue:function(e,t){return e.course_id===t.course_id},renderOption:function(e,t){return(0,a.createElement)("li",(0,n.Z)((0,n.Z)({},e),{},{key:t.course_id}),t.course_name)},noOptionsText:"No courses found",loadingText:"Loading..."})]})}),(0,V.jsx)(c.ZP,{item:!0,xs:12,md:6,children:(0,V.jsxs)(u.Z,{spacing:1,children:[(0,V.jsx)(y.Z,{sx:{fontWeight:600},children:"Total Marks *"}),(0,V.jsx)(d.Z,{name:"total_marks",fullWidth:!0,type:"number",variant:"outlined",size:"small",value:ge.values.total_marks,onChange:ge.handleChange,onBlur:ge.handleBlur,error:ge.touched.total_marks&&Boolean(ge.errors.total_marks),helperText:ge.touched.total_marks&&ge.errors.total_marks,inputProps:{min:1}})]})}),(0,V.jsx)(c.ZP,{item:!0,xs:12,children:(0,V.jsxs)(u.Z,{spacing:1,children:[(0,V.jsx)(y.Z,{sx:{fontWeight:600},children:"Description"}),(0,V.jsx)(d.Z,{name:"description",fullWidth:!0,variant:"outlined",multiline:!0,rows:3,value:ge.values.description,onChange:ge.handleChange,onBlur:ge.handleBlur,error:ge.touched.description&&Boolean(ge.errors.description),helperText:ge.touched.description&&ge.errors.description,placeholder:"Describe the purpose of this assessment module..."})]})})]})}),(0,V.jsxs)(w.Z,{sx:{p:2},children:[(0,V.jsx)(p.Z,{onClick:be,sx:{borderRadius:1},children:"Cancel"}),(0,V.jsx)(p.Z,{type:"submit",variant:"contained",disabled:ge.isSubmitting,sx:{borderRadius:1,px:3},children:le?"Save Changes":"Create Module"})]})]})})]})}}}]);
//# sourceMappingURL=8444.7f6270e2.chunk.js.map