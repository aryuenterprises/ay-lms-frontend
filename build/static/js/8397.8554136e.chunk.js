"use strict";(self.webpackChunkable_pro_material_react=self.webpackChunkable_pro_material_react||[]).push([[8397],{42664:function(e,t,n){n.d(t,{g:function(){return a}});var r=n(72791),a=function(){return{checkPermission:(0,r.useCallback)((function(e,t){try{var n,r=JSON.parse(localStorage.getItem("auth")||"[]"),a=null===r||void 0===r?void 0:r.loginType,i=(null===r||void 0===r||null===(n=r.user)||void 0===n?void 0:n.permissions)||[];return"super_admin"===a||"admin"===a&&i.some((function(n){return n.module_name===e&&n.allowed_actions.includes(t)}))}catch(s){return console.error("Error checking permission:",s),!1}}),[])}}},60543:function(e,t,n){n.r(t),n.d(t,{default:function(){return se}});var r=n(93433),a=n(1413),i=n(61819),s=n(15861),l=n(29439),o=n(72791),d=n(697),c=n(13239),u=n(20890),h=n(36314),m=n(94294),_=n(74982),p=n(48550),f=n(5574),x=n(65661),v=n(13400),g=n(39157),Z=n(61889),y=n(68096),j=n(17133),w=n(58406),b=n(23786),D=n(79012),S=n(85523),k=n(94454),C=n(97123),F=n(81918),T=n(36277),V=n(24034),P=n(8007),I=n(89731),B=n(64370),E=n(10163),O=n(17139),H=n(62634),W=n(23197),M=n(54357),L=n(16386),N=n(3216),q=n(13629),A=n(40467),z=(n(45852),n(56704)),Y=n(90838),R=n(71652),U=n(41985),$=n(32992),K=function(e){return new Date(e).toTimeString().split(" ")[0]},G=n(21830),J=n.n(G),Q=(n(91587),n(85680)),X=n(12649),ee=n(42664),te=n(78045),ne=n(80184),re={"en-US":z.Z},ae=(0,M.lD)({format:L.Z,parse:N.Z,startOfWeek:q.Z,getDay:A.Z,locales:re}),ie=P.Ry().shape({employee_id:P.Z_().required("Employee ID is required"),start_date:P.hT().required("Start date is required"),end_date:P.hT().required("End date is required").min(P.iH("start_date"),"End date must be after start date"),start_time:P.hT().required("Start time is required"),end_time:P.hT().required("End time is required").min(P.iH("start_time"),"End time must be after start time"),batch_id:P.Z_().required("Batch selection is required"),recurrence_type:P.Z_().required()}),se=function(){var e,t,n,P,L=(0,ee.g)().checkPermission,N=L("Schedule","create"),q=L("Schedule","delete"),A=(0,o.useState)([]),z=(0,l.Z)(A,2),G=z[0],re=z[1],se=(0,o.useState)([]),le=(0,l.Z)(se,2),oe=le[0],de=le[1],ce=(0,o.useState)([]),ue=(0,l.Z)(ce,2),he=ue[0],me=ue[1],_e=(0,o.useState)(!0),pe=(0,l.Z)(_e,2),fe=pe[0],xe=pe[1],ve=(0,o.useState)(null),ge=(0,l.Z)(ve,2),Ze=ge[0],ye=ge[1],je=(0,o.useState)(!1),we=(0,l.Z)(je,2),be=we[0],De=we[1],Se=(0,o.useState)(!1),ke=(0,l.Z)(Se,2),Ce=ke[0],Fe=ke[1],Te=(0,o.useState)(null),Ve=(0,l.Z)(Te,2),Pe=Ve[0],Ie=Ve[1],Be=(0,o.useState)(null),Ee=(0,l.Z)(Be,2),Oe=Ee[0],He=Ee[1],We=(0,o.useState)([]),Me=(0,l.Z)(We,2),Le=Me[0],Ne=Me[1],qe=(0,o.useState)(!1),Ae=(0,l.Z)(qe,2),ze=Ae[0],Ye=Ae[1],Re=(0,o.useState)(null),Ue=(0,l.Z)(Re,2),$e=Ue[0],Ke=Ue[1],Ge=(0,o.useState)(null),Je=(0,l.Z)(Ge,2),Qe=Je[0],Xe=Je[1],et=(0,o.useState)([]),tt=(0,l.Z)(et,2),nt=tt[0],rt=tt[1],at=(0,o.useState)("month"),it=(0,l.Z)(at,2),st=it[0],lt=it[1],ot=(0,o.useState)(new Date),dt=(0,l.Z)(ot,2),ct=dt[0],ut=dt[1],ht=(0,o.useState)(null),mt=(0,l.Z)(ht,2),_t=mt[0],pt=mt[1],ft=(0,o.useState)(null),xt=(0,l.Z)(ft,2),vt=xt[0],gt=xt[1],Zt=(0,o.useState)(null),yt=(0,l.Z)(Zt,2),jt=yt[0],wt=yt[1],bt=(0,o.useState)(null),Dt=(0,l.Z)(bt,2),St=Dt[0],kt=Dt[1],Ct=(0,o.useState)(null),Ft=(0,l.Z)(Ct,2),Tt=Ft[0],Vt=Ft[1],Pt=JSON.parse(localStorage.getItem("auth")),It=(null===Pt||void 0===Pt||null===(e=Pt.user)||void 0===e?void 0:e.employee_id)||(null===Pt||void 0===Pt||null===(t=Pt.user)||void 0===t?void 0:t.user_id),Bt=null===Pt||void 0===Pt?void 0:Pt.loginType,Et="tutor"===(null===Pt||void 0===Pt||null===(n=Pt.user)||void 0===n?void 0:n.user_type),Ot=ct.getMonth()+1,Ht=ct.getFullYear(),Wt=(0,o.useCallback)((0,s.Z)((0,i.Z)().mark((function e(){var t,n,r,a;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,xe(!0),!Et){e.next=12;break}return e.next=5,I.Z.get("".concat(W.t6,"api/class_schedule/").concat(It,"/schedules"),{params:{month:Ot,year:Ht}});case 5:t=e.sent,re(t.data.Class_Schedule),de(t.data.Batches),me(t.data.Trainers),gt(t.data.Courses),e.next=19;break;case 12:return e.next=14,I.Z.get("".concat(W.t6,"api/class_schedule"),{params:{month:Ot,year:Ht}});case 14:n=e.sent,re(n.data.Class_Schedule),de(n.data.Batches),me(n.data.Trainers),gt(n.data.Courses);case 19:xe(!1),e.next=26;break;case 22:e.prev=22,e.t0=e.catch(0),ye((null===(r=e.t0.response)||void 0===r||null===(a=r.data)||void 0===a?void 0:a.message)||"Error fetching schedules"),xe(!1);case 26:case"end":return e.stop()}}),e,null,[[0,22]])}))),[Et,It,Ot,Ht]),Mt=(0,o.useMemo)((function(){return null===G||void 0===G?void 0:G.filter((function(e){if(!e)return!1;var t=!Tt||e.trainer_employee_id===Tt.employee_id,n=!jt||e.course_id===jt.course_id,r=!St||e.batch_id===St.batch_id;return t&&n&&r}))}),[G,jt,Tt,St]);(0,o.useEffect)((function(){Wt()}),[Wt]),(0,o.useEffect)((function(){if(Qe){var e=null===G||void 0===G?void 0:G.filter((function(e){var t=new Date(e.scheduled_date);return t.getFullYear()===Qe.getFullYear()&&t.getMonth()===Qe.getMonth()&&t.getDate()===Qe.getDate()}));rt(e)}else rt(G)}),[Qe,G]);var Lt=(0,T.TA)({initialValues:{recurrence_type:"day",days_of_week:[],employee_id:null,start_date:null,end_date:null,start_time:null,end_time:null,batch_id:null,course_id:null,class_link:""},validationSchema:ie,onSubmit:function(){var e=(0,s.Z)((0,i.Z)().mark((function e(t){var n,r,s,l,o;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,n=(0,a.Z)({batch:t.batch_id,course:t.course_id,start_date:(0,Y.p)(t.start_date),end_date:(0,Y.p)(t.end_date),start_time:K(t.start_time),end_time:K(t.end_time),recurrence_type:t.recurrence_type,employee_id:t.employee_id,is_online_class:!!t.class_link,class_link:t.class_link||void 0},"custom_days"===t.recurrence_type?{days_of_week:t.days_of_week}:{}),!Pe){e.next=15;break}return e.next=5,I.Z.patch("".concat(W.t6,"api/class_schedule/").concat(Pe.schedule_id),n);case 5:if(!0!==(r=e.sent).data.success){e.next=11;break}return e.next=9,J().fire({title:"Success!",text:"Schedule updated successfully",icon:"success",showConfirmButton:!0,confirmButtonText:"OK"});case 9:e.next=13;break;case 11:return e.next=13,J().fire({title:"Success!",text:r.data.message,icon:"success",showConfirmButton:!0,confirmButtonText:"OK"});case 13:e.next=25;break;case 15:return e.next=17,I.Z.post("".concat(W.t6,"api/recurring_schedules"),n);case 17:if(!0!==(s=e.sent).data.success){e.next=23;break}return e.next=21,J().fire({title:"Success!",text:"Schedule created successfully",icon:"success",showConfirmButton:!0,confirmButtonText:"OK"});case 21:e.next=25;break;case 23:return e.next=25,J().fire({title:"Error!",text:s.data.message,icon:"error",showConfirmButton:!0,confirmButtonText:"OK"});case 25:return e.next=27,Wt();case 27:At(),Yt(),e.next=34;break;case 31:e.prev=31,e.t0=e.catch(0),ye((null===(l=e.t0.response)||void 0===l||null===(o=l.data)||void 0===o?void 0:o.message)||"Error saving schedule");case 34:case"end":return e.stop()}}),e,null,[[0,31]])})));return function(t){return e.apply(this,arguments)}}()});(0,o.useEffect)((function(){if(Lt.values.employee_id&&he.length>0){var e=he.find((function(e){return e.employee_id===Lt.values.employee_id}))||null;pt(e)}else pt(null)}),[Lt.values.employee_id,he]);var Nt=function(){var e=(0,s.Z)((0,i.Z)().mark((function e(t){var n,r,a;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,J().fire({title:"Are you sure?",text:"Do you really want to delete this schedule?",icon:"warning",showCancelButton:!0,confirmButtonText:"Yes, delete it!",cancelButtonText:"Cancel"});case 2:if(e.sent.isConfirmed){e.next=5;break}return e.abrupt("return");case 5:return e.prev=5,e.next=8,I.Z.patch("".concat(W.t6,"api/class_schedule/").concat(t,"/archive"));case 8:if(!1!==(n=e.sent).data.success){e.next=11;break}return e.abrupt("return");case 11:J().fire("Success!",n.data.message,"success"),Wt(),Ne((function(e){return e.filter((function(e){return e.schedule_id!==t}))})),e.next=19;break;case 16:e.prev=16,e.t0=e.catch(5),ye((null===(r=e.t0.response)||void 0===r||null===(a=r.data)||void 0===a?void 0:a.message)||"Error deleting schedule");case 19:case"end":return e.stop()}}),e,null,[[5,16]])})));return function(t){return e.apply(this,arguments)}}(),qt=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;Ie(t);var n=new Date,r=new Date;if(t){var a=(null===he||void 0===he?void 0:he.find((function(e){return e.employee_id===It})))||null;Lt.setValues({employee_id:t.trainer_employee_id||t.trainer_id,start_date:new Date(t.start_date||t.scheduled_date),end_date:new Date(t.end_date||t.scheduled_date),start_time:new Date("".concat(t.start_date||t.scheduled_date,"T").concat(t.start_time)),end_time:new Date("".concat(t.start_date||t.scheduled_date,"T").concat(t.end_time)),course_id:t.course_id,batch_id:t.batch_id,class_link:t.class_link||"",recurrence_type:t.recurrence_type||"day",days_of_week:t.days_of_week||[]}),pt(a)}else{Lt.resetForm();var i=Et&&(null===he||void 0===he?void 0:he.find((function(e){return e.employee_id===It})))||null;Lt.setValues({employee_id:Et?It:null,start_date:e||n,end_date:e||n,start_time:r,end_time:new Date(r.getTime()+36e5),batch_id:null,class_link:"",recurrence_type:"day",days_of_week:[]}),pt(i)}De(!0)},At=function(){De(!1),Ie(null),Lt.resetForm()},zt=function(e){var t=new Date(e);t.setHours(0,0,0,0);var n=new Date(t);n.setHours(23,59,59,999);var r=(Array.isArray(Mt)?Mt:[]).filter((function(e){var r=new Date(e.scheduled_date);return r>=t&&r<=n}));He(t),Ne(r),Fe(!0)},Yt=function(){Fe(!1),He(null),Ne([])},Rt=function(){Ye(!1),Ke(null)},Ut=function(e){if(!e)return!1;var t=new Date;return e.getDate()===t.getDate()&&e.getMonth()===t.getMonth()&&e.getFullYear()===t.getFullYear()};return fe?(0,ne.jsxs)(d.Z,{sx:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"100vh"},children:[(0,ne.jsx)(c.Z,{}),(0,ne.jsx)(u.Z,{children:"Loading schedules..."})]}):Ze?(0,ne.jsx)(d.Z,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh"},children:(0,ne.jsx)(u.Z,{color:"error",children:Ze})}):(0,ne.jsx)(V.Z,{content:!1,children:(0,ne.jsxs)(d.Z,{sx:{p:2},children:[(0,ne.jsxs)(h.Z,{direction:"row",justifyContent:"space-between",alignItems:"center",mb:2,children:[(0,ne.jsx)(u.Z,{variant:"h5",children:"Class Schedules"}),(N||"tutor"===Bt)&&(0,ne.jsx)(m.Z,{variant:"contained",startIcon:(0,ne.jsx)(B.Z,{}),onClick:function(){return qt()},children:"Add Schedule"})]}),(0,ne.jsx)(h.Z,{direction:{xs:"column",sm:"row"},alignItems:{xs:"stretch",sm:"center"},spacing:2,width:"100%",mb:2,children:(0,ne.jsxs)(d.Z,{sx:{display:"flex",flexDirection:"row",flexWrap:"wrap",gap:2,width:{xs:"100%",sm:"auto"},"& > *":{minWidth:{xs:"calc(50% - 8px)",sm:200},flexGrow:1}},children:[(0,ne.jsx)(R._,{dateAdapter:X.H,children:(0,ne.jsx)(U.M,{label:"Filter by date",value:Qe,onChange:function(e){e?(Xe(e),lt("day"),ut(e)):(Xe(null),lt("month"),ut(new Date))},slotProps:{textField:{variant:"outlined",size:"small"}}})}),Qe&&(0,ne.jsx)(m.Z,{variant:"outlined",onClick:function(){Xe(null),lt("month"),ut(new Date)},children:"Clear Filter"}),(0,ne.jsx)(_.Z,{id:"course_id",options:vt||[],getOptionLabel:function(e){return e.course_name||""},value:jt,onChange:function(e,t){wt(t)},size:"small",sx:{minWidth:{xs:"100%",sm:180,md:200},flex:"1 1 auto"},renderInput:function(e){return(0,ne.jsx)(p.Z,(0,a.Z)((0,a.Z)({},e),{},{placeholder:"Filter by course...",InputProps:(0,a.Z)({},e.InputProps)}))},filterOptions:function(){var e=arguments.length>1?arguments[1]:void 0;return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).filter((function(t){var n;return null===(n=t.course_name)||void 0===n?void 0:n.toLowerCase().includes(e.inputValue.toLowerCase())}))},isOptionEqualToValue:function(e,t){return e.course_id===t.course_id},renderOption:function(e,t){return(0,o.createElement)("li",(0,a.Z)((0,a.Z)({},e),{},{key:t.course_id}),t.course_name)}}),(0,ne.jsx)(_.Z,{id:"batch_id",options:oe||[],getOptionLabel:function(e){return e.title||""},value:St,onChange:function(e,t){kt(t)},size:"small",sx:{minWidth:{xs:"100%",sm:180,md:200},flex:"1 1 auto"},renderInput:function(e){return(0,ne.jsx)(p.Z,(0,a.Z)((0,a.Z)({},e),{},{placeholder:"Filter by batch...",InputProps:(0,a.Z)({},e.InputProps)}))},filterOptions:function(){var e=arguments.length>1?arguments[1]:void 0;return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).filter((function(t){var n;return null===(n=t.title)||void 0===n?void 0:n.toLowerCase().includes(e.inputValue.toLowerCase())}))},isOptionEqualToValue:function(e,t){return e.batch_id===t.batch_id},renderOption:function(e,t){return(0,o.createElement)("li",(0,a.Z)((0,a.Z)({},e),{},{key:t.batch_id}),t.title)}}),("admin"===Bt||"super_admin"===Bt)&&(0,ne.jsx)(_.Z,{id:"employee_id",options:he||[],getOptionLabel:function(e){return e.full_name||""},value:Tt,onChange:function(e,t){Vt(t)},size:"small",sx:{minWidth:{xs:"100%",sm:180,md:200},flex:"1 1 auto"},renderInput:function(e){return(0,ne.jsx)(p.Z,(0,a.Z)((0,a.Z)({},e),{},{placeholder:"Filter by tutor...",InputProps:(0,a.Z)({},e.InputProps)}))},filterOptions:function(){var e=arguments.length>1?arguments[1]:void 0;return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).filter((function(t){var n;return null===(n=t.full_name)||void 0===n?void 0:n.toLowerCase().includes(e.inputValue.toLowerCase())}))},isOptionEqualToValue:function(e,t){return e.employee_id===t.employee_id},renderOption:function(e,t){return(0,o.createElement)("li",(0,a.Z)((0,a.Z)({},e),{},{key:t.employee_id}),t.full_name)}})]})}),(0,ne.jsx)(d.Z,{sx:{height:600},children:(0,ne.jsx)(M.f,{className:"my-calendar",localizer:ae,events:((Qe?nt:Mt)||[]).map((function(e){return(0,a.Z)({start:new Date("".concat(e.scheduled_date,"T").concat(e.start_time)),end:new Date("".concat(e.scheduled_date,"T").concat(e.end_time)),title:e.trainer_name},e)})),startAccessor:"start",endAccessor:"end",style:{height:"100%",fontFamily:"Arial, sans-serif",borderRadius:"8px",boxShadow:"0 2px 10px rgba(0,0,0,0.1)"},defaultView:"month",view:st,onView:function(e){lt(e),"day"!==e&&Xe(null)},date:ct,onNavigate:function(e){ut(e)},onSelectSlot:function(e){return zt(e.start)},selectable:!0,components:{event:function(){return null},month:{dateHeader:function(e){var t=e.date,n=e.label,r=null===Mt||void 0===Mt?void 0:Mt.filter((function(e){var n=new Date(e.scheduled_date);return ae.isSameDate(t,n)})),a=new Date,i=ae.isSameDate(t,a);return(0,ne.jsxs)("button",{style:{position:"relative",padding:"4px",textAlign:"center",height:"100%",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"space-between",backgroundColor:i?"#e6f7ff":"transparent",borderRadius:"4px",border:i?"1px solid #1890ff":"none"},onClick:function(){return zt(t)},children:[(0,ne.jsx)("span",{style:{fontWeight:i?"bold":"normal",color:i?"#1890ff":"#333",fontSize:"14px"},children:n}),(null===r||void 0===r?void 0:r.length)>0&&(0,ne.jsxs)("div",{style:{display:"flex",flexWrap:"wrap",justifyContent:"center",gap:"2px",marginTop:"4px"},children:[null===r||void 0===r?void 0:r.slice(0,3).map((function(e,t){return(0,ne.jsx)("div",{style:{width:"6px",height:"6px",borderRadius:"50%",backgroundColor:"#52c41a",boxShadow:"0 0 2px rgba(0,0,0,0.2)"}},t)})),(null===r||void 0===r?void 0:r.length)>3&&(0,ne.jsxs)("span",{style:{fontSize:"10px",color:"#666",marginLeft:"2px"},children:["+",(null===r||void 0===r?void 0:r.length)-3]})]})]})}}},dayPropGetter:function(e){return{style:{backgroundColor:0===e.getDay()||6===e.getDay()?"#f9f9f9":"#fff",borderRight:"1px solid #f0f0f0",borderBottom:"1px solid #f0f0f0",color:"#000"}}}})}),(0,ne.jsxs)(f.Z,{open:be,onClose:At,fullWidth:!0,maxWidth:"sm",children:[(0,ne.jsxs)(x.Z,{className:"dialogTitle",children:[Pe?"Edit Schedule":"Add New Schedule",(0,ne.jsx)(v.Z,{color:"dark",onClick:At,edge:"end",size:"big","aria-label":"close",title:"close",children:(0,ne.jsx)(E.Z,{height:30})})]}),(0,ne.jsxs)("form",{onSubmit:Lt.handleSubmit,children:[(0,ne.jsx)(g.Z,{children:(0,ne.jsxs)(Z.ZP,{container:!0,spacing:3,children:[(0,ne.jsx)(Z.ZP,{item:!0,xs:12,md:6,children:(0,ne.jsx)(y.Z,{fullWidth:!0,children:(0,ne.jsxs)(h.Z,{spacing:1.5,children:[(0,ne.jsx)(j.Z,{children:"Recurrence Type"}),(0,ne.jsxs)(w.Z,{name:"recurrence_type",value:Lt.values.recurrence_type,onChange:function(e){var t=e.target.value;Lt.setFieldValue("recurrence_type",t),Lt.setFieldValue("batch_id",null);var n=new Date;if("day"===t)Lt.setFieldValue("start_date",n),Lt.setFieldValue("end_date",n);else if("weekly"===t){(!Lt.values.start_date||Lt.values.start_date<n)&&Lt.setFieldValue("start_date",n);var r=new Date(Lt.values.start_date||n);r.setDate(r.getDate()+7),Lt.setFieldValue("end_date",r)}else if("custom_days"===t){(!Lt.values.start_date||Lt.values.start_date<n)&&Lt.setFieldValue("start_date",n);var a=new Date(Lt.values.start_date||n);a.setDate(a.getDate()+30),Lt.setFieldValue("end_date",a)}},onBlur:Lt.handleBlur,disabled:Pe,children:[(0,ne.jsx)(b.Z,{value:"day",children:"Single Day"}),(0,ne.jsx)(b.Z,{value:"daily",children:"Daily"}),(0,ne.jsx)(b.Z,{value:"custom_days",children:"Custom Days"})]})]})})}),(0,ne.jsx)(Z.ZP,{item:!0,xs:12,sm:6,children:(0,ne.jsxs)(h.Z,{spacing:1.5,children:[(0,ne.jsx)(j.Z,{children:"Batch"}),(0,ne.jsx)(_.Z,{options:oe||[],getOptionLabel:function(e){return e.title||""},value:(null===oe||void 0===oe?void 0:oe.find((function(e){return e.batch_id===Lt.values.batch_id})))||null,onChange:function(e,t){if(Lt.setFieldValue("batch_id",t?t.batch_id:""),t){Lt.setFieldValue("course_id",t.course_id||""),Lt.setFieldValue("employee_id",t.employee_id||"");var n=new Date;if(n.setHours(0,0,0,0),t.start_date){var r=new Date(t.start_date);r.setHours(0,0,0,0),r>=n?Lt.setFieldValue("start_date",new Date(t.start_date)):Lt.setFieldValue("start_date",n)}else Lt.setFieldValue("start_date",n);if(t.end_date){var a=new Date(t.end_date);a.setHours(0,0,0,0);var i=Lt.values.start_date||n;if(a>=i)Lt.setFieldValue("end_date",new Date(t.end_date));else{var s=new Date(i);s.setDate(s.getDate()+1),Lt.setFieldValue("end_date",s)}}else{var o=Lt.values.start_date||n,d=new Date(o);d.setDate(d.getDate()+1),Lt.setFieldValue("end_date",d)}if(t.start_time){var c=Lt.values.start_date||n,u=new Date(c),h=t.start_time.split(":"),m=(0,l.Z)(h,2),_=m[0],p=m[1];u.setHours(parseInt(_),parseInt(p),0);var f=new Date;c.getTime()===n.getTime()&&u<f?Lt.setFieldValue("start_time",f):Lt.setFieldValue("start_time",u)}else Lt.setFieldValue("start_time",new Date);if(t.end_time){var x=Lt.values.end_date||n,v=new Date(x),g=t.end_time.split(":"),Z=(0,l.Z)(g,2),y=Z[0],j=Z[1];v.setHours(parseInt(y),parseInt(j),0);var w=Lt.values.start_time||new Date;if(v<=w){var b=new Date(w);b.setHours(b.getHours()+1),Lt.setFieldValue("end_time",b)}else Lt.setFieldValue("end_time",v)}else{var D=Lt.values.start_time||new Date,S=new Date(D.getTime()+36e5);Lt.setFieldValue("end_time",S)}if(t.employee_id){var k=he.find((function(e){return e.employee_id===t.employee_id}))||null;pt(k)}}else{Lt.setFieldValue("course_id",""),Lt.setFieldValue("employee_id","");var C=new Date,F=new Date;Lt.setFieldValue("start_date",C),Lt.setFieldValue("end_date",C),Lt.setFieldValue("start_time",F),Lt.setFieldValue("end_time",new Date(F.getTime()+36e5)),pt(Et&&(null===he||void 0===he?void 0:he.find((function(e){return e.employee_id===It})))||null)}},renderInput:function(e){return(0,ne.jsx)(p.Z,(0,a.Z)((0,a.Z)({},e),{},{placeholder:"Select Batch",error:Lt.touched.batch_id&&Boolean(Lt.errors.batch_id),helperText:Lt.touched.batch_id&&Lt.errors.batch_id,fullWidth:!0}))},isOptionEqualToValue:function(e,t){return e.batch_id===t.batch_id}})]})}),"custom_days"===Lt.values.recurrence_type&&(0,ne.jsx)(Z.ZP,{item:!0,xs:12,children:(0,ne.jsxs)(h.Z,{spacing:1.5,children:[(0,ne.jsx)(j.Z,{children:"Select Days of Week"}),(0,ne.jsx)(D.Z,{row:!0,sx:{justifyContent:"space-between",gap:1},children:["MON","TUE","WED","THU","FRI","SAT","SUN"].map((function(e){return(0,ne.jsx)(S.Z,{control:(0,ne.jsx)(k.Z,{name:"days_of_week",value:e,checked:Lt.values.days_of_week.includes(e),onChange:function(e){var t=e.target.checked,n=e.target.value,a=(0,r.Z)(Lt.values.days_of_week);t?Lt.setFieldValue("days_of_week",[].concat((0,r.Z)(a),[n])):Lt.setFieldValue("days_of_week",a.filter((function(e){return e!==n})))},sx:{marginRight:.5}}),label:e,sx:{margin:0},labelPlacement:"end"},e)}))})]})}),(0,ne.jsx)(Z.ZP,{item:!0,xs:12,sm:6,children:(0,ne.jsxs)(h.Z,{spacing:1.5,children:[(0,ne.jsx)(j.Z,{children:"Start Date"}),(0,ne.jsx)(R._,{dateAdapter:X.H,children:(0,ne.jsx)(U.M,{format:W.ZP.dateFormat,placeholder:"Start Date",value:Lt.values.start_date,onChange:function(e){if(Lt.setFieldValue("start_date",e),"weekly"===Lt.values.recurrence_type){var t=new Date(e);t.setDate(t.getDate()+7),Lt.setFieldValue("end_date",t)}else if("custom_days"===Lt.values.recurrence_type){var n=new Date(e);n.setDate(n.getDate()+30),Lt.setFieldValue("end_date",n)}else"day"===Lt.values.recurrence_type&&Lt.setFieldValue("end_date",e)},minDate:"day"===Lt.values.recurrence_type?null:new Date,slotProps:{textField:{error:Lt.touched.start_date&&Boolean(Lt.errors.start_date),helperText:Lt.touched.start_date&&Lt.errors.start_date,fullWidth:!0,name:"start_date",onBlur:Lt.handleBlur}}})})]})}),(0,ne.jsx)(Z.ZP,{item:!0,xs:12,sm:6,children:(0,ne.jsxs)(h.Z,{spacing:1.5,children:[(0,ne.jsx)(j.Z,{children:"End Date"}),(0,ne.jsx)(R._,{dateAdapter:X.H,children:(0,ne.jsx)(U.M,{format:W.ZP.dateFormat,placeholder:"End Date",value:Lt.values.end_date,onChange:function(e){return Lt.setFieldValue("end_date",e)},minDate:"day"===Lt.values.recurrence_type?null:Lt.values.start_date||new Date,readOnly:"day"===Lt.values.recurrence_type,disabled:"day"===Lt.values.recurrence_type,slotProps:{textField:{error:Lt.touched.end_date&&Boolean(Lt.errors.end_date),helperText:Lt.touched.end_date&&Lt.errors.end_date,fullWidth:!0,name:"end_date",onBlur:Lt.handleBlur}}})})]})}),(0,ne.jsx)(Z.ZP,{item:!0,xs:12,sm:6,children:(0,ne.jsxs)(h.Z,{spacing:1.5,children:[(0,ne.jsx)(j.Z,{children:"Start Time"}),(0,ne.jsx)(R._,{dateAdapter:X.H,children:(0,ne.jsx)($.j,{placeholder:"Start Time",value:Lt.values.start_time,minTime:Ut(Lt.values.start_date)?new Date:void 0,onChange:function(e){return Lt.setFieldValue("start_time",e)},slotProps:{textField:{error:Lt.touched.start_time&&Boolean(Lt.errors.start_time),helperText:Lt.touched.start_time&&Lt.errors.start_time,fullWidth:!0}}})})]})}),(0,ne.jsx)(Z.ZP,{item:!0,xs:12,sm:6,children:(0,ne.jsxs)(h.Z,{spacing:1.5,children:[(0,ne.jsx)(j.Z,{children:"End Time"}),(0,ne.jsx)(R._,{dateAdapter:X.H,children:(0,ne.jsx)($.j,{placeholder:"End Time",value:Lt.values.end_time,minTime:Ut(Lt.values.start_date)&&Lt.values.start_time?Lt.values.start_time:void 0,onChange:function(e){return Lt.setFieldValue("end_time",e)},slotProps:{textField:{error:Lt.touched.end_time&&Boolean(Lt.errors.end_time),helperText:Lt.touched.end_time&&Lt.errors.end_time,fullWidth:!0}}})})]})}),(0,ne.jsx)(Z.ZP,{item:!0,xs:12,sm:6,children:(0,ne.jsxs)(h.Z,{spacing:1.5,children:[(0,ne.jsx)(j.Z,{children:"Course"}),(0,ne.jsx)(_.Z,{id:"course_id",options:vt||[],getOptionLabel:function(e){return e.course_name},value:(null===vt||void 0===vt?void 0:vt.find((function(e){return e.course_id===Lt.values.course_id})))||null,onChange:function(e,t){Lt.setFieldValue("course_id",t?t.course_id:"")},onBlur:Lt.handleBlur,renderInput:function(e){return(0,ne.jsx)(p.Z,(0,a.Z)((0,a.Z)({},e),{},{placeholder:"Select course...",error:Lt.touched.course_id&&Boolean(Lt.errors.course_id),helperText:Lt.touched.course_id&&Lt.errors.course_id}))},isOptionEqualToValue:function(e,t){return e.course_id===t.course_id},renderOption:function(e,t){return(0,o.createElement)("li",(0,a.Z)((0,a.Z)({},e),{},{key:t.course_id}),t.course_name)},readOnly:!0})]})}),(0,ne.jsx)(Z.ZP,{item:!0,xs:12,md:6,children:(0,ne.jsxs)(h.Z,{spacing:1.5,children:[(0,ne.jsx)(j.Z,{children:"Employee ID"}),(0,ne.jsx)(_.Z,{id:"employee_id",options:null!==he&&void 0!==he?he:[],disabled:Et,getOptionLabel:function(e){return e.full_name||""},value:_t,onChange:function(e,t){Lt.setFieldValue("employee_id",t?t.employee_id:"")},onBlur:Lt.handleBlur,renderInput:function(e){return(0,ne.jsx)(p.Z,(0,a.Z)((0,a.Z)({},e),{},{placeholder:"Employee ID",error:Lt.touched.employee_id&&Boolean(Lt.errors.employee_id),helperText:Lt.touched.employee_id&&Lt.errors.employee_id}))},filterOptions:function(){var e=arguments.length>1?arguments[1]:void 0;return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).filter((function(t){var n;return null===(n=t.full_name)||void 0===n?void 0:n.toLowerCase().includes(e.inputValue.toLowerCase())}))},isOptionEqualToValue:function(e,t){return(null===t||void 0===t?void 0:t.employee_id)===e.employee_id},renderOption:function(e,t){return(0,o.createElement)("li",(0,a.Z)((0,a.Z)({},e),{},{key:t.employee_id}),(0,ne.jsxs)(d.Z,{children:[(0,ne.jsx)("div",{children:t.full_name}),(0,ne.jsxs)("div",{style:{fontSize:"0.8rem",color:"#666"},children:["ID: ",t.employee_id]})]}))},readOnly:!0})]})}),(0,ne.jsx)(Z.ZP,{item:!0,xs:12,sm:6,children:(0,ne.jsxs)(h.Z,{spacing:1.5,children:[(0,ne.jsx)(j.Z,{children:"Meet Link"}),(0,ne.jsx)(p.Z,{fullWidth:!0,id:"class_link",name:"class_link",placeholder:"Meet Link",value:Lt.values.class_link,onChange:Lt.handleChange,error:Lt.touched.class_link&&Boolean(Lt.errors.class_link),helperText:Lt.touched.class_link&&Lt.errors.class_link})]})})]})}),(0,ne.jsxs)(C.Z,{sx:{m:2},children:[(0,ne.jsx)(m.Z,{onClick:At,children:"Cancel"}),(0,ne.jsx)(m.Z,{type:"submit",variant:"contained",children:Pe?"Update":"Create"})]})]})]}),(0,ne.jsxs)(f.Z,{open:Ce,onClose:Yt,fullWidth:!0,maxWidth:"sm",children:[(0,ne.jsxs)(x.Z,{className:"dialogTitle",children:["Schedules for"," ",null===Oe||void 0===Oe?void 0:Oe.toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),(0,ne.jsx)(v.Z,{color:"dark",onClick:Yt,edge:"end",size:"big","aria-label":"close",title:"close",children:(0,ne.jsx)(E.Z,{height:30})})]}),(0,ne.jsx)(g.Z,{children:0===Le.length?(0,ne.jsx)(u.Z,{sx:{py:2},children:"No schedules for this day"}):(0,ne.jsx)(d.Z,{children:Le.map((function(e,t){return(0,ne.jsxs)(d.Z,{onClick:function(){return function(e){Ye(!0),Ke(e)}(e)},sx:{p:1,cursor:"pointer","&:hover":{backgroundColor:"action.hover"},borderBottom:"1px solid #ccc"},children:[(0,ne.jsxs)(d.Z,{sx:{display:"flex",alignItems:"center",gap:1},children:[(0,ne.jsxs)(u.Z,{variant:"body1",fontWeight:"bold",children:["Tutor Name: ",e.trainer_name]}),(0,ne.jsx)(u.Z,{variant:"body3",color:"text.secondary",children:e.title})]}),(0,ne.jsxs)(d.Z,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mt:.5},children:[(0,ne.jsx)(d.Z,{sx:{display:"flex",alignItems:"center",gap:1},children:(0,ne.jsxs)(u.Z,{component:"span",variant:"body2",color:"text.primary",children:[new Date("".concat(e.scheduled_date,"T").concat(e.start_time)).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})," ","-"," ",new Date("".concat(e.scheduled_date,"T").concat(e.end_time)).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})]})}),(0,ne.jsxs)(d.Z,{sx:{display:"flex",alignItems:"center",gap:1},children:[(0,ne.jsx)(F.Z,{sx:{height:25},label:(0,Q.Z)(e.status_info),variant:"contained",className:"upcoming"===e.status_info||"Upcoming"===e.status_info?"warning-chip":"",color:"done"===e.status_info||"Done"===e.status_info||"completed"===e.status_info?"success":"upcoming"===e.status_info||"Upcoming"===e.status_info?"warning":"ongoing"===e.status_info||"Ongoing"===e.status_info?"info":"error"}),q&&(0,ne.jsx)(v.Z,{onClick:function(t){t.stopPropagation(),Nt(e.schedule_id)},color:"error",children:(0,ne.jsx)(O.Z,{})}),"upcoming"===e.status_info&&(0,ne.jsx)(v.Z,{onClick:function(t){t.stopPropagation(),qt(Oe,e)},color:"error",children:(0,ne.jsx)(H.Z,{})})]})]})]},t)}))})}),(0,ne.jsxs)(C.Z,{sx:{m:2},children:[(0,ne.jsx)(m.Z,{onClick:Yt,children:"Cancel"}),Oe&&(new Date).setHours(0,0,0,0)<=new Date(Oe).setHours(0,0,0,0)&&(N||"tutor"===Bt)&&(0,ne.jsx)(m.Z,{variant:"contained",onClick:function(){Yt(),qt(Oe)},children:"Add New Schedule"})]})]}),(0,ne.jsxs)(f.Z,{open:ze,onClose:Rt,fullWidth:!0,maxWidth:"sm",children:[(0,ne.jsxs)(x.Z,{className:"dialogTitle",children:[null===$e||void 0===$e?void 0:$e.title,(0,ne.jsx)(v.Z,{color:"dark",onClick:Rt,edge:"end",size:"big","aria-label":"close",title:"close",children:(0,ne.jsx)(E.Z,{height:30})})]}),(0,ne.jsx)(g.Z,{children:(0,ne.jsx)(u.Z,{children:$e&&(0,ne.jsxs)(Z.ZP,{container:!0,spacing:1.5,children:[(0,ne.jsx)(Z.ZP,{item:!0,xs:12,children:(0,ne.jsxs)(h.Z,{sx:{flexDirection:"row",alignItems:"center",gap:1},children:[(0,ne.jsx)(u.Z,{variant:"h6",fontWeight:500,children:"Tutor Name :"}),(0,ne.jsx)(u.Z,{component:"span",variant:"body2",color:"text.primary",children:$e.trainer_name})]})}),(0,ne.jsx)(Z.ZP,{item:!0,xs:12,children:(0,ne.jsxs)(h.Z,{sx:{flexDirection:"row",alignItems:"center",gap:1},children:[(0,ne.jsx)(u.Z,{variant:"h6",fontWeight:500,children:"Students Name :"}),null===$e||void 0===$e||null===(P=$e.course_trainer_assignments)||void 0===P?void 0:P.map((function(e,t){return(0,ne.jsxs)(u.Z,{component:"span",variant:"body2",color:"text.primary",children:[(0,Q.Z)(e.student_name)||(0,Q.Z)(e.student_names),t<$e.course_trainer_assignments.length-1?", ":""]},t)}))]})}),(0,ne.jsx)(Z.ZP,{item:!0,xs:12,children:(0,ne.jsxs)(h.Z,{sx:{flexDirection:"row",alignItems:"center",gap:1},children:[(0,ne.jsx)(u.Z,{variant:"h6",fontWeight:500,children:"Course Name :"}),(0,ne.jsx)(u.Z,{variant:"body2",color:"text.primary",children:$e.course_name})]})}),(0,ne.jsx)(Z.ZP,{item:!0,xs:12,children:(0,ne.jsxs)(h.Z,{sx:{flexDirection:"row",alignItems:"center",gap:1},children:[(0,ne.jsx)(u.Z,{variant:"h6",fontWeight:500,children:"Date & Time :"}),(0,ne.jsx)(u.Z,{variant:"body2",color:"text.primary",children:(0,te.o)($e.scheduled_date,{includeTime:!1})}),"(",(0,ne.jsxs)(u.Z,{component:"span",variant:"body2",color:"text.primary",children:[new Date("".concat($e.scheduled_date,"T").concat($e.start_time)).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})," ","-"," ",new Date("".concat($e.scheduled_date,"T").concat($e.end_time)).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})]}),")"]})})]})})}),(0,ne.jsx)(C.Z,{sx:{m:2},children:(0,ne.jsx)(m.Z,{onClick:Rt,children:"Cancel"})})]})]})})}},78045:function(e,t,n){n.d(t,{o:function(){return i}});var r=n(29439),a=n(23197),i=function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=n.includeTime,s=void 0===i||i,l=n.includeSeconds,o=void 0!==l&&l,d=n.timeOnly,c=void 0!==d&&d,u=n.useCurrentIfEmpty,h=void 0!==u&&u,m=n.fallback,_=void 0===m?"":m;if(e)if("string"===typeof e&&/^\d{1,2}:\d{2}(:\d{2})?$/.test(e)){var p=e.split(":").map(Number),f=(0,r.Z)(p,3),x=f[0],v=f[1],g=f[2];(t=new Date).setHours(x,v,g||0,0)}else t=e instanceof Date?e:new Date(e);else{if(!h)return _;t=new Date}if(isNaN(t.getTime()))return _;var Z=function(e,t){var n=t.getHours(),r=n>=12,a={yyyy:t.getFullYear(),yy:String(t.getFullYear()).slice(-2),MM:String(t.getMonth()+1).padStart(2,"0"),M:t.getMonth()+1,dd:String(t.getDate()).padStart(2,"0"),d:t.getDate(),HH:String(n).padStart(2,"0"),H:n,hh:String(n%12||12).padStart(2,"0"),h:n%12||12,mm:String(t.getMinutes()).padStart(2,"0"),m:t.getMinutes(),ss:String(t.getSeconds()).padStart(2,"0"),s:t.getSeconds(),a:r?"PM":"AM"};return e.replace(/(yyyy|yy|MM|M|dd|d|HH|H|hh|h|mm|m|ss|s|a)/g,(function(e){return a[e]||e}))};if(c){var y=a.ZP.timeFormat;return o||(y=(y=(y=y.replace(/:ss?/g,"")).replace(/(^|\s)ss?(\s|$)/g,"$1$2")).replace(/::/g,":").replace(/(\s|^):|:(\s|$)/g,"$1$2")),Z(y,t)}if(s){var j=Z(a.ZP.dateFormat,t),w=a.ZP.timeFormat;o||(w=(w=w.replace(/[:\\/]?ss?/g,"")).replace(/::/g,":").replace(/:$/,""));var b=Z(w,t);return"".concat(j," ").concat(b)}return Z(a.ZP.dateFormat,t)}},90838:function(e,t,n){n.d(t,{p:function(){return r}});var r=function(e){var t=new Date(e),n=""+(t.getMonth()+1),r=""+t.getDate(),a=t.getFullYear();return n.length<2&&(n="0"+n),r.length<2&&(r="0"+r),[a,n,r].join("-")}}}]);
//# sourceMappingURL=8397.8554136e.chunk.js.map